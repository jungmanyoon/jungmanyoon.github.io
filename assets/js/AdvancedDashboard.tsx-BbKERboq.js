var e=Object.defineProperty,t=Object.defineProperties,a=Object.getOwnPropertyDescriptors,s=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable,o=(t,a,s)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[a]=s,i=(e,t)=>{for(var a in t||(t={}))r.call(t,a)&&o(e,a,t[a]);if(s)for(var a of s(t))n.call(t,a)&&o(e,a,t[a]);return e},l=(e,s)=>t(e,a(s)),d=(e,t,a)=>new Promise((s,r)=>{var n=e=>{try{i(a.next(e))}catch(t){r(t)}},o=e=>{try{i(a.throw(e))}catch(t){r(t)}},i=e=>e.done?s(e.value):Promise.resolve(e.value).then(n,o);i((a=a.apply(e,t)).next())});import{c,r as u,j as m,u as h,e as p,f as x,X as g,g as b,h as y,S as v,I as f,d as j,a as N,i as k,P as w,k as C,W as D,R as M,C as $}from"./index-MhmvKiUL.js";import{U as S,T as W,C as T,a as R,b as L,R as B,c as I,D as A}from"./chunk-BDLxaNe1.js";import{C as q}from"./chunk-JdfCtM3i.js";import{F as P}from"./chunk-C6Y2xxM3.js";
/**
 * @license lucide-react v0.537.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z=c("chevron-right",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]),O=c("cookie",[["path",{d:"M12 2a10 10 0 1 0 10 10 4 4 0 0 1-5-5 4 4 0 0 1-5-5",key:"laymnq"}],["path",{d:"M8.5 8.5v.01",key:"ue8clq"}],["path",{d:"M16 15.5v.01",key:"14dtrp"}],["path",{d:"M12 12v.01",key:"u5ubse"}],["path",{d:"M11 17v.01",key:"1hyl5a"}],["path",{d:"M7 14v.01",key:"uct60s"}]]),E=c("file-text",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]),F=c("grip-vertical",[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]]),H=c("layers",[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]]),K=c("link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]),Y=c("list-ordered",[["path",{d:"M10 12h11",key:"6m4ad9"}],["path",{d:"M10 18h11",key:"11hvi2"}],["path",{d:"M10 6h11",key:"c7qv1k"}],["path",{d:"M4 10h2",key:"16xx2s"}],["path",{d:"M4 6h1v4",key:"cnovpq"}],["path",{d:"M6 18H4c0-1 2-2 2-3s-1-1.5-2-1",key:"m9a95d"}]]),V=c("minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]),U=c("thermometer-sun",[["path",{d:"M12 9a4 4 0 0 0-2 7.5",key:"1jvsq6"}],["path",{d:"M12 3v2",key:"1w22ol"}],["path",{d:"m6.6 18.4-1.4 1.4",key:"w2yidj"}],["path",{d:"M20 4v10.54a4 4 0 1 1-4 0V4a2 2 0 0 1 4 0Z",key:"iof6y5"}],["path",{d:"M4 13H2",key:"118le4"}],["path",{d:"M6.34 7.34 4.93 5.93",key:"1brd51"}]]),_=c("unlink",[["path",{d:"m18.84 12.25 1.72-1.71h-.02a5.004 5.004 0 0 0-.12-7.07 5.006 5.006 0 0 0-6.95 0l-1.72 1.71",key:"yqzxt4"}],["path",{d:"m5.17 11.75-1.71 1.71a5.004 5.004 0 0 0 .12 7.07 5.006 5.006 0 0 0 6.95 0l1.71-1.71",key:"4qinb0"}],["line",{x1:"8",x2:"8",y1:"2",y2:"5",key:"1041cp"}],["line",{x1:"2",x2:"5",y1:"8",y2:"8",key:"14m1p5"}],["line",{x1:"16",x2:"16",y1:"19",y2:"22",key:"rzdirn"}],["line",{x1:"19",x2:"22",y1:"16",y2:"16",key:"ox905f"}]]),J="recipe-dashboard-layout",X={sidebarWidth:320,recipeContainerHeight:.6,processRowHeight:36,processPanelHeight:256,processItems:{}};const G=({direction:e,onResize:t,onResizeEnd:a,className:s=""})=>{const r=u.useRef(!1),n=u.useRef(0),o=u.useCallback(t=>{t.preventDefault(),r.current=!0,n.current="horizontal"===e?t.clientX:t.clientY,document.body.style.cursor="horizontal"===e?"col-resize":"row-resize",document.body.style.userSelect="none"},[e]);u.useEffect(()=>{const s=a=>{if(!r.current)return;const s="horizontal"===e?a.clientX:a.clientY,o=s-n.current;n.current=s,t(o)},o=()=>{r.current&&(r.current=!1,document.body.style.cursor="",document.body.style.userSelect="",null==a||a())};return document.addEventListener("mousemove",s),document.addEventListener("mouseup",o),()=>{document.removeEventListener("mousemove",s),document.removeEventListener("mouseup",o)}},[e,t,a]);const i="horizontal"===e?"w-1 cursor-col-resize hover:bg-blue-400 active:bg-blue-500 transition-colors":"h-1 cursor-row-resize hover:bg-blue-400 active:bg-blue-500 transition-colors";return m.jsx("div",{className:`${i} bg-transparent group flex items-center justify-center ${s}`,onMouseDown:o,children:"horizontal"===e?m.jsx("div",{className:"w-0.5 h-8 bg-gray-300 group-hover:bg-blue-400 rounded-full opacity-0 group-hover:opacity-100 transition-opacity"}):m.jsx("div",{className:"h-0.5 w-8 bg-gray-300 group-hover:bg-blue-400 rounded-full opacity-0 group-hover:opacity-100 transition-opacity"})})},Z=44032,Q=["„Ñ±","„Ñ≤","„Ñ¥","„Ñ∑","„Ñ∏","„Ñπ","„ÖÅ","„ÖÇ","„ÖÉ","„ÖÖ","„ÖÜ","„Öá","„Öà","„Öâ","„Öä","„Öã","„Öå","„Öç","„Öé"];function ee(e){const t=e.charCodeAt(0);return t>=Z&&t<=55203}function te(e){return Q.includes(e)}function ae(e){const t=e.charCodeAt(0);if(t>=Z&&t<=55203){const e=Math.floor((t-Z)/588);return Q[e]}return e}function se(e){return e.split("").map(ae).join("")}function re(e,t){se(e),t.toLowerCase();let a=0,s=0;for(;a<e.length&&s<t.length;){const r=e[a],n=t[s];if(te(n)){if(!ee(r))return!1;if(ae(r)!==n)return!1;a++,s++}else if(ee(n)){if(r.toLowerCase()!==n.toLowerCase())return!1;a++,s++}else{if(r.toLowerCase()!==n.toLowerCase())return!1;a++,s++}}return s===t.length}function ne({value:e,displayValue:t,onChange:a,onSelect:s,placeholder:r,className:n="",suggestions:o,maxSuggestions:i=8,disabled:l=!1,autoFocus:d=!1}){const{t:c}=h(),g=null!=r?r:c("components.autocomplete.placeholder"),b=p(e=>e.getAllIngredientNames),y=null!=o?o:b(),[v,f]=u.useState(!1),[j,N]=u.useState(!1),[k,w]=u.useState(-1),[C,D]=u.useState([]),M=u.useRef(null),$=u.useRef(null);u.useEffect(()=>{const e=localStorage.getItem("recentIngredients");if(e)try{D(JSON.parse(e))}catch(t){}},[]);const S=u.useCallback(e=>{D(t=>{const a=t.filter(t=>t!==e),s=[e,...a].slice(0,10);return localStorage.setItem("recentIngredients",JSON.stringify(s)),s})},[]),W=u.useMemo(()=>{if(!e.trim())return C.slice(0,i);return function(e,t){const a=t.toLowerCase().trim();return[...e].sort((e,s)=>{const r=e.toLowerCase(),n=s.toLowerCase(),o=r.startsWith(a)||re(e,t),i=n.startsWith(a)||re(s,t);if(o&&!i)return-1;if(!o&&i)return 1;const l=r.includes(a),d=n.includes(a);return l&&!d?-1:!l&&d?1:e.length-s.length})}(function(e,t){if(!t.trim())return e;const a=t.toLowerCase().trim();return e.filter(e=>{if(e.toLowerCase().includes(a))return!0;if(re(e,t))return!0;const s=se(e),r=se(t);return!!s.includes(r)})}(y,e),e).slice(0,i)},[e,y,C,i]),T=u.useCallback(e=>{a(e),null==s||s(e),S(e),f(!1),w(-1)},[a,s,S]),R=u.useCallback(e=>{if(v||"ArrowDown"!==e.key&&"ArrowUp"!==e.key)switch(e.key){case"ArrowDown":e.preventDefault(),w(e=>e<W.length-1?e+1:0);break;case"ArrowUp":e.preventDefault(),w(e=>e>0?e-1:W.length-1);break;case"Enter":e.preventDefault(),k>=0&&k<W.length?T(W[k]):W.length>0&&T(W[0]);break;case"Escape":f(!1),w(-1);break;case"Tab":v&&k>=0&&(e.preventDefault(),T(W[k]))}else f(!0)},[v,k,W,T]),L=u.useCallback(e=>{a(e.target.value),f(!0),w(-1)},[a]),B=u.useCallback(()=>{f(!0),N(!0)},[]),I=u.useCallback(()=>{setTimeout(()=>{f(!1),N(!1),w(-1)},200)},[]);u.useEffect(()=>{if(k>=0&&$.current){const e=$.current.children[k];e&&e.scrollIntoView({block:"nearest"})}},[k]);const A=e=>{const t=x(e);if(!t)return"";return{flour:"üåæ",liquid:"üíß",fat:"üßà",sugar:"üçØ",egg:"ü•ö",dairy:"ü•õ",leavening:"ü´ß",salt:"üßÇ",flavoring:"üåø",nut:"ü•ú",fruit:"üçé",chocolate:"üç´",other:"üì¶"}[t.category]||""},q=j?e:null!=t?t:e;return m.jsxs("div",{className:"relative",children:[m.jsx("input",{ref:M,type:"text",value:q,onChange:L,onKeyDown:R,onFocus:B,onBlur:I,placeholder:g,disabled:l,autoFocus:d,className:`w-full px-3 py-2 border border-gray-300 rounded-lg\n          focus:ring-2 focus:ring-amber-500 focus:border-amber-500\n          disabled:bg-gray-100 disabled:cursor-not-allowed\n          ${n}`,autoComplete:"off"}),v&&W.length>0&&m.jsxs("ul",{ref:$,className:"absolute z-50 w-full mt-1 bg-white border border-gray-200\r\n            rounded-lg shadow-lg max-h-60 overflow-auto",children:[!e.trim()&&C.length>0&&m.jsx("li",{className:"px-3 py-1 text-xs text-gray-500 bg-gray-50 border-b",children:c("components.autocomplete.recentlyUsed")}),W.map((e,t)=>m.jsxs("li",{onClick:()=>T(e),className:"px-3 py-2 cursor-pointer flex items-center gap-2\n                "+(t===k?"bg-amber-100 text-amber-900":"hover:bg-gray-100"),children:[m.jsx("span",{className:"text-sm",children:A(e)}),m.jsx("span",{className:"flex-1",children:e}),t===k&&m.jsx("span",{className:"text-xs text-gray-400",children:"Enter"})]},e))]}),v&&e.trim()&&0===W.length&&m.jsx("div",{className:"absolute z-50 w-full mt-1 px-3 py-2 bg-gray-50\r\n          border border-gray-200 rounded-lg text-sm text-gray-500",children:c("components.autocomplete.noMatch",{value:e})})]})}const oe={flour:"flour",liquid:"liquid",fat:"wetOther",sugar:"other",egg:"wetOther",dairy:"liquid",leavening:"other",salt:"other",flavoring:"other",nut:"other",fruit:"other",chocolate:"other",other:"other"};function ie(e){var t;const a=e.trim();if(!a||a.startsWith("#")||a.startsWith("//"))return null;let s="",r="";if(a.includes("\t")){const e=a.split("\t").map(e=>e.trim()).filter(Boolean);e.length>=2&&(s=e[0],r=e[1])}else if(a.includes(",")){const e=a.split(",").map(e=>e.trim()).filter(Boolean);e.length>=2&&(s=e[0],r=e[1])}else{const e=a.match(/^(.+?)\s+(\d+\.?\d*)\s*(g|kg|ml|L|Í∞ú)?$/i);if(e){s=e[1].trim(),r=e[2];const a=null==(t=e[3])?void 0:t.toLowerCase();("kg"===a||"l"===a)&&(r=String(1e3*parseFloat(e[2])))}}if(!s)return{name:a,amount:0,category:"other",isValid:!1,error:"ÌòïÏãùÏùÑ Ïù∏ÏãùÌï† Ïàò ÏóÜÏäµÎãàÎã§"};const n=r.replace(/[^\d.]/g,""),o=parseFloat(n);if(isNaN(o)||o<=0)return{name:s,amount:0,category:"other",isValid:!1,error:`ÏñëÏùÑ Ïù∏ÏãùÌï† Ïàò ÏóÜÏäµÎãàÎã§: "${r}"`};const i=x(s);return{name:s,amount:o,category:i&&oe[i.category]||"other",isValid:!0}}function le({isOpen:e,onClose:t,onImport:a}){const{t:s}=h(),[r,n]=u.useState(""),[o,i]=u.useState([]),[l,c]=u.useState(!1),p=u.useCallback(()=>{const e=r.split("\n").map(ie).filter(e=>null!==e);i(e),c(!0)},[r]),v=u.useCallback(()=>{const e=o.filter(e=>e.isValid).map(e=>({name:e.name,amount:e.amount,category:e.category}));e.length>0&&(a(e),n(""),i([]),c(!1),t())},[o,a,t]),f=u.useCallback(()=>{n(""),i([]),c(!1)},[]),j=u.useCallback(()=>d(this,null,function*(){try{const e=yield navigator.clipboard.readText();n(e),c(!1)}catch(e){}}),[]);if(!e)return null;const N=o.filter(e=>e.isValid).length,k=o.filter(e=>!e.isValid).length;return m.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:m.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-2xl max-h-[80vh] flex flex-col",children:[m.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b",children:[m.jsxs("h3",{className:"font-semibold text-lg flex items-center gap-2",children:[m.jsx(E,{className:"w-5 h-5 text-amber-600"}),s("components.bulkInput.title")]}),m.jsx("button",{onClick:t,className:"p-1 hover:bg-gray-100 rounded",children:m.jsx(g,{className:"w-5 h-5"})})]}),m.jsxs("div",{className:"flex-1 overflow-auto p-4 space-y-4",children:[m.jsxs("div",{className:"text-sm text-gray-600 bg-gray-50 p-3 rounded-lg",children:[m.jsx("p",{className:"font-medium mb-1",children:s("components.bulkInput.supportedFormats")}),m.jsxs("ul",{className:"text-xs space-y-0.5 text-gray-500",children:[m.jsxs("li",{children:["‚Ä¢ ",s("components.bulkInput.formatExample1")]}),m.jsxs("li",{children:["‚Ä¢ ",s("components.bulkInput.formatExample2")]}),m.jsxs("li",{children:["‚Ä¢ ",s("components.bulkInput.formatExample3")]})]})]}),m.jsxs("div",{children:[m.jsxs("div",{className:"flex items-center justify-between mb-2",children:[m.jsx("label",{className:"text-sm font-medium text-gray-700",children:s("components.bulkInput.ingredientList")}),m.jsxs("button",{onClick:j,className:"text-xs flex items-center gap-1 px-2 py-1 bg-gray-100 hover:bg-gray-200 rounded",children:[m.jsx(S,{className:"w-3 h-3"}),s("common.pasteFromClipboard")]})]}),m.jsx("textarea",{value:r,onChange:e=>{n(e.target.value),c(!1)},placeholder:s("components.bulkInput.placeholder"),className:"w-full h-40 p-3 border rounded-lg text-sm font-mono resize-none focus:ring-2 focus:ring-amber-500 focus:border-amber-500"})]}),l&&o.length>0&&m.jsxs("div",{className:"border rounded-lg overflow-hidden",children:[m.jsxs("div",{className:"bg-gray-50 px-3 py-2 border-b flex items-center justify-between",children:[m.jsx("span",{className:"text-sm font-medium",children:s("components.bulkInput.parseResult")}),m.jsxs("div",{className:"flex gap-2 text-xs",children:[N>0&&m.jsxs("span",{className:"text-green-600 flex items-center gap-1",children:[m.jsx(b,{className:"w-3 h-3"}),s("components.bulkInput.successCount",{count:N})]}),k>0&&m.jsxs("span",{className:"text-red-500 flex items-center gap-1",children:[m.jsx(y,{className:"w-3 h-3"}),s("components.bulkInput.failCount",{count:k})]})]})]}),m.jsx("div",{className:"max-h-48 overflow-auto",children:m.jsxs("table",{className:"w-full text-sm",children:[m.jsx("thead",{className:"bg-gray-50 sticky top-0",children:m.jsxs("tr",{children:[m.jsx("th",{className:"text-left px-3 py-1.5 font-medium",children:s("common.status")}),m.jsx("th",{className:"text-left px-3 py-1.5 font-medium",children:s("components.bulkInput.tableName")}),m.jsx("th",{className:"text-right px-3 py-1.5 font-medium",children:s("components.bulkInput.tableAmount")}),m.jsx("th",{className:"text-left px-3 py-1.5 font-medium",children:s("common.note")})]})}),m.jsx("tbody",{children:o.map((e,t)=>m.jsxs("tr",{className:"border-t "+(e.isValid?"":"bg-red-50"),children:[m.jsx("td",{className:"px-3 py-1.5",children:e.isValid?m.jsx(b,{className:"w-4 h-4 text-green-500"}):m.jsx(y,{className:"w-4 h-4 text-red-500"})}),m.jsx("td",{className:"px-3 py-1.5",children:e.name}),m.jsx("td",{className:"px-3 py-1.5 text-right font-mono",children:e.isValid?e.amount:"-"}),m.jsx("td",{className:"px-3 py-1.5 text-xs text-gray-500",children:e.error||(x(e.name)?s("components.bulkInput.dbMatched"):"")})]},t))})]})})]})]}),m.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-t bg-gray-50",children:[m.jsx("button",{onClick:f,className:"px-3 py-1.5 text-sm text-gray-600 hover:bg-gray-200 rounded",children:s("common.reset")}),m.jsxs("div",{className:"flex gap-2",children:[m.jsx("button",{onClick:t,className:"px-4 py-1.5 text-sm border rounded hover:bg-gray-100",children:s("common.cancel")}),l?m.jsx("button",{onClick:v,disabled:0===N,className:"px-4 py-1.5 text-sm bg-green-500 text-white rounded hover:bg-green-600 disabled:opacity-50 disabled:cursor-not-allowed",children:s("components.bulkInput.importCount",{count:N})}):m.jsx("button",{onClick:p,disabled:!r.trim(),className:"px-4 py-1.5 text-sm bg-amber-500 text-white rounded hover:bg-amber-600 disabled:opacity-50 disabled:cursor-not-allowed",children:s("common.parse")})]})]})]})})}const de={bread:{mixing:2,fermentation:1,dividing:1.5,shaping:1,baking:12,cooling:2},cake:{mixing:3,fermentation:0,dividing:0,shaping:0,baking:15,cooling:1.5},pastry:{mixing:1.5,fermentation:.5,dividing:2,shaping:2,baking:18,cooling:1},cookie:{mixing:2.5,fermentation:0,dividing:1,shaping:1.5,baking:8,cooling:.5},other:{mixing:2,fermentation:.5,dividing:1,shaping:1,baking:12,cooling:1.5}},ce={pullman:{baking:10},mountain:{baking:13},brioche:{baking:11,mixing:3},genoise:{baking:14,mixing:4},chiffon:{baking:13,mixing:3.5},pound:{baking:10,mixing:3},brownie:{baking:8},cheesecake:{baking:5},croissant:{baking:20,shaping:3},danish:{baking:18,shaping:2.5},puff_pastry:{baking:22},baguette:{baking:18,shaping:1.5},ciabatta:{baking:16,mixing:3},sourdough:{baking:15,fermentation:2},cookie:{baking:8},scone:{baking:12},tart:{baking:10,shaping:2}};const ue={mixing:!0,fermentation:!0,dividing:!0,shaping:!0,baking:!0,cooling:!0};function me(e,t,a,s,r){const n=i({},de[t]);a&&ce[a]&&Object.assign(n,ce[a]);const o=s?function(e){let t=1;void 0!==e.humidity&&(t*=1+.005*(60-e.humidity));void 0!==e.temperature&&(t*=1+.01*(e.temperature-25));return Math.max(.8,Math.min(1.3,t))}(s):1,l=[];let d=e;const c=[{key:"mixing",name:"ÎØπÏã±"},{key:"fermentation",name:"Î∞úÌö®"},{key:"dividing",name:"Î∂ÑÌï†"},{key:"shaping",name:"ÏÑ±Ìòï"},{key:"baking",name:"ÍµΩÍ∏∞"},{key:"cooling",name:"ÎÉâÍ∞Å"}],u=r||ue;for(const i of c){if(!u[i.key])continue;let e=n[i.key];if("baking"===i.key&&(e*=o),e<=0)continue;const t=Math.round(d*(e/100));d-=t,l.push({stage:i.name,lossPercent:Math.round(10*e)/10,lossWeight:t,remainingWeight:d})}const m=d,h=e-m,p=Math.round(h/e*1e3)/10,x=Math.round(m/e*1e3)/10,g=function(e,t,a,s){const r=[];"bread"===e?(r.push("Î∞òÏ£ΩÍ∏∞ ÎÇ¥Î∂ÄÏóê Ïò§Ïùº Ïä§ÌîÑÎ†àÏù¥Î°ú Î∞òÏ£Ω Î∂ôÏùå Î∞©ÏßÄ"),r.push("Î∂ÑÌï† Ïãú Ïä§ÌÅ¨ÎûòÌçºÏóê Î∞ÄÍ∞ÄÎ£® ÏÇ¨Ïö©")):"cake"===e?(r.push("Î≥º/ÌúòÌçºÏóê Î∂ôÏùÄ Î∞òÏ£ΩÏùÑ Íπ®ÎÅóÏù¥ Í∏ÅÏñ¥ ÏÇ¨Ïö©"),r.push("Ìå¨Ïóê Ïú†ÏÇ∞ÏßÄ ÍπîÏïÑ ÏÜêÏã§ ÏµúÏÜåÌôî")):"pastry"===e&&(r.push("ÏûëÏóÖÎåÄÏóê Î∞ÄÍ∞ÄÎ£® Ï†ÅÏ†àÌûà ÎøåÎ†§ Î∂ôÏùå Î∞©ÏßÄ"),r.push("Ï∞®Í∞ÄÏö¥ ÏÉÅÌÉúÎ°ú ÏûëÏóÖÌï¥ Î≤ÑÌÑ∞ Ïö©Ï∂ú Î∞©ÏßÄ"));"croissant"===t?r.push("ÍµΩÍ∏∞ ÌõÑ Î∞îÎ°ú ÏÑ†Î∞òÏóê Ïò¨Î†§ Î∞îÎã• ÎàÖÎàÖÌï® Î∞©ÏßÄ"):"baguette"===t?r.push("Ïä§ÌåÄ ÍµΩÍ∏∞Î°ú ÍªçÏßà ÌòïÏÑ± ÌõÑ ÏàòÎ∂Ñ Ï¶ùÎ∞ú Ï°∞Ï†à"):"chiffon"===t&&r.push("Ìå¨Ïóê Í∏∞Î¶Ñ Î∞îÎ•¥ÏßÄ ÏïäÏïÑÏïº ÎÜíÏù¥ Ïú†ÏßÄ");void 0!==(null==s?void 0:s.humidity)&&(s.humidity<50?r.push("Í±¥Ï°∞Ìïú ÌôòÍ≤Ω: Î∞òÏ£Ω ÎçÆÍ∞úÎ°ú ÌëúÎ©¥ Í±¥Ï°∞ Î∞©ÏßÄ"):s.humidity>70&&r.push("ÏäµÌïú ÌôòÍ≤Ω: ÍµΩÍ∏∞ ÏãúÍ∞Ñ ÏïΩÍ∞Ñ Ïó∞Ïû• Í≥†Î†§"));void 0!==(null==s?void 0:s.temperature)&&s.temperature>30&&r.push("Í≥†Ïò® ÌôòÍ≤Ω: Î∞òÏ£Ω Ïò®ÎèÑ Í¥ÄÎ¶¨Ïóê Ï£ºÏùò");return r}(t,a,0,s);return{inputWeight:e,outputWeight:m,totalLossPercent:p,totalLossWeight:h,yieldPercent:x,processLosses:l,tips:g}}const he=[{value:"bread",key:"bread"},{value:"cake",key:"cake"},{value:"pastry",key:"pastry"},{value:"cookie",key:"cookie"},{value:"other",key:"other"}],pe={bread:[{value:"",key:"general_bread"},{value:"pullman",key:"pullman"},{value:"mountain",key:"mountain"},{value:"brioche",key:"brioche"},{value:"baguette",key:"baguette"},{value:"ciabatta",key:"ciabatta"},{value:"sourdough",key:"sourdough"}],cake:[{value:"",key:"general_cake"},{value:"genoise",key:"genoise"},{value:"chiffon",key:"chiffon"},{value:"pound",key:"pound"},{value:"brownie",key:"brownie"},{value:"cheesecake",key:"cheesecake"}],pastry:[{value:"",key:"general_pastry"},{value:"croissant",key:"croissant"},{value:"danish",key:"danish"},{value:"puff_pastry",key:"puff_pastry"}],cookie:[{value:"",key:"general_cookie"},{value:"cookie",key:"cookie"},{value:"scone",key:"scone"}],other:[{value:"",key:"general_other"},{value:"tart",key:"tart"}]},xe=[{key:"mixing",translationKey:"mixing",icon:"ü•£"},{key:"fermentation",translationKey:"fermentation",icon:"üçû"},{key:"dividing",translationKey:"dividing",icon:"‚úÇÔ∏è"},{key:"shaping",translationKey:"shaping",icon:"üëê"},{key:"baking",translationKey:"baking",icon:"üî•"},{key:"cooling",translationKey:"cooling",icon:"‚ùÑÔ∏è"}];function ge({inputWeight:e,category:t,productType:a,environment:s,stageSelection:r,onStageSelectionChange:n,compact:o=!1,className:d=""}){var c;const{t:p}=h(),[x,g]=u.useState(1e3),[b,y]=u.useState("bread"),[j,N]=u.useState(""),[k,w]=u.useState(60),[C,D]=u.useState(25),[M,$]=u.useState(!o),[S,B]=u.useState(!1),[I,A]=u.useState(!0),[P,z]=u.useState("forward"),[O,E]=u.useState(800),[F,H]=u.useState(ue),K=null!=e?e:x,Y=null!=t?t:b,V=null!=a?a:j,U=null!=s?s:{humidity:k,temperature:C},_=null!=r?r:F,J=u.useCallback(e=>{const t=l(i({},_),{[e]:!_[e]});n?n(t):H(t)},[_,n]),X=u.useCallback(e=>{const t={mixing:e,fermentation:e,dividing:e,shaping:e,baking:e,cooling:e};n?n(t):H(t)},[n]),G=u.useMemo(()=>Object.values(_).filter(Boolean).length,[_]),Z=u.useMemo(()=>K<=0?null:me(K,Y,V||void 0,U,_),[K,Y,V,U,_]),Q=u.useMemo(()=>O<=0?0:function(e,t,a,s,r){const n=me(1e3,t,a,s,r).yieldPercent/100;return Math.ceil(e/n)}(O,Y,V||void 0,U,_),[O,Y,V,U,_]),ee=e=>e>=15?"text-red-600":e>=10?"text-orange-500":e>=5?"text-yellow-600":"text-green-600";return o&&Z?m.jsxs("div",{className:`flex items-center gap-2 text-sm ${d}`,children:[m.jsx(W,{className:"w-4 h-4 text-orange-500"}),m.jsxs("span",{children:[p("components.yieldLoss.expectedOutput"),": ",m.jsxs("b",{className:"text-blue-600",children:[Z.outputWeight.toLocaleString(),"g"]}),m.jsxs("span",{className:`ml-1 ${ee(Z.totalLossPercent)}`,children:["(-",Z.totalLossPercent,"%)"]}),G<6&&m.jsxs("span",{className:"ml-1 text-gray-400 text-xs",children:["(",G,p("components.yieldLoss.processes"),")"]})]})]}):m.jsxs("div",{className:`bg-white border rounded-lg shadow-sm ${d}`,children:[m.jsxs("div",{className:"flex items-center justify-between p-3 border-b bg-gradient-to-r from-orange-50 to-amber-50",children:[m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx(W,{className:"w-5 h-5 text-orange-600"}),m.jsx("h3",{className:"font-semibold text-gray-800",children:p("components.yieldLoss.title")})]}),m.jsxs("div",{className:"flex gap-1",children:[m.jsx("button",{onClick:()=>z("forward"),className:"px-2 py-1 text-xs rounded "+("forward"===P?"bg-orange-500 text-white":"bg-gray-100 text-gray-600"),children:p("components.yieldLoss.inputToOutput")}),m.jsx("button",{onClick:()=>z("reverse"),className:"px-2 py-1 text-xs rounded "+("reverse"===P?"bg-orange-500 text-white":"bg-gray-100 text-gray-600"),children:p("components.yieldLoss.outputToInput")})]})]}),m.jsxs("div",{className:"p-3 space-y-3",children:[!t&&m.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[m.jsxs("div",{children:[m.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:p("components.yieldLoss.productType")}),m.jsx("select",{value:b,onChange:e=>{y(e.target.value),N("")},className:"w-full px-2 py-1.5 text-sm border rounded",children:he.map(e=>m.jsx("option",{value:e.value,children:p(`components.yieldLoss.categories.${e.key}`)},e.value))})]}),m.jsxs("div",{children:[m.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:p("components.yieldLoss.detailProduct")}),m.jsx("select",{value:j,onChange:e=>N(e.target.value),className:"w-full px-2 py-1.5 text-sm border rounded",children:pe[b].map(e=>m.jsx("option",{value:e.value,children:p(`components.yieldLoss.products.${e.key}`)},e.value))})]})]}),m.jsxs("div",{children:[m.jsxs("button",{onClick:()=>A(!I),className:"flex items-center gap-1 text-xs text-gray-600 hover:text-gray-800 mb-2",children:[I?m.jsx(T,{className:"w-3 h-3"}):m.jsx(q,{className:"w-3 h-3"}),m.jsx("span",{className:"font-medium",children:p("components.yieldLoss.processSelection")}),m.jsxs("span",{className:"text-gray-400",children:["(",G,"/6 ",p("components.yieldLoss.selectedProcesses"),")"]})]}),I&&m.jsxs("div",{className:"p-2 bg-gray-50 rounded space-y-2",children:[m.jsxs("div",{className:"flex justify-between items-center mb-1",children:[m.jsx("span",{className:"text-xs text-gray-500",children:p("components.yieldLoss.selectProcessesForCalc")}),m.jsxs("div",{className:"flex gap-1",children:[m.jsx("button",{onClick:()=>X(!0),className:"px-2 py-0.5 text-xs bg-blue-100 text-blue-600 rounded hover:bg-blue-200",children:p("components.yieldLoss.selectAll")}),m.jsx("button",{onClick:()=>X(!1),className:"px-2 py-0.5 text-xs bg-gray-200 text-gray-600 rounded hover:bg-gray-300",children:p("components.yieldLoss.deselectAll")})]})]}),m.jsx("div",{className:"grid grid-cols-3 gap-1",children:xe.map(e=>m.jsxs("button",{onClick:()=>J(e.key),className:"flex items-center gap-1 px-2 py-1.5 rounded text-xs transition-colors "+(_[e.key]?"bg-orange-100 text-orange-700 border border-orange-300":"bg-white text-gray-400 border border-gray-200 line-through"),children:[m.jsx("span",{children:e.icon}),m.jsx("span",{children:p(`components.yieldLoss.stages.${e.translationKey}`)}),_[e.key]&&m.jsx(R,{className:"w-3 h-3 ml-auto"})]},e.key))}),G<6&&m.jsxs("div",{className:"text-xs text-orange-600 flex items-center gap-1",children:[m.jsx(L,{className:"w-3 h-3"}),p("components.yieldLoss.processesExcluded",{count:6-G})]})]})]}),m.jsx("div",{className:"flex items-center gap-3",children:"forward"===P?m.jsxs(m.Fragment,{children:[m.jsxs("div",{className:"flex-1",children:[m.jsxs("label",{className:"block text-xs text-gray-500 mb-1",children:[p("components.yieldLoss.inputWeight")," (g)"]}),m.jsx("input",{type:"number",value:null!=e?e:x,onChange:t=>!e&&g(parseInt(t.target.value)||0),disabled:!!e,className:"w-full px-2 py-1.5 text-sm border rounded text-right font-mono"})]}),m.jsx("div",{className:"flex items-center pt-5",children:m.jsx("span",{className:"text-gray-400",children:"‚Üí"})}),m.jsxs("div",{className:"flex-1",children:[m.jsxs("label",{className:"block text-xs text-gray-500 mb-1",children:[p("components.yieldLoss.expectedOutput")," (g)",G<6&&m.jsxs("span",{className:"text-orange-500 ml-1",children:["*",G,p("components.yieldLoss.processes")]})]}),m.jsx("div",{className:"px-2 py-1.5 text-sm bg-blue-50 border border-blue-200 rounded text-right font-mono font-semibold text-blue-700",children:null!=(c=null==Z?void 0:Z.outputWeight.toLocaleString())?c:"-"})]})]}):m.jsxs(m.Fragment,{children:[m.jsxs("div",{className:"flex-1",children:[m.jsxs("label",{className:"block text-xs text-gray-500 mb-1",children:[p("components.yieldLoss.targetOutput")," (g)"]}),m.jsx("input",{type:"number",value:O,onChange:e=>E(parseInt(e.target.value)||0),className:"w-full px-2 py-1.5 text-sm border rounded text-right font-mono"})]}),m.jsx("div",{className:"flex items-center pt-5",children:m.jsx("span",{className:"text-gray-400",children:"‚Üê"})}),m.jsxs("div",{className:"flex-1",children:[m.jsxs("label",{className:"block text-xs text-gray-500 mb-1",children:[p("components.yieldLoss.requiredInput")," (g)"]}),m.jsx("div",{className:"px-2 py-1.5 text-sm bg-green-50 border border-green-200 rounded text-right font-mono font-semibold text-green-700",children:Q.toLocaleString()})]})]})}),"forward"===P&&Z&&m.jsxs("div",{className:"flex items-center justify-between px-3 py-2 bg-gray-50 rounded",children:[m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx(v,{className:"w-4 h-4 text-gray-500"}),m.jsx("span",{className:"text-sm text-gray-600",children:p("components.yieldLoss.yield")})]}),m.jsxs("div",{className:"flex items-center gap-3",children:[m.jsxs("span",{className:"text-lg font-bold text-blue-600",children:[Z.yieldPercent,"%"]}),m.jsxs("span",{className:`text-sm ${ee(Z.totalLossPercent)}`,children:["(",p("components.yieldLoss.loss")," ",Z.totalLossPercent,"% / ",Z.totalLossWeight.toLocaleString(),"g)"]})]})]}),!s&&m.jsxs("button",{onClick:()=>B(!S),className:"flex items-center gap-1 text-xs text-gray-500 hover:text-gray-700",children:[S?m.jsx(T,{className:"w-3 h-3"}):m.jsx(q,{className:"w-3 h-3"}),p("components.yieldLoss.envSettings")]}),S&&!s&&m.jsxs("div",{className:"grid grid-cols-2 gap-2 p-2 bg-gray-50 rounded",children:[m.jsxs("div",{children:[m.jsxs("label",{className:"block text-xs text-gray-500 mb-1",children:[p("components.yieldLoss.humidity")," (%)"]}),m.jsx("input",{type:"number",value:k,onChange:e=>w(parseInt(e.target.value)||60),min:20,max:90,className:"w-full px-2 py-1 text-sm border rounded text-right"})]}),m.jsxs("div",{children:[m.jsxs("label",{className:"block text-xs text-gray-500 mb-1",children:[p("components.yieldLoss.roomTemp")," (¬∞C)"]}),m.jsx("input",{type:"number",value:C,onChange:e=>D(parseInt(e.target.value)||25),min:15,max:40,className:"w-full px-2 py-1 text-sm border rounded text-right"})]}),(60!==k||25!==C)&&m.jsxs("div",{className:"col-span-2 flex items-start gap-1 text-xs text-orange-600",children:[m.jsx(L,{className:"w-3 h-3 mt-0.5 flex-shrink-0"}),m.jsx("span",{children:p("components.yieldLoss.envNote")})]})]}),"forward"===P&&Z&&m.jsxs("button",{onClick:()=>$(!M),className:"flex items-center gap-1 text-xs text-blue-600 hover:text-blue-800",children:[M?m.jsx(T,{className:"w-3 h-3"}):m.jsx(q,{className:"w-3 h-3"}),p("components.yieldLoss.processDetails")]}),M&&"forward"===P&&Z&&m.jsxs("div",{className:"space-y-2",children:[m.jsx("div",{className:"text-xs text-gray-500 mb-2",children:p("components.yieldLoss.processDetailsDesc")}),Z.processLosses.map((e,t)=>m.jsxs("div",{className:"flex items-center text-sm",children:[m.jsx("div",{className:"w-12 text-gray-600",children:e.stage}),m.jsx("div",{className:"flex-1 mx-2",children:m.jsx("div",{className:"h-2 bg-gray-200 rounded overflow-hidden",children:m.jsx("div",{className:"h-full "+(e.lossPercent>=10?"bg-red-400":e.lossPercent>=5?"bg-orange-400":"bg-yellow-400"),style:{width:`${Math.min(5*e.lossPercent,100)}%`}})})}),m.jsxs("div",{className:"w-16 text-right text-gray-500",children:["-",e.lossPercent,"%"]}),m.jsxs("div",{className:"w-20 text-right font-mono text-gray-600",children:["-",e.lossWeight,"g"]}),m.jsxs("div",{className:"w-24 text-right font-mono text-gray-400",children:["‚Üí ",e.remainingWeight.toLocaleString(),"g"]})]},t))]}),Z&&Z.tips.length>0&&m.jsxs("div",{className:"p-2 bg-blue-50 rounded text-xs",children:[m.jsxs("div",{className:"flex items-center gap-1 text-blue-700 font-medium mb-1",children:[m.jsx(f,{className:"w-3 h-3"}),p("components.yieldLoss.minimizeLossTips")]}),m.jsx("ul",{className:"list-disc list-inside text-blue-600 space-y-0.5",children:Z.tips.slice(0,3).map((e,t)=>m.jsx("li",{children:e},t))})]})]})]})}const be={"ÌíÄÎ®ºÏãùÎπµ":3.4,"ÏÇ∞ÌòïÏãùÎπµ":4.2,"Î≤ÑÌÑ∞ÌÜ±ÏãùÎπµ":4,"Ïò•ÏàòÏàòÏãùÎπµ":3.8,"Ïö∞Ïú†ÏãùÎπµ":4,"Î™®ÎãùÎπµ":3.2,"Î≤†Ïù¥Í∏Ä":2.5,"Î∏åÎ¶¨Ïò§Ïäà":3.5,"ÏπòÏïÑÎ∞îÌÉÄ":5,"Î∞îÍ≤åÌä∏":5.5},ye={"ÌååÏö¥ÎìúÏºÄÏù¥ÌÅ¨":.83,"Î†àÏù¥Ïñ¥ÏºÄÏù¥ÌÅ¨":.83,"Ïä§ÌéÄÏßÄÏºÄÏù¥ÌÅ¨":.55,"ÏãúÌè∞ÏºÄÏù¥ÌÅ¨":.45,"ÏóîÏ†§Ìë∏ÎìúÏºÄÏù¥ÌÅ¨":.4,"Î¨¥Ïä§ÏºÄÏù¥ÌÅ¨":.9},ve={"ÌååÏö¥ÎìúÏºÄÏù¥ÌÅ¨":2.5,"Î†àÏù¥Ïñ¥ÏºÄÏù¥ÌÅ¨":2.5,"Ïä§ÌéÄÏßÄÏºÄÏù¥ÌÅ¨":2.3,"ÏãúÌè∞ÏºÄÏù¥ÌÅ¨":3.2,"ÏóîÏ†§Ìë∏ÎìúÏºÄÏù¥ÌÅ¨":4.5,"Î¨¥Ïä§ÏºÄÏù¥ÌÅ¨":1.8},fe=e=>Object.keys(ye).includes(e),je={straight:{flour:0,water:0},sponge:{flour:.5,water:.6},poolish:{flour:.3,water:1},biga:{flour:.3,water:.55},tangzhong:{flour:.1,water:5},autolyse:{flour:1,water:.65},levain:{flour:.2,water:1},coldFerment:{flour:0,water:0},retard:{flour:0,water:0}},Ne={straight:{yeastAdjustment:1,prefermentYeastRatio:0},sponge:{yeastAdjustment:.75,prefermentYeastRatio:1},poolish:{yeastAdjustment:.66,prefermentYeastRatio:.15},biga:{yeastAdjustment:.5,prefermentYeastRatio:.1},tangzhong:{yeastAdjustment:1,prefermentYeastRatio:0},autolyse:{yeastAdjustment:1,prefermentYeastRatio:0},levain:{yeastAdjustment:0,prefermentYeastRatio:0},coldFerment:{yeastAdjustment:.4,prefermentYeastRatio:0},retard:{yeastAdjustment:1,prefermentYeastRatio:0}},ke={straight:"method.straight",sponge:"method.sponge",poolish:"method.poolish",biga:"method.biga",tangzhong:"method.tangzhong",autolyse:"method.autolyse",levain:"method.levain",coldFerment:"method.coldFerment",retard:"method.retard"},we={tangzhong:{icon:"üçú",labelKey:"phase.tangzhong",bgColor:"bg-pink-50",textColor:"text-pink-700",borderColor:"border-pink-200"},preferment:{icon:"üß™",labelKey:"phase.preferment",bgColor:"bg-amber-50",textColor:"text-amber-700",borderColor:"border-amber-200"},poolish:{icon:"üß™",labelKey:"phase.poolish",bgColor:"bg-amber-50",textColor:"text-amber-700",borderColor:"border-amber-200"},biga:{icon:"üß™",labelKey:"phase.biga",bgColor:"bg-amber-50",textColor:"text-amber-700",borderColor:"border-amber-200"},sponge:{icon:"üß™",labelKey:"phase.sponge",bgColor:"bg-amber-50",textColor:"text-amber-700",borderColor:"border-amber-200"},levain:{icon:"ü•ñ",labelKey:"phase.levain",bgColor:"bg-amber-50",textColor:"text-amber-700",borderColor:"border-amber-200"},autolyse:{icon:"‚è≥",labelKey:"phase.autolyse",bgColor:"bg-purple-50",textColor:"text-purple-700",borderColor:"border-purple-200"},main:{icon:"üçû",labelKey:"phase.mainDough",bgColor:"bg-blue-50",textColor:"text-blue-700",borderColor:"border-blue-200"},topping:{icon:"‚ú®",labelKey:"phase.topping",bgColor:"bg-orange-50",textColor:"text-orange-700",borderColor:"border-orange-200"},filling:{icon:"üéÇ",labelKey:"phase.filling",bgColor:"bg-rose-50",textColor:"text-rose-700",borderColor:"border-rose-200"},frosting:{icon:"üç∞",labelKey:"phase.frosting",bgColor:"bg-indigo-50",textColor:"text-indigo-700",borderColor:"border-indigo-200"},glaze:{icon:"üíß",labelKey:"phase.glaze",bgColor:"bg-cyan-50",textColor:"text-cyan-700",borderColor:"border-cyan-200"},other:{icon:"üì¶",labelKey:"ingredientCategory.other",bgColor:"bg-gray-50",textColor:"text-gray-700",borderColor:"border-gray-200"}},Ce=({title:e,icon:t,defaultOpen:a=!0,badge:s,badgeColor:r="bg-amber-100 text-amber-700",onReset:n,children:o})=>{const[i,l]=u.useState(a);return m.jsxs("div",{className:"border-b border-gray-200 last:border-b-0",children:[m.jsxs("div",{className:"flex items-center justify-between px-3 py-2 hover:bg-gray-50",children:[m.jsxs("button",{onClick:()=>l(!i),className:"flex-1 flex items-center gap-2 text-sm font-semibold text-gray-700 text-left",children:[t,m.jsx("span",{children:e}),s&&m.jsx("span",{className:`px-1.5 py-0.5 text-xs rounded ${r}`,children:s})]}),m.jsxs("div",{className:"flex items-center gap-1",children:[n&&m.jsx("button",{onClick:e=>{e.stopPropagation(),n()},className:"p-1 text-gray-400 hover:text-amber-600 hover:bg-amber-50 rounded transition-colors",title:"Ï¥àÍ∏∞Ìôî",children:m.jsx(B,{className:"w-3.5 h-3.5"})}),m.jsx("button",{onClick:()=>l(!i),className:"p-1",children:i?m.jsx(q,{className:"w-4 h-4 text-gray-400"}):m.jsx(z,{className:"w-4 h-4 text-gray-400"})})]})]}),i&&m.jsx("div",{className:"px-3 pb-3",children:o})]})},De=()=>{var e,t,a,s,r;const{t:n}=h(),{translateIngredient:o,translateProcessStep:c,getLocalizedPanCategory:b,getLocalizedPanName:y,getLocalizedProductName:f}=j(),{addRecipe:S,updateRecipe:R,currentRecipe:L,recipes:z}=N(),{addToast:Z}=k(),{pan:Q,product:ee,method:te}=p(),ae=u.useMemo(()=>i(i(i(i({},be),ve),ee.breadVolumes),ee.customProducts.filter(e=>"bread"===e.category||"pastry"===e.category).reduce((e,t)=>l(i({},e),{[t.name]:t.specificVolume}),{})),[ee.breadVolumes,ee.customProducts]),se=u.useMemo(()=>{const e={};return Q.myPans.forEach(t=>{const a=t.category||"Í∏∞ÌÉÄ";e[a]||(e[a]=[]),e[a].push({name:t.name,volume:t.volume})}),0===Object.keys(e).length&&(e["ÏãùÎπµÌãÄ"]=[{name:"Í∏∞Î≥∏ ÏãùÎπµÌãÄ",volume:2350}]),e},[Q.myPans]),re=u.useMemo(()=>({flour:n("dashboard.flour"),liquid:n("dashboard.liquid"),wetOther:n("dashboard.fat"),other:n("dashboard.other")}),[n]),oe=u.useMemo(()=>({straight:n("method.straight"),sponge:n("method.sponge"),poolish:n("method.poolish"),biga:n("method.biga"),tangzhong:n("method.tangzhong"),autolyse:n("method.autolyse"),levain:n("method.levain"),coldFerment:n("method.coldFerment"),retard:n("method.retard")}),[n]),ie=u.useMemo(()=>Object.keys(se),[se]),de=ie[0]||"ÏãùÎπµÌãÄ",ce=(null==(t=null==(e=se[de])?void 0:e[0])?void 0:t.name)||"Ïò•ÏàòÏàò ÏãùÎπµÌãÄ (22.5cm)",me=(null==(s=null==(a=se[de])?void 0:a[0])?void 0:s.volume)||2350,he=u.useCallback(e=>e&&ie.includes(e)?e:de,[ie,de]),pe=u.useCallback((e,t)=>{var a;const s=se[e];if(s&&t){if(s.find(e=>e.name===t))return t}return(null==(a=null==s?void 0:s[0])?void 0:a.name)||ce},[se,ce]),{settings:xe,setSidebarWidth:De,setProcessPanelHeight:Me,setProcessItemSize:$e,getProcessItemSize:Se,resetSettings:We}=function(){const[e,t]=u.useState(()=>{if("undefined"!=typeof window)try{const e=localStorage.getItem(J);if(e){const t=JSON.parse(e);return i(i({},X),t)}}catch(e){}return X});u.useEffect(()=>{const t=setTimeout(()=>{try{localStorage.setItem(J,JSON.stringify(e))}catch(t){}},300);return()=>clearTimeout(t)},[e]);const a=u.useCallback(e=>{t(t=>l(i({},t),{sidebarWidth:Math.max(200,Math.min(500,e))}))},[]),s=u.useCallback(e=>{t(t=>l(i({},t),{recipeContainerHeight:Math.max(.3,Math.min(.8,e))}))},[]),r=u.useCallback(e=>{t(t=>l(i({},t),{processRowHeight:Math.max(28,Math.min(80,e))}))},[]),n=u.useCallback(e=>{t(t=>l(i({},t),{processPanelHeight:Math.max(120,Math.min(500,e))}))},[]),o=u.useCallback((e,a)=>{t(t=>{var s,r,n,o,d;return l(i({},t),{processItems:l(i({},t.processItems),{[e]:l(i({},t.processItems[e]),{width:null!=(n=null!=(r=a.width)?r:null==(s=t.processItems[e])?void 0:s.width)?n:120,minHeight:null!=(d=a.minHeight)?d:null==(o=t.processItems[e])?void 0:o.minHeight})})})})},[]),d=u.useCallback(t=>e.processItems[t]||{width:120},[e.processItems]),c=u.useCallback(()=>{t(X),localStorage.removeItem(J)},[]);return{settings:e,setSidebarWidth:a,setRecipeContainerHeight:s,setProcessRowHeight:r,setProcessPanelHeight:n,setProcessItemSize:o,getProcessItemSize:d,resetSettings:c}}(),[Te,Re]=u.useState(n("advDashboard.defaultRecipeName")),[Le,Be]=u.useState("bread"),[Ie,Ae]=u.useState({name:"",type:"personal",url:"",author:""}),qe=me,Pe=Math.round(qe/3.4),[ze,Oe]=u.useState({mode:"pan",category:de,type:ce,quantity:1,panWeight:Pe,divisionCount:1,divisionWeight:Pe,unitCount:10,unitWeight:50}),[Ee,Fe]=u.useState([{id:"1",mode:"pan",category:de,type:ce,quantity:1,divisionCount:1,panWeight:Pe,divisionWeight:Pe,unitCount:10,unitWeight:50}]),[He,Ke]=u.useState("ÏÇ∞ÌòïÏãùÎπµ"),[Ye,Ve]=u.useState("ÏÇ∞ÌòïÏãùÎπµ"),[Ue,_e]=u.useState({type:"convection",level:"",firstBake:{topTemp:200,bottomTemp:170,time:24},secondBake:{topTemp:0,bottomTemp:0,time:0}}),[Je,Xe]=u.useState({type:"straight",flourRatio:0,waterRatio:0,yeastAdjustment:1,prefermentYeastRatio:0}),[Ge,Ze]=u.useState(!1),[Qe,et]=u.useState([{id:"1",order:1,category:"flour",subCategory:"Í∞ÄÎ£®",name:"Í∞ïÎ†•Î∂Ñ",ratio:100,amount:500,note:""},{id:"2",order:2,category:"liquid",subCategory:"ÏàòÎ∂Ñ",name:"Î¨º",ratio:70,amount:350,note:""},{id:"3",order:3,category:"other",subCategory:"Í∏∞ÌÉÄ",name:"ÏÜåÍ∏à",ratio:2,amount:10,note:""},{id:"4",order:4,category:"other",subCategory:"Í∏∞ÌÉÄ",name:"Ïù¥Ïä§Ìä∏",ratio:1,amount:5,note:""},{id:"5",order:5,category:"other",subCategory:"Í∏∞ÌÉÄ",name:"ÏÑ§ÌÉï",ratio:6,amount:30,note:""},{id:"6",order:6,category:"wetOther",subCategory:"Ïú†ÏßÄ",name:"Î≤ÑÌÑ∞",ratio:10,amount:50,note:""}]),[tt,at]=u.useState([{id:"1",order:1,description:"Ïû¨Î£å Í≥ÑÎüâ",time:10},{id:"2",order:2,description:"1Ï∞® ÎØπÏã± (Ï†ÄÏÜç 3Î∂Ñ ‚Üí Ï§ëÏÜç 5Î∂Ñ)",time:8},{id:"3",order:3,description:"1Ï∞® Î∞úÌö® (27¬∞C, 75%)",time:60,temp:27},{id:"4",order:4,description:"Î∂ÑÌï† Î∞è Îë•Í∏ÄÎ¶¨Í∏∞"},{id:"5",order:5,description:"Ï§ëÍ∞Ñ Î∞úÌö®",time:15},{id:"6",order:6,description:"ÏÑ±Ìòï Î∞è Ìå®Îãù"},{id:"7",order:7,description:"2Ï∞® Î∞úÌö® (35¬∞C, 85%)",time:50,temp:35},{id:"8",order:8,description:"ÍµΩÍ∏∞",time:24,temp:200}]),[st,rt]=u.useState(""),[nt,ot]=u.useState(null),[it,lt]=u.useState(i({},ue)),dt=u.useRef(null);u.useEffect(()=>{var e,t,a,s;if(L){const r=`${L.id}-${(null==(e=L.updatedAt)?void 0:e.toString())||""}`;if(r===dt.current)return;dt.current=r,Re(L.name||n("advDashboard.defaultRecipeName")),Be(L.productType||"bread"),L.source?Ae({name:L.source.name||"",type:L.source.type||"personal",url:L.source.url||"",author:L.source.author||""}):Ae({name:"",type:"personal",url:"",author:""});const o=[];if(L.phases&&Array.isArray(L.phases)&&L.phases.length>0){let e=1;L.phases.forEach(t=>{t.ingredients&&Array.isArray(t.ingredients)&&t.ingredients.forEach((a,s)=>{const r=a.category||"other";let n="other",i="Í∏∞ÌÉÄ";"flour"===r||a.isFlour?(n="flour",i="Í∞ÄÎ£®"):"liquid"===r?(n="liquid",i="ÏàòÎ∂Ñ"):"fat"===r&&(n="wetOther",i="Ïú†ÏßÄ"),o.push({id:a.id||`${Date.now()}-${t.id}-${s}`,order:e++,category:n,subCategory:i,name:a.name||"",ratio:a.percentage||0,amount:parseFloat(a.amount)||0,note:a.note||"",moistureContent:a.moistureContent,phase:t.type||t.id||"main",phaseOrder:t.order||0})})})}else L.ingredients&&Array.isArray(L.ingredients)&&L.ingredients.forEach((e,t)=>{const a=e.category||e.type||"other";let s="other",r="Í∏∞ÌÉÄ";"flour"===a||e.isFlour?(s="flour",r="Í∞ÄÎ£®"):"liquid"===a?(s="liquid",r="ÏàòÎ∂Ñ"):"fat"===a&&(s="wetOther",r="Ïú†ÏßÄ"),o.push({id:e.id||`${Date.now()}-${t}`,order:t+1,category:s,subCategory:r,name:e.name||"",ratio:e.percentage||0,amount:parseFloat(e.amount)||0,note:e.note||"",moistureContent:e.moistureContent,phase:e.phase||"main",phaseOrder:e.phaseOrder||0})});if(o.length>0&&et(o),L.steps&&Array.isArray(L.steps)){const e=L.steps.map((e,t)=>{var a,s;return{id:e.id||`${Date.now()}-${t}`,order:e.order||t+1,description:e.instruction||e.action||e.description||"",time:(null==(a=e.duration)?void 0:a.target)||e.time,temp:(null==(s=e.temperature)?void 0:s.target)||e.temp}});e.length>0&&at(e)}if(L.ovenSettings){const e=L.ovenSettings,t=e.secondBake;_e({type:"deck"===e.mode?"deck":"airfryer"===e.mode?"airfryer":"convection",level:e.deck||"",firstBake:{topTemp:e.temperature||200,bottomTemp:e.bottomTemperature||e.temperature||170,time:e.duration||24},secondBake:t?{topTemp:t.topTemp||0,bottomTemp:t.bottomTemp||0,time:t.time||0}:{topTemp:0,bottomTemp:0,time:0}})}if(L.method){const e=L.method;let r=e.method||e.type||"straight";"sourdough"===r&&(r="levain");["straight","sponge","poolish","biga","tangzhong","autolyse","levain","coldFerment","retard"].includes(r)||(r="straight");const n=null==(t=null==te?void 0:te.methods)?void 0:t[r],o=Ne[r]||{yeastAdjustment:1,prefermentYeastRatio:0};Xe({type:r,flourRatio:e.prefermentRatio||0,waterRatio:e.waterRatio||0,yeastAdjustment:null!=(a=null==n?void 0:n.yeastAdjustment)?a:o.yeastAdjustment,prefermentYeastRatio:null!=(s=null==n?void 0:n.prefermentYeastRatio)?s:o.prefermentYeastRatio}),Ze("straight"!==r)}if(L.panConfig){const e=L.panConfig,t=e.name||e.category||de,a=he(t),s=e.type||ce,r=pe(a,s),n=e.quantity||1,o=e.mode||"pan";let d=e.panWeight;if(!d){let e=me;for(const[,a]of Object.entries(se)){const t=a.find(e=>e.name===r);if(t){e=t.volume;break}}const t=ae[Ye]||4.2;d=Math.round(e/t)}if(e.originalPan){const t=e.originalPan,a=Math.max(1,t.unitCount||10),s=Math.max(1,t.unitWeight||50),r=he(t.category),n=pe(r,t.type);let o=Math.abs(t.panWeight||500);"count"===t.mode&&(o=a*s),Oe(l(i({},t),{category:r,type:n,panWeight:o,quantity:Math.max(1,Math.abs(t.quantity||1)),divisionCount:Math.max(1,t.divisionCount||1),divisionWeight:Math.abs(t.divisionWeight||o||500),unitCount:a,unitWeight:s}))}else Oe(e=>l(i({},e),{mode:o,category:a,type:r,quantity:Math.max(1,n),panWeight:Math.abs(d||500),divisionWeight:Math.abs(d||500)}));if(e.pans&&Array.isArray(e.pans)&&e.pans.length>0){const t=e.pans.map(e=>{const t=Math.max(1,e.unitCount||10),a=Math.max(1,e.unitWeight||50),s=he(e.category),r=pe(s,e.type);let n=Math.abs(e.panWeight||500);return"count"===e.mode&&(n=t*a),l(i({},e),{category:s,type:r,panWeight:n,quantity:Math.max(1,Math.abs(e.quantity||1)),divisionCount:Math.max(1,e.divisionCount||1),divisionWeight:Math.abs(e.divisionWeight||n||500),unitCount:t,unitWeight:a})});Fe(t)}else Fe([{id:"1",mode:o,category:a,type:r,quantity:Math.max(1,n),divisionCount:1,panWeight:Math.abs(d||500),divisionWeight:Math.abs(d||500),unitCount:10,unitWeight:50}])}if(L.specificVolume){const e=L.specificVolume;e.original&&Ke(e.original),e.converted&&Ve(e.converted)}else if(L.tags&&Array.isArray(L.tags)){const e=L.tags.find(e=>void 0!==ae[e]);e&&(Ke(e),Ve(e))}if(L.multiplierConfig){const e=L.multiplierConfig;"number"==typeof e.multiplier&&ut(Math.max(.01,Math.abs(e.multiplier)||1)),"boolean"==typeof e.isPanLinked&&ht(e.isPanLinked)}L.notes&&rt(L.notes),L.yieldStageSelection?lt(i(i({},ue),L.yieldStageSelection)):lt(i({},ue)),Z({type:"success",message:n("advDashboard.recipeLoaded",{name:L.name})})}},[L]);const[ct,ut]=u.useState(1),[mt,ht]=u.useState(!0),[pt,xt]=u.useState("1"),gt=u.useCallback(e=>{const t=e.trim().toLowerCase();if(!t)return null;let a=t.match(/^[x√ó*]?\s*(\d+\.?\d*)\s*[x√óÎ∞∞]?$/);if(a){const e=parseFloat(a[1]);if(!isNaN(e)&&e>0)return e}if(a=t.match(/^[/√∑]\s*(\d+\.?\d*)$/),a){const e=parseFloat(a[1]);if(!isNaN(e)&&e>0)return 1/e}if(a=t.match(/^(\d+)\s*[/√∑]\s*(\d+)$/),a){const e=parseFloat(a[1]),t=parseFloat(a[2]);if(!isNaN(e)&&!isNaN(t)&&t>0)return e/t}const s=parseFloat(t);return!isNaN(s)&&s>0?s:null},[]),bt=u.useCallback(e=>{xt(e)},[]),yt=u.useCallback(()=>{const e=gt(pt);if(null!==e){const t=Math.max(.01,Math.min(100,e));ut(Math.round(100*t)/100),xt(String(Math.round(100*t)/100))}else xt(String(ct))},[pt,ct,gt]),vt=u.useCallback(e=>{ut(e),xt(String(e))},[]),ft=u.useMemo(()=>Qe.filter(e=>"flour"===e.category).reduce((e,t)=>e+t.amount,0),[Qe]),jt=u.useMemo(()=>Qe.filter(e=>"liquid"===e.category).reduce((e,t)=>e+t.amount,0),[Qe]),Nt=u.useMemo(()=>Qe.filter(e=>"wetOther"===e.category&&e.moistureContent).reduce((e,t)=>e+t.amount*(t.moistureContent||0),0),[Qe]),kt=u.useMemo(()=>Qe.reduce((e,t)=>e+t.amount,0),[Qe]),wt=u.useMemo(()=>{const e={tangzhong:0,preferment:1,poolish:1,biga:1,sponge:1,levain:1,autolyse:2,main:10,topping:20,filling:21,frosting:22,glaze:23,other:99},t={flour:0,liquid:1,wetOther:2,other:3},a=Qe.reduce((e,t)=>{const a=t.phase||"main";return e[a]||(e[a]=[]),e[a].push(t),e},{});return Object.entries(a).sort(([t],[a])=>{var s,r;return(null!=(s=e[t])?s:50)-(null!=(r=e[a])?r:50)}).map(([e,a])=>({phase:e,items:a.sort((e,a)=>{var s,r;return(null!=(s=t[e.category])?s:99)-(null!=(r=t[a.category])?r:99)})}))},[Qe]),Ct=wt.length>1,Dt=u.useMemo(()=>0===ft?0:Math.round((jt+Nt)/ft*1e3)/10,[ft,jt,Nt]),Mt=u.useMemo(()=>{if("count"===ze.mode)return Math.max((ze.unitCount||10)*(ze.unitWeight||50),1);const e=Math.abs(ze.panWeight||500),t=Math.max(1,Math.abs(ze.quantity||1));return Math.max(e*t,1)},[ze.panWeight,ze.quantity,ze.mode,ze.unitCount,ze.unitWeight]),$t=u.useMemo(()=>{const e=Ee.reduce((e,t)=>{if("count"===t.mode)return e+(t.unitCount||10)*(t.unitWeight||50);return e+Math.abs(t.panWeight||0)*Math.abs(t.quantity||1)},0);return Math.max(e,0)},[Ee]),St=u.useMemo(()=>{const e=Math.abs(Mt)||1,t=Math.abs($t)||1;if(0===e)return 1;const a=t/e;return Math.max(.01,Math.round(100*a)/100)},[$t,Mt]),Wt=mt?St:ct;u.useEffect(()=>{Fe(e=>e.map(e=>{var t;if("count"===e.mode)return e;const a=null==(t=se[e.category])?void 0:t.find(t=>t.name===e.type);if(a){const t=Math.round(a.volume/(ae[Ye]||3.4));return l(i({},e),{panWeight:t,divisionWeight:Math.round(t/e.divisionCount)})}return e}))},[Ye]),u.useEffect(()=>{var e;if("count"===ze.mode)return;const t=null==(e=se[ze.category])?void 0:e.find(e=>e.name===ze.type);if(t){const e=Math.round(t.volume/(ae[He]||3.4));Oe(t=>l(i({},t),{panWeight:e,divisionWeight:Math.round(e/t.divisionCount)}))}},[He,ze.mode,ze.category,ze.type]),u.useEffect(()=>{Fe(e=>e.map(e=>{var t;if(e.mode===ze.mode)return e;const a=l(i({},e),{mode:ze.mode});if("count"===ze.mode)a.panWeight=(a.unitCount||10)*(a.unitWeight||50),a.divisionCount=1,a.divisionWeight=a.panWeight;else{const e=null==(t=se[a.category])?void 0:t.find(e=>e.name===a.type);e&&(a.panWeight=Math.round(e.volume/(ae[Ye]||3.4)),a.divisionWeight=Math.round(a.panWeight/a.divisionCount))}return a}))},[ze.mode,Ye]);const Tt=u.useMemo(()=>Math.round(kt*Wt),[kt,Wt]),Rt=u.useMemo(()=>0===Tt?0:Math.round($t/Tt*1e3)/10,[$t,Tt]),Lt=u.useMemo(()=>Qe.map(e=>l(i({},e),{convertedAmount:Math.round(e.amount*Wt*10)/10})),[Qe,Wt]),Bt=u.useMemo(()=>{var e,t;if(!Ge||"straight"===Je.type)return[];const a=[],s=Qe.filter(e=>"flour"===e.category);if(0===s.length)return[];s.forEach(e=>{const t=Math.round(e.amount*Je.flourRatio*Wt*10)/10;t>0&&a.push({id:`pref-${e.id}`,name:e.name,category:"flour",convertedAmount:t})});const r=s.reduce((e,t)=>e+t.amount,0)*Je.flourRatio,n=Math.round(r*Je.waterRatio*Wt*10)/10;n>0&&a.push({id:"pref-water",name:"Î¨º",category:"liquid",convertedAmount:n});const o=Qe.filter(e=>e.name.includes("Ïù¥Ïä§Ìä∏")).reduce((e,t)=>e+t.amount,0),i=null!=(e=Je.prefermentYeastRatio)?e:0;if(o>0&&i>0){const e=Qe.find(e=>e.name.includes("Ïù¥Ïä§Ìä∏")),s=o*(null!=(t=Je.yeastAdjustment)?t:1)*i;a.push({id:"pref-yeast",name:(null==e?void 0:e.name)||"Ïù∏Ïä§ÌÑ¥Ìä∏ ÎìúÎùºÏù¥Ïù¥Ïä§Ìä∏",category:"other",convertedAmount:Math.round(s*Wt*10)/10})}return a},[Qe,Je,Ge,Wt]),It=u.useMemo(()=>{var e,t;if(!Ge||"straight"===Je.type)return Lt;const a=[],s=Qe.filter(e=>"flour"===e.category).reduce((e,t)=>e+t.amount,0),r=Qe.filter(e=>"liquid"===e.category&&"Î¨º"===e.name).reduce((e,t)=>e+t.amount,0),n=Qe.filter(e=>e.name.includes("Ïù¥Ïä§Ìä∏")).reduce((e,t)=>e+t.amount,0),o=s*Je.flourRatio*Je.waterRatio,d=n*(null!=(e=Je.yeastAdjustment)?e:1),c=d*(null!=(t=Je.prefermentYeastRatio)?t:0);Qe.filter(e=>"flour"===e.category).forEach(e=>{const t=e.amount*Je.flourRatio,s=Math.round(10*(e.amount-t))/10;s>0&&a.push({id:`main-${e.id}`,name:e.name,category:"flour",amount:s,convertedAmount:Math.round(s*Wt*10)/10})});const u=Math.round(10*(r-Math.min(r,o)))/10;u>0&&a.push({id:"main-water",name:"Î¨º",category:"liquid",amount:u,convertedAmount:Math.round(u*Wt*10)/10}),Qe.filter(e=>"liquid"===e.category&&"Î¨º"!==e.name).forEach(e=>{a.push(l(i({},e),{id:`main-${e.id}`,convertedAmount:Math.round(e.amount*Wt*10)/10}))}),Qe.filter(e=>!("flour"===e.category||"liquid"===e.category&&"Î¨º"===e.name||e.name.includes("Ïù¥Ïä§Ìä∏"))).filter(e=>"liquid"!==e.category).forEach(e=>{a.push(l(i({},e),{id:`main-${e.id}`,convertedAmount:Math.round(e.amount*Wt*10)/10}))});const m=Math.round(10*(d-c))/10;if(m>0){const e=Qe.find(e=>e.name.includes("Ïù¥Ïä§Ìä∏"));a.push({id:"main-yeast",name:(null==e?void 0:e.name)||"Ïù∏Ïä§ÌÑ¥Ìä∏ ÎìúÎùºÏù¥Ïù¥Ïä§Ìä∏",category:"other",amount:m,convertedAmount:Math.round(m*Wt*10)/10})}return a},[Qe,Je,Ge,Wt,Lt]),At=u.useMemo(()=>Bt.reduce((e,t)=>e+(t.convertedAmount||0),0),[Bt]),qt=u.useMemo(()=>It.reduce((e,t)=>e+(t.convertedAmount||0),0),[It]),Pt=u.useMemo(()=>{const e=["tangzhong","poolish","biga","sponge","levain","autolyse","preferment"],t=Qe.find(t=>t.phase&&e.includes(t.phase));return(null==t?void 0:t.phase)||"straight"},[Qe]),zt=u.useMemo(()=>{const e=new Set(Qe.map(e=>e.phase||"main"));return e.size>1||1===e.size&&!e.has("main")},[Qe]),Ot=Pt===Je.type||"straight"===Pt&&"straight"===Je.type,Et=u.useMemo(()=>{const e={tangzhong:0,preferment:1,poolish:1,biga:1,sponge:1,levain:1,autolyse:2,main:10,topping:20,filling:21,frosting:22,glaze:23,other:99},t={flour:0,liquid:1,wetOther:2,other:3};if(zt&&!Ge){const a=Lt.reduce((e,t)=>{const a=t.phase||"main";return e[a]||(e[a]=[]),e[a].push(t),e},{});return Object.entries(a).sort(([t],[a])=>{var s,r;return(null!=(s=e[t])?s:50)-(null!=(r=e[a])?r:50)}).map(([e,a])=>({phase:e,items:a.sort((e,a)=>{var s,r;return(null!=(s=t[e.category])?s:99)-(null!=(r=t[a.category])?r:99)})}))}if(!Ge||"straight"===Je.type){const e=[];Lt.filter(e=>"flour"===e.category).forEach(t=>{t.convertedAmount>0&&e.push({id:`straight-${t.id}`,name:t.name,category:"flour",convertedAmount:Math.round(10*t.convertedAmount)/10})});[...new Set(Lt.filter(e=>"liquid"===e.category).map(e=>e.name))].forEach(t=>{const a=Lt.filter(e=>"liquid"===e.category&&e.name===t).reduce((e,t)=>e+t.convertedAmount,0);a>0&&e.push({id:`straight-${t}`,name:t,category:"liquid",convertedAmount:Math.round(10*a)/10})});return[...new Set(Lt.filter(e=>"flour"!==e.category&&"liquid"!==e.category).map(e=>e.name))].forEach(t=>{var a;const s=Lt.filter(e=>e.name===t&&"flour"!==e.category&&"liquid"!==e.category),r=s.reduce((e,t)=>e+t.convertedAmount,0);r>0&&e.push({id:`straight-${t}`,name:t,category:(null==(a=s[0])?void 0:a.category)||"other",convertedAmount:Math.round(10*r)/10})}),e.sort((e,a)=>{var s,r;return(null!=(s=t[e.category])?s:99)-(null!=(r=t[a.category])?r:99)}),[{phase:"main",items:e}]}if(Ot&&"straight"!==Pt){const a=Lt.reduce((e,t)=>{const a=t.phase||"main";return e[a]||(e[a]=[]),e[a].push(t),e},{});return Object.entries(a).sort(([t],[a])=>{var s,r;return(null!=(s=e[t])?s:50)-(null!=(r=e[a])?r:50)}).map(([e,a])=>({phase:e,items:a.sort((e,a)=>{var s,r;return(null!=(s=t[e.category])?s:99)-(null!=(r=t[a.category])?r:99)})}))}const a=[];if(Bt.length>0){const e=[...Bt].sort((e,a)=>{var s,r;return(null!=(s=t[e.category])?s:99)-(null!=(r=t[a.category])?r:99)});a.push({phase:Je.type,items:e.map(e=>l(i({},e),{phase:Je.type}))})}const s=It.filter(e=>(e.convertedAmount||0)>0);if(s.length>0){const e=s.sort((e,a)=>{var s,r;return(null!=(s=t[e.category])?s:99)-(null!=(r=t[a.category])?r:99)});a.push({phase:"main",items:e.map(e=>l(i({},e),{phase:"main"}))})}return a},[Lt,Bt,It,Ge,Je.type,Ot,Pt,zt]),Ft=Et.length>1,Ht=u.useMemo(()=>(e=>{const t=Math.max(e,6);return{rowHeight:t>15?"py-0.5":"py-1",fontSize:t>20||t>15?"text-xs":"text-sm"}})(Qe.length),[Qe.length]);u.useMemo(()=>({id:(null==L?void 0:L.id)||"temp",name:Te,ingredients:Qe.map(e=>({id:e.id,name:e.name,category:"wetOther"===e.category?"fat":e.category,amount:e.amount,unit:"g",bakersPercentage:e.ratio,isFlour:"flour"===e.category})),phases:null==L?void 0:L.phases}),[L,Te,Qe]);const Kt=u.useCallback(e=>{var t,a,s;const r=je[e]||{flour:0,water:0},n=null==(t=null==te?void 0:te.methods)?void 0:t[e],o=Ne[e]||{yeastAdjustment:1,prefermentYeastRatio:0},i=null!=(a=null==n?void 0:n.yeastAdjustment)?a:o.yeastAdjustment,l=null!=(s=null==n?void 0:n.prefermentYeastRatio)?s:o.prefermentYeastRatio;Xe({type:e,flourRatio:r.flour,waterRatio:r.water,yeastAdjustment:i,prefermentYeastRatio:l}),Ze("straight"!==e)},[te]),Yt=u.useCallback((e,t)=>{Oe(a=>{var s,r;const n=l(i({},a),{[e]:t});if("mode"===e)if("count"===t)n.panWeight=(n.unitCount||10)*(n.unitWeight||50);else{const e=null==(s=se[n.category])?void 0:s.find(e=>e.name===n.type);e&&(n.panWeight=Math.round(e.volume/(ae[He]||3.4)))}if("type"===e&&"pan"===n.mode){const e=null==(r=se[n.category])?void 0:r.find(e=>e.name===t);e&&(n.panWeight=Math.round(e.volume/(ae[He]||3.4)))}if("category"===e&&"pan"===n.mode){const e=se[t];(null==e?void 0:e.length)>0&&(n.type=e[0].name,n.panWeight=Math.round(e[0].volume/(ae[He]||3.4)))}return"count"!==n.mode||"unitCount"!==e&&"unitWeight"!==e||(n.panWeight=(n.unitCount||0)*(n.unitWeight||0)),"pan"===n.mode&&n.divisionCount>0&&(n.divisionWeight=Math.round(n.panWeight/n.divisionCount)),n})},[He]),Vt=u.useCallback(()=>{var e,t;const a=(null==(t=null==(e=se[de])?void 0:e[0])?void 0:t.volume)||2350,s=Math.round(a/(ae[Ye]||3.4));Fe(e=>[...e,{id:Date.now().toString(),mode:"pan",category:de,type:ce,quantity:1,divisionCount:1,panWeight:s,divisionWeight:s,unitCount:10,unitWeight:50}])},[Ye,de,ce,se]),Ut=u.useCallback(e=>{Fe(t=>t.length>1?t.filter(t=>t.id!==e):t)},[]),_t=u.useCallback(()=>{Fe([{id:"1",mode:ze.mode,category:ze.category,type:ze.type,quantity:ze.quantity,divisionCount:ze.divisionCount,panWeight:ze.panWeight,divisionWeight:ze.divisionWeight,unitCount:ze.unitCount,unitWeight:ze.unitWeight}]),ht(!0)},[ze]),Jt=u.useCallback(()=>{Ve(He)},[He]),Xt=u.useCallback(()=>{_e({type:"convection",level:"",firstBake:{topTemp:200,bottomTemp:170,time:24},secondBake:{topTemp:0,bottomTemp:0,time:0}})},[]),Gt=u.useCallback(()=>{_t(),Jt(),Xt(),ut(1)},[_t,Jt,Xt]),Zt=u.useCallback(e=>{var t,a,s,r;const o=Qe.map((e,t)=>({id:e.id||`ing-${Date.now()}-${t}`,name:e.name,amount:e.amount,percentage:e.ratio,unit:"g",category:"flour"===e.category?"flour":"liquid"===e.category?"liquid":"wetOther"===e.category?"fat":"other",isFlour:"flour"===e.category,note:e.note||"",moistureContent:e.moistureContent,phase:e.phase||"main"})),d=tt.map((e,t)=>({id:e.id||`step-${Date.now()}-${t}`,order:e.order||t+1,instruction:e.description,time:e.time,temp:e.temp})),c={temperature:Ue.firstBake.topTemp,bottomTemperature:Ue.firstBake.bottomTemp,mode:"deck"===Ue.type?"deck":"airfryer"===Ue.type?"airfryer":"conventional",preheating:!0,deck:Ue.level||"middle",duration:Ue.firstBake.time,secondBake:Ue.secondBake.time>0?{topTemp:Ue.secondBake.topTemp,bottomTemp:Ue.secondBake.bottomTemp,time:Ue.secondBake.time}:null},u={name:Te||n("advDashboard.defaultRecipeName"),nameKo:Te,productType:Le,category:"bread",difficulty:"intermediate",servings:Ee.reduce((e,t)=>e+t.quantity,0),prepTime:30,totalTime:60+Ue.firstBake.time+Ue.secondBake.time,ingredients:o,steps:d,ovenSettings:c,method:{method:Je.type,prefermentRatio:Je.flourRatio,waterRatio:Je.waterRatio},panConfig:{type:(null==(t=Ee[0])?void 0:t.type)||ce,name:(null==(a=Ee[0])?void 0:a.category)||de,quantity:Ee.reduce((e,t)=>e+t.quantity,0),panWeight:null==(s=Ee[0])?void 0:s.panWeight,mode:(null==(r=Ee[0])?void 0:r.mode)||"pan",originalPan:ze,pans:Ee},specificVolume:{original:He,converted:Ye},multiplierConfig:{multiplier:ct,isPanLinked:mt},source:Ie.name?{name:Ie.name,type:Ie.type,url:Ie.url||void 0,author:Ie.author||void 0}:void 0,tags:[Ye,oe[Je.type]].filter(Boolean),notes:st,yieldStageSelection:it,updatedAt:new Date},m=e||(null==L?void 0:L.id);if(m)R(m,u),Z({type:"success",message:n("advDashboard.recipeUpdated",{name:Te})});else{const e=l(i({},u),{id:`recipe-${Date.now()}`,createdAt:new Date});S(e),Z({type:"success",message:n("advDashboard.recipeSaved",{name:Te})})}},[Te,Ie,Ee,Ue,Ge,It,Lt,tt,st,Ye,Je,it,L,S,R,Z]),Qt=u.useCallback(()=>{const e=(Te||n("advDashboard.defaultRecipeName")).trim(),t=z.find(t=>{var a;return(null==(a=t.name)?void 0:a.trim())===e&&t.id!==(null==L?void 0:L.id)});if(t){window.confirm(n("advDashboard.duplicateRecipeConfirm",{name:e}))&&Zt(t.id)}else Zt()},[Te,z,null==L?void 0:L.id,Zt]),ea=u.useCallback(()=>{const e={name:Te,source:Ie.name?Ie:void 0,exportedAt:(new Date).toISOString(),version:"1.0",settings:{multiplier:Wt,originalTotal:kt,convertedTotal:Tt,panSettings:{original:ze,converted:Ee},oven:Ue,method:Je,specificVolume:{original:He,converted:Ye}},originalIngredients:Qe.map(e=>({name:e.name,category:e.category,amount:e.amount,ratio:e.ratio})),convertedIngredients:(Ge?It:Lt).map(e=>({name:e.name,category:e.category,amount:e.convertedAmount})),prefermentIngredients:Ge?Bt.map(e=>({name:e.name,amount:e.convertedAmount})):[],processes:tt.map(e=>({description:e.description,time:e.time,temp:e.temp})),memo:st},t=new Blob([JSON.stringify(e,null,2)],{type:"application/json"}),a=URL.createObjectURL(t),s=document.createElement("a");s.href=a,s.download=`${Te||"recipe"}_${(new Date).toISOString().slice(0,10)}.json`,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(a),Z({type:"success",message:n("advDashboard.recipeExported")})},[Te,Ie,Wt,kt,Tt,ze,Ee,Ue,Je,He,Ye,Qe,Ge,It,Lt,Bt,tt,st,Z]),ta=u.useCallback(()=>d(void 0,null,function*(){const e={flour:n("ingredientCategory.flour"),liquid:n("ingredientCategory.liquid"),yeast:n("ingredientCategory.yeast"),fat:n("ingredientCategory.fat"),sugar:n("ingredientCategory.sugar"),dairy:n("ingredientCategory.dairy"),egg:n("ingredientCategory.egg"),salt:n("ingredientCategory.salt"),other:n("ingredientCategory.other")},t=Ge?It:Lt;let a=`üçû ${Te}\n`;a+=`${"‚îÄ".repeat(30)}\n\n`,a+=`üìä ${n("advDashboard.basicInfo")}\n`,a+=`‚Ä¢ ${n("advDashboard.multiplier")}: √ó${Wt}\n`,a+=`‚Ä¢ ${n("advDashboard.original")}: ${kt}g ‚Üí ${n("advDashboard.converted")}: ${Tt}g\n`,a+=`‚Ä¢ ${n("advDashboard.pan")}: ${Ee.map(e=>`${e.type} ${e.quantity}`).join(", ")}\n`,a+=`‚Ä¢ ${n("advDashboard.method")}: ${oe[Je.type]}\n\n`,Ge&&Bt.length>0&&(a+=`ü•£ ${n("advDashboard.prefermentIngredients")} (${oe[Je.type]})\n`,Bt.forEach(e=>{a+=`‚Ä¢ ${o(e.name)}: ${e.convertedAmount}g\n`}),a+="\n"),a+=Ge?`üçû ${n("advDashboard.mainDoughIngredients")}\n`:`üçû ${n("advDashboard.ingredients")}\n`;[...new Set(t.map(e=>e.category))].forEach(s=>{const r=t.filter(e=>e.category===s);r.length>0&&(a+=`[${e[s]||s}]\n`,r.forEach(e=>{a+=`‚Ä¢ ${o(e.name)}: ${e.convertedAmount}g\n`}))}),a+="\n",a+=`üî• ${n("advDashboard.ovenSettings")}\n`;const s=n(`advDashboard.ovenTypes.${Ue.type}`);"deck"===Ue.type?a+=`‚Ä¢ ${s}: ${n("advDashboard.topHeat")} ${Ue.firstBake.topTemp}¬∞C / ${n("advDashboard.bottomHeat")} ${Ue.firstBake.bottomTemp}¬∞C, ${Ue.firstBake.time}${n("units.minute")}\n`:a+=`‚Ä¢ ${s}: ${Ue.firstBake.topTemp}¬∞C, ${Ue.firstBake.time}${n("units.minute")}\n`,Ue.secondBake.time>0&&(a+=`‚Ä¢ ${n("advDashboard.secondBake")}: ${Ue.secondBake.topTemp}¬∞C, ${Ue.secondBake.time}${n("units.minute")}\n`),a+="\n",a+=`üìù ${n("advDashboard.processSteps")}\n`,tt.forEach((e,t)=>{let s=`${t+1}. ${c(e.description)}`;e.time&&(s+=` (${e.time}${n("units.minute")})`),e.temp&&(s+=` [${e.temp}¬∞C]`),a+=`${s}\n`}),st&&(a+=`\nüìå ${n("advDashboard.memo")}\n${st}\n`),a+=`\n${"‚îÄ".repeat(30)}\n`,a+=`${n("advDashboard.createdDate")}: ${(new Date).toLocaleDateString()}\n`;try{yield navigator.clipboard.writeText(a),Z({type:"success",message:n("advDashboard.recipeCopied")})}catch(r){const e=new Blob([a],{type:"text/plain;charset=utf-8"}),t=URL.createObjectURL(e),s=document.createElement("a");s.href=t,s.download=`${Te||"recipe"}_${(new Date).toISOString().slice(0,10)}.txt`,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(t),Z({type:"success",message:n("advDashboard.recipeSavedAsText")})}}),[Te,Wt,kt,Tt,Ee,Je,Ge,Bt,It,Lt,Ue,tt,st,Z,o,c,n]),aa=u.useCallback((e,t,a)=>{Fe(s=>s.map(s=>{var r,n;if(s.id!==e)return s;const o=l(i({},s),{[t]:a});if("mode"===t)if("count"===a)o.panWeight=(o.unitCount||10)*(o.unitWeight||50),o.divisionCount=1,o.divisionWeight=o.panWeight;else{const e=null==(r=se[o.category])?void 0:r.find(e=>e.name===o.type);e&&(o.panWeight=Math.round(e.volume/(ae[Ye]||3.4)))}if("type"===t&&"pan"===o.mode){const e=null==(n=se[o.category])?void 0:n.find(e=>e.name===a);e&&(o.panWeight=Math.round(e.volume/(ae[Ye]||3.4)))}if("category"===t&&"pan"===o.mode){const e=se[a];(null==e?void 0:e.length)>0&&(o.type=e[0].name,o.panWeight=Math.round(e[0].volume/(ae[Ye]||3.4)))}return"count"!==o.mode||"unitCount"!==t&&"unitWeight"!==t||(o.panWeight=(o.unitCount||0)*(o.unitWeight||0),o.divisionWeight=o.panWeight),"pan"===o.mode&&o.divisionCount>0&&(o.divisionWeight=Math.round(o.panWeight/o.divisionCount)),o}))},[Ye]),[sa,ra]=u.useState(!1),[na,oa]=u.useState("table"),ia=u.useCallback(()=>{const e=Math.max(...Qe.map(e=>e.order),0)+1;et(t=>[...t,{id:`${Date.now()}-${Math.random().toString(36).substr(2,9)}`,order:e,category:"other",subCategory:"Í∏∞ÌÉÄ",name:"",ratio:0,amount:0,note:""}])},[Qe]),la=u.useCallback(e=>{const t=Math.max(...Qe.map(e=>e.order),0)+1,a=e.map((e,a)=>({id:`bulk-${Date.now()}-${a}`,order:t+a,category:e.category,subCategory:"",name:e.name,ratio:0,amount:e.amount,note:""}));et(e=>[...e,...a]),Z({type:"success",message:n("advDashboard.ingredientsAdded",{count:a.length})})},[Qe,Z]),da=u.useCallback(e=>{et(t=>t.filter(t=>t.id!==e))},[]),ca=u.useCallback((e,t,a)=>{et(s=>s.map(r=>{if(r.id!==e)return r;const n=l(i({},r),{[t]:a});if("category"===t&&(n.subCategory=re[a]||"Í∏∞ÌÉÄ"),"amount"===t){const t=s.filter(e=>"flour"===e.category).reduce((t,s)=>t+(s.id===e?a:s.amount),0);t>0&&"flour"!==r.category&&(n.ratio=Math.round(a/t*1e3)/10)}return n}))},[]),ua=u.useCallback(()=>{const e=Math.max(...tt.map(e=>e.order),0)+1;at(t=>[...t,{id:Date.now().toString(),order:e,description:""}])},[tt]),ma=u.useCallback(e=>{at(t=>t.filter(t=>t.id!==e))},[]),ha=u.useCallback((e,t,a)=>{at(s=>s.map(s=>s.id===e?l(i({},s),{[t]:a}):s))},[]),pa=u.useCallback((e,t)=>{at(a=>{const s=a.findIndex(t=>t.id===e);if(-1===s)return a;if("up"===t&&0===s)return a;if("down"===t&&s===a.length-1)return a;const r=[...a],n="up"===t?s-1:s+1;return[r[s],r[n]]=[r[n],r[s]],r.map((e,t)=>l(i({},e),{order:t+1}))})},[]);return m.jsxs("div",{className:"h-screen flex flex-col bg-gray-100 text-sm",children:[m.jsxs("div",{className:"bg-white border-b shadow-sm px-4 py-2 flex items-center justify-between gap-4 flex-shrink-0",children:[m.jsxs("div",{className:"flex items-center gap-3",children:[m.jsx(O,{className:"w-5 h-5 text-amber-600"}),m.jsx("input",{type:"text",value:Te,onChange:e=>Re(e.target.value),className:"text-lg font-bold w-36 border-b border-transparent hover:border-gray-300 focus:border-amber-500 focus:outline-none",placeholder:n("advDashboard.productName")}),m.jsxs("div",{className:"flex items-center gap-1 border-l pl-3",children:[m.jsx("button",{onClick:()=>Be("bread"),className:"px-3 py-1 text-xs rounded-l "+("bread"===Le?"bg-amber-500 text-white font-medium":"bg-gray-100 text-gray-600 hover:bg-gray-200"),title:n("advDashboard.productTypeBread"),children:n("advDashboard.productTypeBread")}),m.jsx("button",{onClick:()=>Be("pastry"),className:"px-3 py-1 text-xs rounded-r "+("pastry"===Le?"bg-amber-500 text-white font-medium":"bg-gray-100 text-gray-600 hover:bg-gray-200"),title:n("advDashboard.productTypePastry"),children:n("advDashboard.productTypePastry")})]}),m.jsxs("div",{className:"flex items-center gap-1 text-xs border-l pl-3",children:[m.jsxs("select",{value:Ie.type,onChange:e=>Ae(l(i({},Ie),{type:e.target.value})),className:"bg-gray-50 border border-gray-200 rounded px-1.5 py-1 text-xs focus:outline-none focus:border-amber-400",title:n("advDashboard.sourceType"),children:[m.jsxs("option",{value:"youtube",children:["üì∫ ",n("advDashboard.sourceTypes.youtube")]}),m.jsxs("option",{value:"blog",children:["üåê ",n("advDashboard.sourceTypes.blog")]}),m.jsxs("option",{value:"book",children:["üìñ ",n("advDashboard.sourceTypes.book")]}),m.jsxs("option",{value:"website",children:["üîó ",n("advDashboard.sourceTypes.website")]}),m.jsxs("option",{value:"personal",children:["üë§ ",n("advDashboard.sourceTypes.personal")]}),m.jsxs("option",{value:"school",children:["üéì ",n("advDashboard.sourceTypes.school")]}),m.jsxs("option",{value:"other",children:["üìå ",n("advDashboard.sourceTypes.other")]})]}),m.jsx("input",{type:"text",value:Ie.name,onChange:e=>Ae(l(i({},Ie),{name:e.target.value})),className:"w-24 bg-gray-50 border border-gray-200 rounded px-2 py-1 text-xs focus:outline-none focus:border-amber-400",placeholder:n("advDashboard.sourceName"),title:n("advDashboard.sourceNamePlaceholder")})]})]}),m.jsxs("div",{className:"flex items-center gap-3",children:[m.jsxs("button",{onClick:()=>ht(!mt),className:"p-1.5 rounded flex items-center gap-1 "+(mt?"bg-green-100 text-green-600":"bg-gray-100 text-gray-400"),title:n(mt?"advDashboard.multiplierLinked":"advDashboard.multiplierUnlinked"),children:[mt?m.jsx(K,{className:"w-4 h-4"}):m.jsx(_,{className:"w-4 h-4"}),m.jsx("span",{className:"text-xs",children:n(mt?"advDashboard.auto":"advDashboard.manual")})]}),m.jsxs("span",{className:"text-xs text-gray-500",children:[n("advDashboard.multiplier"),":"]}),mt?m.jsx("div",{className:"flex items-center border border-green-300 rounded overflow-hidden bg-green-50",children:m.jsxs("div",{className:"px-4 py-1 font-bold text-sm text-green-700 w-20 text-center",children:["√ó",Wt]})}):m.jsxs("div",{className:"flex items-center border rounded overflow-hidden bg-white",children:[m.jsx("button",{onClick:()=>vt(Math.max(.1,ct-.5)),className:"px-2 py-1 hover:bg-gray-100 border-r",children:m.jsx(V,{className:"w-4 h-4"})}),m.jsx("input",{type:"text",value:pt,onChange:e=>bt(e.target.value),onBlur:yt,onKeyDown:e=>"Enter"===e.key&&yt(),className:"w-20 text-center py-1 font-bold text-sm",placeholder:n("advDashboard.multiplierPlaceholder"),title:n("advDashboard.multiplierHint")}),m.jsx("button",{onClick:()=>vt(Math.min(20,ct+.5)),className:"px-2 py-1 hover:bg-gray-100 border-l",children:m.jsx(w,{className:"w-4 h-4"})})]}),!mt&&m.jsx("div",{className:"flex gap-1 flex-wrap",children:[.25,.5,1,1.5,2,2.5,3,4,5].map(e=>m.jsx("button",{onClick:()=>vt(e),className:"px-1.5 py-0.5 text-xs rounded transition-colors "+(ct===e?"bg-amber-500 text-white":"bg-gray-100 hover:bg-gray-200 text-gray-700"),children:e<1?`1/${Math.round(1/e)}`:`√ó${e}`},e))})]}),m.jsxs("div",{className:"flex items-center gap-4",children:[m.jsxs("div",{className:"flex items-center gap-3 text-xs text-gray-500 bg-gray-50 px-3 py-1.5 rounded",children:[m.jsxs("span",{children:[n("advDashboard.original"),":",m.jsxs("b",{className:"text-gray-700 ml-1",children:[kt,"g"]})]}),m.jsx("span",{className:"text-gray-300",children:"‚Üí"}),m.jsxs("span",{children:[n("advDashboard.converted"),":",m.jsxs("b",{className:"text-blue-600 ml-1",children:[Tt,"g"]})]}),m.jsx("span",{className:"text-gray-300",children:"|"}),m.jsxs("span",{children:[n("advDashboard.hydration"),":",m.jsxs("b",{className:"ml-1",children:[Dt,"%"]})]}),m.jsx("span",{className:"text-gray-300",children:"|"}),m.jsxs("span",{children:[n("advDashboard.pan"),":",m.jsxs("b",{className:"ml-1",children:[$t,"g"]})]}),m.jsx("span",{className:"text-gray-300",children:"|"}),m.jsxs("span",{children:[n("advDashboard.lossRate"),":",m.jsxs("b",{className:"ml-1 "+(Rt>100?"text-red-500":Rt<95?"text-orange-500":"text-green-600"),children:[Rt,"%"]})]})]}),m.jsxs("div",{className:"flex gap-1.5",children:[m.jsxs("button",{onClick:Gt,className:"flex items-center gap-1 px-3 py-1.5 text-xs bg-gray-100 text-gray-600 rounded hover:bg-gray-200 border border-gray-300",title:n("advDashboard.resetConversion"),children:[m.jsx(B,{className:"w-4 h-4"}),n("advDashboard.reset")]}),m.jsxs("button",{onClick:Qt,className:"flex items-center gap-1 px-3 py-1.5 text-xs bg-amber-500 text-white rounded hover:bg-amber-600",title:n("advDashboard.saveRecipe"),children:[m.jsx(C,{className:"w-4 h-4"}),n("advDashboard.save")]}),m.jsxs("button",{onClick:ta,className:"flex items-center gap-1 px-3 py-1.5 text-xs bg-blue-500 text-white rounded hover:bg-blue-600",title:n("advDashboard.copyAsText"),children:[m.jsx(I,{className:"w-4 h-4"}),n("advDashboard.copy")]}),m.jsxs("button",{onClick:ea,className:"flex items-center gap-1 px-3 py-1.5 text-xs bg-gray-200 rounded hover:bg-gray-300",title:n("advDashboard.exportJson"),children:[m.jsx(E,{className:"w-4 h-4"}),n("advDashboard.json")]})]})]})]}),m.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[m.jsxs("div",{className:"bg-white border-r flex-shrink-0 overflow-y-auto",style:{width:xe.sidebarWidth},children:[m.jsx(Ce,{title:n("advDashboard.panSettings"),icon:m.jsx(H,{className:"w-4 h-4"}),badge:`${ze.quantity}${n("advDashboard.pan")}‚Üí${Ee.reduce((e,t)=>e+t.quantity,0)}${n("advDashboard.pan")}`,badgeColor:"bg-blue-100 text-blue-700",onReset:_t,children:m.jsxs("div",{className:"space-y-3",children:[m.jsxs("div",{className:"bg-gray-100 rounded p-2",children:[m.jsxs("div",{className:"flex items-center justify-between mb-1.5",children:[m.jsxs("span",{className:"text-xs font-medium text-gray-600",children:["üìã ",n("advDashboard.originalPan")]}),m.jsxs("div",{className:"flex text-xs",children:[m.jsxs("button",{onClick:()=>Yt("mode","pan"),className:"px-2 py-0.5 rounded-l border "+("pan"===ze.mode?"bg-gray-500 text-white border-gray-500":"bg-white text-gray-600 border-gray-300"),children:["üçû ",n("advDashboard.panMode")]}),m.jsxs("button",{onClick:()=>Yt("mode","count"),className:"px-2 py-0.5 rounded-r border-l-0 border "+("count"===ze.mode?"bg-green-500 text-white border-green-500":"bg-white text-gray-600 border-gray-300"),children:["üî¢ ",n("advDashboard.countMode")]})]})]}),"pan"===ze.mode&&m.jsxs(m.Fragment,{children:[m.jsxs("div",{className:"grid grid-cols-2 gap-1.5 mb-1.5",children:[m.jsx("select",{value:ze.category,onChange:e=>Yt("category",e.target.value),className:"text-xs border rounded px-2 py-1 bg-white",children:Object.keys(se).map(e=>m.jsx("option",{value:e,children:b(e)},e))}),m.jsx("select",{value:ze.type,onChange:e=>Yt("type",e.target.value),className:"text-xs border rounded px-2 py-1 bg-white",children:null==(r=se[ze.category])?void 0:r.map(e=>m.jsx("option",{value:e.name,children:y(e)},e.name))})]}),m.jsxs("div",{className:"grid grid-cols-4 gap-1.5 text-xs",children:[m.jsxs("div",{children:[m.jsx("label",{className:"text-xs text-gray-500 block",children:n("advDashboard.quantity")}),m.jsx("input",{type:"number",value:ze.quantity,onChange:e=>Yt("quantity",parseInt(e.target.value)||1),className:"w-full border rounded px-1.5 py-1 text-center bg-white"})]}),m.jsxs("div",{children:[m.jsx("label",{className:"text-xs text-gray-500 block",children:n("advDashboard.division")}),m.jsx("input",{type:"number",value:ze.divisionCount,onChange:e=>Yt("divisionCount",parseInt(e.target.value)||1),className:"w-full border rounded px-1.5 py-1 text-center bg-white"})]}),m.jsxs("div",{children:[m.jsx("label",{className:"text-xs text-gray-500 block",children:n("advDashboard.panWeight")}),m.jsx("input",{type:"number",value:ze.panWeight,onChange:e=>Yt("panWeight",parseInt(e.target.value)||0),className:"w-full border rounded px-1.5 py-1 text-center bg-white"})]}),m.jsxs("div",{children:[m.jsx("label",{className:"text-xs text-gray-500 block",children:n("advDashboard.divisionWeight")}),m.jsx("div",{className:"text-center py-1 font-mono bg-white rounded border",children:ze.divisionWeight})]})]})]}),"count"===ze.mode&&m.jsxs("div",{className:"grid grid-cols-3 gap-1.5 text-xs",children:[m.jsxs("div",{children:[m.jsx("label",{className:"text-xs text-gray-500 block",children:n("advDashboard.count")}),m.jsx("input",{type:"number",value:ze.unitCount||10,onChange:e=>Yt("unitCount",parseInt(e.target.value)||0),className:"w-full border rounded px-1.5 py-1 text-center bg-white"})]}),m.jsxs("div",{children:[m.jsx("label",{className:"text-xs text-gray-500 block",children:n("advDashboard.weightPerPiece")}),m.jsx("input",{type:"number",value:ze.unitWeight||50,onChange:e=>Yt("unitWeight",parseInt(e.target.value)||0),className:"w-full border rounded px-1.5 py-1 text-center bg-white"})]}),m.jsxs("div",{children:[m.jsx("label",{className:"text-xs text-gray-500 block",children:n("advDashboard.total")}),m.jsxs("div",{className:"text-center py-1 font-mono bg-white rounded border font-semibold",children:[(ze.unitCount||10)*(ze.unitWeight||50),"g"]})]})]}),m.jsxs("div",{className:"text-xs text-gray-500 mt-1 text-right",children:[n("advDashboard.total"),": ",m.jsxs("b",{children:["count"===ze.mode?(ze.unitCount||10)*(ze.unitWeight||50):ze.panWeight*ze.quantity,"g"]})]})]}),m.jsx("div",{className:"flex justify-center text-gray-400",children:m.jsx(q,{className:"w-5 h-5"})}),m.jsxs("div",{className:"space-y-2",children:[m.jsxs("div",{className:"text-xs font-medium text-blue-600",children:["üéØ ",n("advDashboard.convertedPan")]}),Ee.map((e,t)=>{var a;return m.jsxs("div",{className:"bg-blue-50 rounded p-2 border border-blue-200",children:[m.jsxs("div",{className:"flex items-center justify-between mb-1.5",children:[m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsxs("span",{className:"text-xs font-medium text-blue-700",children:[n("advDashboard.pan")," ",t+1]}),m.jsxs("div",{className:"flex text-xs",children:[m.jsxs("button",{onClick:()=>aa(e.id,"mode","pan"),className:"px-2 py-0.5 rounded-l border "+("pan"===e.mode?"bg-blue-500 text-white border-blue-500":"bg-white text-gray-600 border-gray-300"),children:["üçû ",n("advDashboard.panMode")]}),m.jsxs("button",{onClick:()=>aa(e.id,"mode","count"),className:"px-2 py-0.5 rounded-r border-l-0 border "+("count"===e.mode?"bg-green-500 text-white border-green-500":"bg-white text-gray-600 border-gray-300"),children:["üî¢ ",n("advDashboard.countMode")]})]})]}),Ee.length>1&&m.jsx("button",{onClick:()=>Ut(e.id),className:"text-red-400 hover:text-red-600",children:m.jsx(g,{className:"w-4 h-4"})})]}),"pan"===e.mode&&m.jsxs(m.Fragment,{children:[m.jsxs("div",{className:"grid grid-cols-2 gap-1.5 mb-1.5",children:[m.jsx("select",{value:e.category,onChange:t=>aa(e.id,"category",t.target.value),className:"text-xs border rounded px-2 py-1 bg-white",children:Object.keys(se).map(e=>m.jsx("option",{value:e,children:b(e)},e))}),m.jsx("select",{value:e.type,onChange:t=>aa(e.id,"type",t.target.value),className:"text-xs border rounded px-2 py-1 bg-white",children:null==(a=se[e.category])?void 0:a.map(e=>m.jsx("option",{value:e.name,children:y(e)},e.name))})]}),m.jsxs("div",{className:"grid grid-cols-4 gap-1.5 text-xs",children:[m.jsxs("div",{children:[m.jsx("label",{className:"text-xs text-gray-500 block",children:n("advDashboard.quantity")}),m.jsx("input",{type:"number",value:e.quantity,onChange:t=>aa(e.id,"quantity",parseFloat(t.target.value)||0),className:"w-full border rounded px-1.5 py-1 text-center bg-white",step:"0.5"})]}),m.jsxs("div",{children:[m.jsx("label",{className:"text-xs text-gray-500 block",children:n("advDashboard.division")}),m.jsx("input",{type:"number",value:e.divisionCount,onChange:t=>aa(e.id,"divisionCount",parseInt(t.target.value)||1),className:"w-full border rounded px-1.5 py-1 text-center bg-white"})]}),m.jsxs("div",{children:[m.jsx("label",{className:"text-xs text-gray-500 block",children:n("advDashboard.panWeight")}),m.jsx("input",{type:"number",value:e.panWeight,onChange:t=>aa(e.id,"panWeight",parseInt(t.target.value)||0),className:"w-full border rounded px-1.5 py-1 text-center bg-white"})]}),m.jsxs("div",{children:[m.jsx("label",{className:"text-xs text-gray-500 block",children:n("advDashboard.divisionWeight")}),m.jsx("div",{className:"text-center py-1 font-mono bg-white rounded border",children:e.divisionWeight})]})]})]}),"count"===e.mode&&m.jsxs("div",{className:"grid grid-cols-3 gap-1.5 text-xs",children:[m.jsxs("div",{children:[m.jsx("label",{className:"text-xs text-gray-500 block",children:n("advDashboard.count")}),m.jsx("input",{type:"number",value:e.unitCount||10,onChange:t=>aa(e.id,"unitCount",parseInt(t.target.value)||0),className:"w-full border rounded px-1.5 py-1 text-center bg-white"})]}),m.jsxs("div",{children:[m.jsx("label",{className:"text-xs text-gray-500 block",children:n("advDashboard.weightPerPiece")}),m.jsx("input",{type:"number",value:e.unitWeight||50,onChange:t=>aa(e.id,"unitWeight",parseInt(t.target.value)||0),className:"w-full border rounded px-1.5 py-1 text-center bg-white"})]}),m.jsxs("div",{children:[m.jsx("label",{className:"text-xs text-gray-500 block",children:n("advDashboard.total")}),m.jsxs("div",{className:"text-center py-1 font-mono bg-white rounded border font-semibold",children:[(e.unitCount||10)*(e.unitWeight||50),"g"]})]})]})]},e.id)}),m.jsx("button",{onClick:Vt,className:"w-full text-xs text-blue-600 hover:text-blue-700 py-1.5 border border-dashed border-blue-300 rounded",children:n("advDashboard.addPan")}),m.jsxs("div",{className:"text-xs text-blue-700 text-right",children:[n("advDashboard.total"),": ",m.jsxs("b",{children:[$t,"g"]})]})]})]})}),m.jsx(Ce,{title:n("advDashboard.specificVolume"),icon:m.jsx(v,{className:"w-4 h-4"}),defaultOpen:!1,onReset:Jt,children:m.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[m.jsxs("div",{children:[m.jsx("label",{className:"text-xs text-gray-500 block mb-1",children:n("advDashboard.originalProduct")}),m.jsx("select",{value:He,onChange:e=>Ke(e.target.value),className:"w-full text-xs border rounded px-2 py-1",children:Object.keys(ae).map(e=>m.jsx("option",{value:e,children:f(e)},e))}),m.jsx("div",{className:"text-xs text-gray-400 mt-1",children:fe(He)?`ÎπÑÏ§ë: ${ye[He]}`:`ÎπÑÏö©Ï†Å: ${ae[He]} cm¬≥/g`})]}),m.jsxs("div",{children:[m.jsx("label",{className:"text-xs text-gray-500 block mb-1",children:n("advDashboard.convertedProduct")}),m.jsx("select",{value:Ye,onChange:e=>Ve(e.target.value),className:"w-full text-xs border rounded px-2 py-1",children:Object.keys(ae).map(e=>m.jsx("option",{value:e,children:f(e)},e))}),m.jsx("div",{className:"text-xs text-gray-400 mt-1",children:fe(Ye)?`ÎπÑÏ§ë: ${ye[Ye]}`:`ÎπÑÏö©Ï†Å: ${ae[Ye]} cm¬≥/g`})]})]})}),"bread"===Le&&m.jsx(Ce,{title:n("advDashboard.yieldPrediction"),icon:m.jsx(W,{className:"w-4 h-4"}),defaultOpen:!1,badge:`${Math.round(.81*kt)}g ${n("advDashboard.expectedYield")}`,children:m.jsx(ge,{inputWeight:kt,category:"Ïâ¨Ìè∞ÏºÄÏù¥ÌÅ¨"===He||"Ï†úÎàÑÏôÄÏ¶à"===He||"ÌååÏö¥ÎìúÏºÄÏù¥ÌÅ¨"===He?"cake":"ÌÅ¨Î£®ÏïÑÏÉÅ"===He||"Îç∞ÎãàÏâ¨"===He?"pastry":"Ïø†ÌÇ§"===He?"cookie":"bread",productType:"ÌíÄÎ®ºÏãùÎπµ"===He?"pullman":"ÏÇ∞ÌòïÏãùÎπµ"===He?"mountain":"Î∏åÎ¶¨Ïò§Ïäà"===He?"brioche":"Ï†úÎàÑÏôÄÏ¶à"===He?"genoise":"Ïâ¨Ìè∞ÏºÄÏù¥ÌÅ¨"===He?"chiffon":"ÌååÏö¥ÎìúÏºÄÏù¥ÌÅ¨"===He?"pound":"ÌÅ¨Î£®ÏïÑÏÉÅ"===He?"croissant":void 0,stageSelection:it,onStageSelectionChange:lt,compact:!1,className:"border-0 shadow-none"})}),m.jsx(Ce,{title:n("advDashboard.oven"),icon:m.jsx(P,{className:"w-4 h-4"}),badge:`${n(`advDashboard.ovenTypes.${Ue.type}`)}${"convection"===Ue.type&&Ue.level?` ${Ue.level}${n("advDashboard.level")}`:""} ${"deck"===Ue.type?`${Ue.firstBake.topTemp}/${Ue.firstBake.bottomTemp}¬∞C`:`${Ue.firstBake.topTemp}¬∞C`} ${Ue.firstBake.time}${n("units.minute")}${Ue.secondBake.time>0?"deck"===Ue.type?` ‚Üí ${Ue.secondBake.topTemp}/${Ue.secondBake.bottomTemp}¬∞C ${Ue.secondBake.time}${n("units.minute")}`:` ‚Üí ${Ue.secondBake.topTemp}¬∞C ${Ue.secondBake.time}${n("units.minute")}`:""}`,badgeColor:"bg-orange-100 text-orange-700",onReset:Xt,children:m.jsxs("div",{className:"space-y-2",children:[m.jsx("div",{className:"flex gap-1.5",children:["convection","deck","airfryer"].map(e=>m.jsx("button",{onClick:()=>_e(l(i({},Ue),{type:e})),className:"flex-1 px-2 py-1 text-xs rounded "+(Ue.type===e?"bg-amber-500 text-white":"bg-gray-100"),children:n(`advDashboard.ovenTypes.${e}`)},e))}),"convection"===Ue.type&&m.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[m.jsxs("span",{className:"text-gray-500",children:[n("advDashboard.levelSelect"),":"]}),m.jsx("div",{className:"flex gap-1",children:[1,2,3,4,5].map(e=>{const t=Ue.level?Ue.level.split(",").map(e=>e.trim()):[],a=t.includes(String(e));return m.jsx("button",{onClick:()=>{let s;s=a?t.filter(t=>t!==String(e)):[...t,String(e)].sort((e,t)=>Number(e)-Number(t)),_e(l(i({},Ue),{level:s.join(", ")}))},className:"w-6 h-6 rounded text-xs font-medium "+(a?"bg-amber-500 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"),children:e},e)})}),Ue.level&&m.jsxs("span",{className:"text-amber-600 font-medium",children:[Ue.level,n("advDashboard.level")]})]}),m.jsxs("div",{className:"bg-orange-50 rounded p-2",children:[m.jsx("div",{className:"text-xs font-medium text-orange-700 mb-1.5",children:n("advDashboard.firstBake")}),"deck"===Ue.type?m.jsxs("div",{className:"grid grid-cols-3 gap-1.5",children:[m.jsxs("div",{children:[m.jsx("label",{className:"text-xs text-gray-500",children:n("advDashboard.topHeat")}),m.jsx("input",{type:"number",value:Ue.firstBake.topTemp,onChange:e=>_e(l(i({},Ue),{firstBake:l(i({},Ue.firstBake),{topTemp:parseInt(e.target.value)||0})})),className:"w-full text-xs border rounded px-1.5 py-1 text-center"})]}),m.jsxs("div",{children:[m.jsx("label",{className:"text-xs text-gray-500",children:n("advDashboard.bottomHeat")}),m.jsx("input",{type:"number",value:Ue.firstBake.bottomTemp,onChange:e=>_e(l(i({},Ue),{firstBake:l(i({},Ue.firstBake),{bottomTemp:parseInt(e.target.value)||0})})),className:"w-full text-xs border rounded px-1.5 py-1 text-center"})]}),m.jsxs("div",{children:[m.jsx("label",{className:"text-xs text-gray-500",children:n("advDashboard.timeMin")}),m.jsx("input",{type:"number",value:Ue.firstBake.time,onChange:e=>_e(l(i({},Ue),{firstBake:l(i({},Ue.firstBake),{time:parseInt(e.target.value)||0})})),className:"w-full text-xs border rounded px-1.5 py-1 text-center"})]})]}):m.jsxs("div",{className:"grid grid-cols-2 gap-1.5",children:[m.jsxs("div",{children:[m.jsx("label",{className:"text-xs text-gray-500",children:n("advDashboard.temperature")}),m.jsx("input",{type:"number",value:Ue.firstBake.topTemp,onChange:e=>{const t=parseInt(e.target.value)||0;_e(l(i({},Ue),{firstBake:l(i({},Ue.firstBake),{topTemp:t,bottomTemp:t})}))},className:"w-full text-xs border rounded px-1.5 py-1 text-center"})]}),m.jsxs("div",{children:[m.jsx("label",{className:"text-xs text-gray-500",children:n("advDashboard.timeMin")}),m.jsx("input",{type:"number",value:Ue.firstBake.time,onChange:e=>_e(l(i({},Ue),{firstBake:l(i({},Ue.firstBake),{time:parseInt(e.target.value)||0})})),className:"w-full text-xs border rounded px-1.5 py-1 text-center"})]})]})]}),m.jsxs("div",{className:"bg-gray-50 rounded p-2",children:[m.jsx("div",{className:"text-xs text-gray-500 mb-1.5",children:n("advDashboard.secondBake")}),"deck"===Ue.type?m.jsxs("div",{className:"grid grid-cols-3 gap-1.5",children:[m.jsx("input",{type:"number",value:Ue.secondBake.topTemp||"",onChange:e=>_e(l(i({},Ue),{secondBake:l(i({},Ue.secondBake),{topTemp:parseInt(e.target.value)||0})})),className:"text-xs border rounded px-1.5 py-1 text-center",placeholder:n("advDashboard.topHeat")}),m.jsx("input",{type:"number",value:Ue.secondBake.bottomTemp||"",onChange:e=>_e(l(i({},Ue),{secondBake:l(i({},Ue.secondBake),{bottomTemp:parseInt(e.target.value)||0})})),className:"text-xs border rounded px-1.5 py-1 text-center",placeholder:n("advDashboard.bottomHeat")}),m.jsx("input",{type:"number",value:Ue.secondBake.time||"",onChange:e=>_e(l(i({},Ue),{secondBake:l(i({},Ue.secondBake),{time:parseInt(e.target.value)||0})})),className:"text-xs border rounded px-1.5 py-1 text-center",placeholder:n("units.time")})]}):m.jsxs("div",{className:"grid grid-cols-2 gap-1.5",children:[m.jsx("input",{type:"number",value:Ue.secondBake.topTemp||"",onChange:e=>{const t=parseInt(e.target.value)||0;_e(l(i({},Ue),{secondBake:l(i({},Ue.secondBake),{topTemp:t,bottomTemp:t})}))},className:"text-xs border rounded px-1.5 py-1 text-center",placeholder:n("advDashboard.temperature")}),m.jsx("input",{type:"number",value:Ue.secondBake.time||"",onChange:e=>_e(l(i({},Ue),{secondBake:l(i({},Ue.secondBake),{time:parseInt(e.target.value)||0})})),className:"text-xs border rounded px-1.5 py-1 text-center",placeholder:n("units.time")})]})]})]})}),"bread"===Le&&m.jsx(Ce,{title:n("advDashboard.method"),icon:m.jsx(D,{className:"w-4 h-4"}),badge:n(ke[Je.type]),badgeColor:"straight"===Je.type?"bg-gray-100 text-gray-600":"bg-amber-100 text-amber-700",children:m.jsxs("div",{className:"space-y-2",children:[m.jsx("div",{className:"grid grid-cols-5 gap-1",children:Object.entries(ke).map(([e,t])=>m.jsx("button",{onClick:()=>Kt(e),className:"px-1.5 py-1 text-xs rounded "+(Je.type===e?"bg-amber-500 text-white":"bg-gray-100 hover:bg-gray-200"),children:n(t)},e))}),("coldFerment"===Je.type||"retard"===Je.type)&&m.jsxs("div",{className:"bg-blue-50 rounded p-2",children:[m.jsx("div",{className:"text-xs font-medium text-blue-700 mb-1",children:"coldFerment"===Je.type?`‚ùÑÔ∏è ${n("advDashboard.coldFerment")}`:`üåô ${n("advDashboard.coldRetard")}`}),m.jsx("div",{className:"text-xs text-blue-600",children:"coldFerment"===Je.type?n("advDashboard.coldFermentDesc",{percent:Math.round(100*Je.yeastAdjustment)}):n("advDashboard.coldRetardDesc")})]}),"straight"!==Je.type&&"coldFerment"!==Je.type&&"retard"!==Je.type&&m.jsxs("div",{className:"bg-amber-50 rounded p-2",children:[m.jsx("div",{className:"text-xs font-medium text-amber-700 mb-1.5",children:n("advDashboard.prefermentRatio")}),m.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[m.jsxs("div",{children:[m.jsx("label",{className:"text-xs text-gray-500",children:n("advDashboard.flourPercent")}),m.jsx("input",{type:"number",value:Math.round(100*Je.flourRatio),onChange:e=>Xe(l(i({},Je),{flourRatio:(parseFloat(e.target.value)||0)/100})),className:"w-full text-xs border rounded px-1.5 py-1 text-center",step:"10"})]}),m.jsxs("div",{children:[m.jsx("label",{className:"text-xs text-gray-500",children:n("advDashboard.waterPercent")}),m.jsx("input",{type:"number",value:Math.round(100*Je.waterRatio),onChange:e=>Xe(l(i({},Je),{waterRatio:(parseFloat(e.target.value)||0)/100})),className:"w-full text-xs border rounded px-1.5 py-1 text-center",step:"10"})]})]})]})]})}),m.jsx("div",{className:"p-2 border-t",children:m.jsxs("button",{onClick:We,className:"w-full flex items-center justify-center gap-1 text-xs text-gray-500 hover:text-gray-700 py-1",title:n("advDashboard.layoutReset"),children:[m.jsx(B,{className:"w-3 h-3"}),n("advDashboard.layoutReset")]})})]}),m.jsx(G,{direction:"horizontal",onResize:e=>De(xe.sidebarWidth+e),className:"hover:bg-blue-100"}),m.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden min-h-0",children:[m.jsx("div",{className:"flex-1 overflow-auto p-1 min-h-0",children:m.jsxs("div",{className:"grid gap-1 h-full grid-cols-2",children:[m.jsxs("div",{className:"bg-white rounded shadow-sm border flex flex-col overflow-hidden min-w-0",children:[m.jsxs("div",{className:"bg-gray-50 border-b px-2 py-0.5 flex items-center justify-between flex-shrink-0",children:[m.jsxs("span",{className:"font-semibold text-gray-700 flex items-center gap-1 text-[11px]",children:[m.jsx(A,{className:"w-3 h-3"}),n("advDashboard.originalRecipe")]}),m.jsxs("div",{className:"flex gap-2",children:[m.jsxs("button",{onClick:()=>ra(!0),className:"text-[10px] text-blue-600 hover:text-blue-700 font-medium",children:["üìã ",n("advDashboard.bulkInput")]}),m.jsx("button",{onClick:ia,className:"text-[10px] text-amber-600 hover:text-amber-700 font-medium",children:n("advDashboard.addIngredient")})]})]}),m.jsx("div",{className:"flex-1 overflow-auto",children:m.jsxs("table",{className:"w-full",children:[m.jsx("thead",{className:"bg-gray-50 sticky top-0",children:m.jsxs("tr",{className:`text-gray-500 ${Ht.fontSize}`,children:[m.jsx("th",{className:"px-1.5 py-1 text-left w-16",children:n("advDashboard.category")}),m.jsx("th",{className:"px-1.5 py-1 text-left",children:n("advDashboard.ingredients")}),m.jsx("th",{className:"px-1.5 py-1 text-left w-20",children:n("advDashboard.process")}),m.jsx("th",{className:"px-1.5 py-1 text-right w-10",children:n("advDashboard.tableHeaderPercent")}),m.jsx("th",{className:"px-1.5 py-1 text-right w-14",children:n("advDashboard.tableHeaderGram")}),m.jsx("th",{className:"w-5"})]})}),m.jsx("tbody",{className:Ht.fontSize,children:wt.map(({phase:e,items:t},a)=>{const s=we[e]||we.other;return m.jsxs(M.Fragment,{children:[Ct&&m.jsx("tr",{className:`${s.bgColor} ${s.borderColor} border-y-2`,children:m.jsx("td",{colSpan:5,className:`px-2 py-1 ${s.textColor} font-semibold text-xs`,children:m.jsxs("span",{className:"flex items-center gap-1",children:[m.jsx("span",{children:s.icon}),m.jsx("span",{children:n(s.labelKey)}),m.jsxs("span",{className:"text-[10px] font-normal opacity-60",children:["(",n("advDashboard.itemCount",{count:t.length}),")"]})]})})}),t.map(e=>{const t="bread"===Le?["main","preferment","tangzhong","autolyse","topping","other"]:["main","filling","frosting","topping","glaze","other"];return m.jsxs("tr",{className:`border-b border-gray-100 hover:bg-gray-50 ${Ht.rowHeight}`,children:[m.jsx("td",{className:"px-1.5",children:m.jsx("select",{value:e.category,onChange:t=>ca(e.id,"category",t.target.value),className:"w-full text-xs border-0 bg-transparent p-0 focus:outline-none appearance-none cursor-pointer",children:Object.entries(re).map(([e,t])=>m.jsx("option",{value:e,children:t},e))})}),m.jsx("td",{className:"px-1.5",children:m.jsx(ne,{value:e.name,onChange:t=>ca(e.id,"name",t),onSelect:t=>{const a=x(t);if(a){ca(e.id,"name",t);const s={flour:"flour",liquid:"liquid",fat:"wetOther",sugar:"other",egg:"wetOther",dairy:"liquid",leavening:"other",salt:"other",flavoring:"other",nut:"other",fruit:"other",chocolate:"other",other:"other"};ca(e.id,"category",s[a.category]||"other")}},placeholder:n("advDashboard.name"),className:"!border-0 !p-0 !ring-0 text-sm bg-transparent",maxSuggestions:6})}),m.jsx("td",{className:"px-1.5",children:m.jsx("select",{value:e.phase||"main",onChange:t=>ca(e.id,"phase",t.target.value),className:"w-full text-xs border-0 bg-transparent p-0 focus:outline-none appearance-none cursor-pointer",children:t.map(e=>{const t=we[e];return m.jsxs("option",{value:e,children:[t.icon," ",n(t.labelKey)]},e)})})}),m.jsx("td",{className:"px-1.5 text-right font-mono text-gray-400 text-xs",children:e.ratio}),m.jsx("td",{className:"px-1.5",children:m.jsx("input",{type:"number",value:e.amount,onChange:t=>ca(e.id,"amount",parseFloat(t.target.value)||0),className:"w-full text-right font-mono bg-transparent border-0 p-0 focus:outline-none text-sm"})}),m.jsx("td",{className:"px-0.5",children:m.jsx("button",{onClick:()=>da(e.id),className:"text-red-300 hover:text-red-500",children:m.jsx(g,{className:"w-3.5 h-3.5"})})})]},e.id)})]},e)})})]})}),m.jsx("div",{className:"bg-gray-50 border-t px-2 py-0.5 text-[11px] flex-shrink-0",children:m.jsxs("span",{children:[n("advDashboard.total"),": ",m.jsxs("b",{children:[kt,"g"]})]})})]}),m.jsxs("div",{className:"bg-white rounded shadow-sm border border-blue-200 flex flex-col overflow-hidden min-w-0",children:[m.jsxs("div",{className:"bg-blue-50 border-b border-blue-200 px-2 py-0.5 flex items-center justify-between flex-shrink-0",children:[m.jsxs("span",{className:"font-semibold text-blue-700 flex items-center gap-1 text-[11px]",children:[m.jsx(U,{className:"w-3 h-3"}),n("advDashboard.convertedRecipe")]}),1!==Wt&&m.jsxs("span",{className:"text-[9px] bg-blue-200 text-blue-700 px-1 py-0.5 rounded font-medium",children:["√ó",Wt]})]}),m.jsx("div",{className:"flex-1 overflow-auto",children:m.jsxs("table",{className:"w-full",children:[m.jsx("thead",{className:"bg-blue-50 sticky top-0",children:m.jsxs("tr",{className:`text-blue-700 ${Ht.fontSize}`,children:[m.jsx("th",{className:"px-2 py-1 text-left",children:n("advDashboard.category")}),m.jsx("th",{className:"px-2 py-1 text-left",children:n("advDashboard.ingredients")}),m.jsx("th",{className:"px-2 py-1 text-right w-16",children:n("advDashboard.tableHeaderGram")})]})}),m.jsx("tbody",{className:Ht.fontSize,children:Et.map(({phase:e,items:t})=>{const a=we[e]||we.other;return m.jsxs(M.Fragment,{children:[Ft&&m.jsx("tr",{className:`${a.bgColor} ${a.borderColor} border-y-2`,children:m.jsx("td",{colSpan:3,className:`px-2 py-1 ${a.textColor} font-semibold text-xs`,children:m.jsxs("span",{className:"flex items-center gap-1",children:[m.jsx("span",{children:a.icon}),m.jsx("span",{children:n(a.labelKey)}),m.jsxs("span",{className:"text-[10px] font-normal opacity-60",children:["(",n("advDashboard.itemCount",{count:t.length}),")"]})]})})}),t.map(e=>m.jsxs("tr",{className:`border-b border-blue-100 ${Ht.rowHeight}`,children:[m.jsx("td",{className:"px-2 text-blue-600",children:re[e.category]}),m.jsx("td",{className:"px-2",children:o(e.name)}),m.jsx("td",{className:"px-2 text-right font-mono font-medium text-blue-700",children:e.convertedAmount})]},e.id))]},e)})})]})}),m.jsx("div",{className:"bg-blue-50 border-t border-blue-200 px-2 py-0.5 text-[11px] flex-shrink-0",children:m.jsxs("span",{className:"text-blue-700",children:[n("advDashboard.total"),": ",m.jsxs("b",{children:[Math.round(At+qt),"g"]})]})})]})]})}),m.jsx(G,{direction:"vertical",onResize:e=>Me(xe.processPanelHeight-e),className:"hover:bg-blue-100"}),m.jsxs("div",{className:"bg-white border-t flex-shrink-0 overflow-hidden flex flex-col",style:{height:xe.processPanelHeight},children:[m.jsxs("div",{className:"bg-gray-50 border-b px-3 py-1 flex items-center justify-between flex-shrink-0",children:[m.jsxs("span",{className:"font-semibold text-gray-700 flex items-center gap-1.5 text-sm",children:[m.jsx(Y,{className:"w-4 h-4"}),n("advDashboard.processMemo"),m.jsx("span",{className:"text-xs font-normal text-gray-500 ml-1",children:n("advDashboard.totalMinutes",{minutes:tt.reduce((e,t)=>e+(t.time||0),0)})})]}),m.jsx("button",{onClick:ua,className:"text-xs text-amber-600 hover:text-amber-700 font-medium",children:n("advDashboard.addProcess")})]}),m.jsxs("div",{className:"flex-1 overflow-auto px-2 py-1.5",children:[m.jsx("div",{className:"flex gap-1.5 flex-wrap items-start",children:tt.map((e,t)=>{const a=Se(e.id),s=nt===e.id?e.description:c(e.description||"");return m.jsxs("div",{className:"flex items-center gap-1 bg-gray-50 border rounded px-1.5 py-1 text-xs group hover:bg-gray-100 relative",style:{minWidth:a.width||200,maxWidth:"100%"},children:[m.jsxs("div",{className:"flex flex-col opacity-0 group-hover:opacity-100 flex-shrink-0",children:[m.jsx("button",{onClick:()=>pa(e.id,"up"),className:"text-gray-400 hover:text-gray-600 -mb-0.5",disabled:0===t,title:n("advDashboard.moveUp"),children:m.jsx(T,{className:"w-3 h-3"})}),m.jsx("button",{onClick:()=>pa(e.id,"down"),className:"text-gray-400 hover:text-gray-600 -mt-0.5",disabled:t===tt.length-1,title:n("advDashboard.moveDown"),children:m.jsx(q,{className:"w-3 h-3"})})]}),m.jsxs("span",{className:"text-gray-400 font-mono text-[11px] w-4 flex-shrink-0",children:[t+1,"."]}),nt===e.id?m.jsx("textarea",{value:s,onChange:t=>ha(e.id,"description",t.target.value),onBlur:()=>ot(null),autoFocus:!0,className:"bg-transparent border-0 p-0 focus:outline-none text-xs flex-1 min-w-0 resize-none leading-relaxed",placeholder:n("advDashboard.processPlaceholder"),rows:3}):m.jsx("div",{onClick:()=>ot(e.id),className:"flex-1 min-w-0 cursor-text leading-relaxed whitespace-pre-wrap",children:s||m.jsx("span",{className:"text-gray-400",children:n("advDashboard.processPlaceholder")})}),e.time?m.jsxs("div",{className:"flex items-center gap-0.5 text-[11px] text-blue-600 bg-blue-50 px-1.5 py-0.5 rounded group/time",children:[m.jsx($,{className:"w-3 h-3 flex-shrink-0"}),m.jsx("input",{type:"number",value:e.time,onChange:t=>ha(e.id,"time",parseInt(t.target.value)||0),className:"w-8 bg-transparent border-0 p-0 text-center focus:outline-none"}),m.jsx("span",{className:"text-[10px] flex-shrink-0",children:n("units.minute")}),m.jsx("button",{onClick:()=>ha(e.id,"time",void 0),className:"text-blue-400 hover:text-blue-600 opacity-0 group-hover/time:opacity-100 ml-0.5 flex-shrink-0",title:n("advDashboard.deleteTime"),children:m.jsx(g,{className:"w-2.5 h-2.5"})})]}):m.jsx("button",{onClick:()=>ha(e.id,"time",1),className:"opacity-0 group-hover:opacity-60 hover:opacity-100 text-blue-400 bg-blue-50 px-1 py-0.5 rounded",title:n("advDashboard.addTime"),children:m.jsx($,{className:"w-3 h-3"})}),e.temp?m.jsxs("div",{className:"flex items-center gap-0.5 text-[11px] text-orange-600 bg-orange-50 px-1.5 py-0.5 rounded group/temp",children:[m.jsx(U,{className:"w-3 h-3 flex-shrink-0"}),m.jsx("input",{type:"number",value:e.temp,onChange:t=>ha(e.id,"temp",parseInt(t.target.value)||0),className:"w-8 bg-transparent border-0 p-0 text-center focus:outline-none"}),m.jsx("span",{className:"text-[10px] flex-shrink-0",children:n("units.celsius")}),m.jsx("button",{onClick:()=>ha(e.id,"temp",void 0),className:"text-orange-400 hover:text-orange-600 opacity-0 group-hover/temp:opacity-100 ml-0.5 flex-shrink-0",title:n("advDashboard.deleteTemp"),children:m.jsx(g,{className:"w-2.5 h-2.5"})})]}):m.jsx("button",{onClick:()=>ha(e.id,"temp",27),className:"opacity-0 group-hover:opacity-60 hover:opacity-100 text-orange-400 bg-orange-50 px-1 py-0.5 rounded",title:n("advDashboard.addTemp"),children:m.jsx(U,{className:"w-3 h-3"})}),m.jsx("button",{onClick:()=>ma(e.id),className:"text-red-300 hover:text-red-500 opacity-0 group-hover:opacity-100",children:m.jsx(g,{className:"w-3.5 h-3.5"})}),m.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-1 cursor-col-resize opacity-0 group-hover:opacity-100 hover:bg-blue-400 transition-colors",onMouseDown:t=>{t.preventDefault();const s=t.clientX,r=a.width||120,n=t=>{const a=t.clientX-s,n=Math.max(80,Math.min(400,r+a));$e(e.id,{width:n})},o=()=>{document.removeEventListener("mousemove",n),document.removeEventListener("mouseup",o),document.body.style.cursor="",document.body.style.userSelect=""};document.addEventListener("mousemove",n),document.addEventListener("mouseup",o),document.body.style.cursor="col-resize",document.body.style.userSelect="none"},title:n("advDashboard.resizeWidth"),children:m.jsx(F,{className:"w-2 h-full text-gray-300 group-hover:text-blue-400"})})]},e.id)})}),m.jsxs("div",{className:"mt-2 pt-2 border-t border-gray-200",children:[m.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[m.jsxs("span",{className:"text-xs font-medium text-gray-500",children:["üìå ",n("advDashboard.memo")]}),st&&m.jsxs("span",{className:"text-[10px] text-gray-400",children:["(",n("advDashboard.memoCharCount",{count:st.length}),")"]})]}),m.jsx("textarea",{value:st,onChange:e=>rt(e.target.value),placeholder:n("advDashboard.memoPlaceholder"),className:"w-full text-xs border rounded px-2 py-1.5 resize-none focus:outline-none focus:ring-1 focus:ring-amber-500",rows:2})]})]})]})]})]}),m.jsx(le,{isOpen:sa,onClose:()=>ra(!1),onImport:la})]})};export{De as default};
//# sourceMappingURL=AdvancedDashboard.tsx-BbKERboq.js.map
