var e=Object.defineProperty,t=Object.defineProperties,a=Object.getOwnPropertyDescriptors,s=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable,o=(t,a,s)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[a]=s,i=(e,t)=>{for(var a in t||(t={}))r.call(t,a)&&o(e,a,t[a]);if(s)for(var a of s(t))n.call(t,a)&&o(e,a,t[a]);return e},l=(e,s)=>t(e,a(s)),d=(e,t,a)=>new Promise((s,r)=>{var n=e=>{try{i(a.next(e))}catch(t){r(t)}},o=e=>{try{i(a.throw(e))}catch(t){r(t)}},i=e=>e.done?s(e.value):Promise.resolve(e.value).then(n,o);i((a=a.apply(e,t)).next())});import{c,r as u,j as m,u as h,e as p,f as x,X as g,g as b,h as y,S as v,I as f,d as j,a as N,i as k,P as w,k as C,W as D,R as M,C as $}from"./index-CkYa1yMR.js";import{U as S,T as W,C as T,a as R,b as L,R as B,c as I,D as A}from"./chunk-DtCqYRFb.js";import{C as q}from"./chunk-BBfgftjc.js";
/**
 * @license lucide-react v0.537.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P=c("chevron-right",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]),z=c("cookie",[["path",{d:"M12 2a10 10 0 1 0 10 10 4 4 0 0 1-5-5 4 4 0 0 1-5-5",key:"laymnq"}],["path",{d:"M8.5 8.5v.01",key:"ue8clq"}],["path",{d:"M16 15.5v.01",key:"14dtrp"}],["path",{d:"M12 12v.01",key:"u5ubse"}],["path",{d:"M11 17v.01",key:"1hyl5a"}],["path",{d:"M7 14v.01",key:"uct60s"}]]),O=c("file-text",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]),E=c("flame",[["path",{d:"M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z",key:"96xj49"}]]),F=c("grip-vertical",[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]]),H=c("layers",[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]]),K=c("link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]),Y=c("list-ordered",[["path",{d:"M10 12h11",key:"6m4ad9"}],["path",{d:"M10 18h11",key:"11hvi2"}],["path",{d:"M10 6h11",key:"c7qv1k"}],["path",{d:"M4 10h2",key:"16xx2s"}],["path",{d:"M4 6h1v4",key:"cnovpq"}],["path",{d:"M6 18H4c0-1 2-2 2-3s-1-1.5-2-1",key:"m9a95d"}]]),V=c("minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]),U=c("thermometer-sun",[["path",{d:"M12 9a4 4 0 0 0-2 7.5",key:"1jvsq6"}],["path",{d:"M12 3v2",key:"1w22ol"}],["path",{d:"m6.6 18.4-1.4 1.4",key:"w2yidj"}],["path",{d:"M20 4v10.54a4 4 0 1 1-4 0V4a2 2 0 0 1 4 0Z",key:"iof6y5"}],["path",{d:"M4 13H2",key:"118le4"}],["path",{d:"M6.34 7.34 4.93 5.93",key:"1brd51"}]]),_=c("unlink",[["path",{d:"m18.84 12.25 1.72-1.71h-.02a5.004 5.004 0 0 0-.12-7.07 5.006 5.006 0 0 0-6.95 0l-1.72 1.71",key:"yqzxt4"}],["path",{d:"m5.17 11.75-1.71 1.71a5.004 5.004 0 0 0 .12 7.07 5.006 5.006 0 0 0 6.95 0l1.71-1.71",key:"4qinb0"}],["line",{x1:"8",x2:"8",y1:"2",y2:"5",key:"1041cp"}],["line",{x1:"2",x2:"5",y1:"8",y2:"8",key:"14m1p5"}],["line",{x1:"16",x2:"16",y1:"19",y2:"22",key:"rzdirn"}],["line",{x1:"19",x2:"22",y1:"16",y2:"16",key:"ox905f"}]]),J="recipe-dashboard-layout",X={sidebarWidth:320,recipeContainerHeight:.6,processRowHeight:36,processPanelHeight:256,processItems:{}};const G=({direction:e,onResize:t,onResizeEnd:a,className:s=""})=>{const r=u.useRef(!1),n=u.useRef(0),o=u.useCallback(t=>{t.preventDefault(),r.current=!0,n.current="horizontal"===e?t.clientX:t.clientY,document.body.style.cursor="horizontal"===e?"col-resize":"row-resize",document.body.style.userSelect="none"},[e]);u.useEffect(()=>{const s=a=>{if(!r.current)return;const s="horizontal"===e?a.clientX:a.clientY,o=s-n.current;n.current=s,t(o)},o=()=>{r.current&&(r.current=!1,document.body.style.cursor="",document.body.style.userSelect="",null==a||a())};return document.addEventListener("mousemove",s),document.addEventListener("mouseup",o),()=>{document.removeEventListener("mousemove",s),document.removeEventListener("mouseup",o)}},[e,t,a]);const i="horizontal"===e?"w-1 cursor-col-resize hover:bg-blue-400 active:bg-blue-500 transition-colors":"h-1 cursor-row-resize hover:bg-blue-400 active:bg-blue-500 transition-colors";return m.jsx("div",{className:`${i} bg-transparent group flex items-center justify-center ${s}`,onMouseDown:o,children:"horizontal"===e?m.jsx("div",{className:"w-0.5 h-8 bg-gray-300 group-hover:bg-blue-400 rounded-full opacity-0 group-hover:opacity-100 transition-opacity"}):m.jsx("div",{className:"h-0.5 w-8 bg-gray-300 group-hover:bg-blue-400 rounded-full opacity-0 group-hover:opacity-100 transition-opacity"})})},Z=44032,Q=["ã„±","ã„²","ã„´","ã„·","ã„¸","ã„¹","ã…","ã…‚","ã…ƒ","ã……","ã…†","ã…‡","ã…ˆ","ã…‰","ã…Š","ã…‹","ã…Œ","ã…","ã…"];function ee(e){const t=e.charCodeAt(0);return t>=Z&&t<=55203}function te(e){return Q.includes(e)}function ae(e){const t=e.charCodeAt(0);if(t>=Z&&t<=55203){const e=Math.floor((t-Z)/588);return Q[e]}return e}function se(e){return e.split("").map(ae).join("")}function re(e,t){se(e),t.toLowerCase();let a=0,s=0;for(;a<e.length&&s<t.length;){const r=e[a],n=t[s];if(te(n)){if(!ee(r))return!1;if(ae(r)!==n)return!1;a++,s++}else if(ee(n)){if(r.toLowerCase()!==n.toLowerCase())return!1;a++,s++}else{if(r.toLowerCase()!==n.toLowerCase())return!1;a++,s++}}return s===t.length}function ne({value:e,displayValue:t,onChange:a,onSelect:s,placeholder:r,className:n="",suggestions:o,maxSuggestions:i=8,disabled:l=!1,autoFocus:d=!1}){const{t:c}=h(),g=null!=r?r:c("components.autocomplete.placeholder"),b=p(e=>e.getAllIngredientNames),y=null!=o?o:b(),[v,f]=u.useState(!1),[j,N]=u.useState(!1),[k,w]=u.useState(-1),[C,D]=u.useState([]),M=u.useRef(null),$=u.useRef(null);u.useEffect(()=>{const e=localStorage.getItem("recentIngredients");if(e)try{D(JSON.parse(e))}catch(t){}},[]);const S=u.useCallback(e=>{D(t=>{const a=t.filter(t=>t!==e),s=[e,...a].slice(0,10);return localStorage.setItem("recentIngredients",JSON.stringify(s)),s})},[]),W=u.useMemo(()=>{if(!e.trim())return C.slice(0,i);return function(e,t){const a=t.toLowerCase().trim();return[...e].sort((e,s)=>{const r=e.toLowerCase(),n=s.toLowerCase(),o=r.startsWith(a)||re(e,t),i=n.startsWith(a)||re(s,t);if(o&&!i)return-1;if(!o&&i)return 1;const l=r.includes(a),d=n.includes(a);return l&&!d?-1:!l&&d?1:e.length-s.length})}(function(e,t){if(!t.trim())return e;const a=t.toLowerCase().trim();return e.filter(e=>{if(e.toLowerCase().includes(a))return!0;if(re(e,t))return!0;const s=se(e),r=se(t);return!!s.includes(r)})}(y,e),e).slice(0,i)},[e,y,C,i]),T=u.useCallback(e=>{a(e),null==s||s(e),S(e),f(!1),w(-1)},[a,s,S]),R=u.useCallback(e=>{if(v||"ArrowDown"!==e.key&&"ArrowUp"!==e.key)switch(e.key){case"ArrowDown":e.preventDefault(),w(e=>e<W.length-1?e+1:0);break;case"ArrowUp":e.preventDefault(),w(e=>e>0?e-1:W.length-1);break;case"Enter":e.preventDefault(),k>=0&&k<W.length?T(W[k]):W.length>0&&T(W[0]);break;case"Escape":f(!1),w(-1);break;case"Tab":v&&k>=0&&(e.preventDefault(),T(W[k]))}else f(!0)},[v,k,W,T]),L=u.useCallback(e=>{a(e.target.value),f(!0),w(-1)},[a]),B=u.useCallback(()=>{f(!0),N(!0)},[]),I=u.useCallback(()=>{setTimeout(()=>{f(!1),N(!1),w(-1)},200)},[]);u.useEffect(()=>{if(k>=0&&$.current){const e=$.current.children[k];e&&e.scrollIntoView({block:"nearest"})}},[k]);const A=e=>{const t=x(e);if(!t)return"";return{flour:"ğŸŒ¾",liquid:"ğŸ’§",fat:"ğŸ§ˆ",sugar:"ğŸ¯",egg:"ğŸ¥š",dairy:"ğŸ¥›",leavening:"ğŸ«§",salt:"ğŸ§‚",flavoring:"ğŸŒ¿",nut:"ğŸ¥œ",fruit:"ğŸ",chocolate:"ğŸ«",other:"ğŸ“¦"}[t.category]||""},q=j?e:null!=t?t:e;return m.jsxs("div",{className:"relative",children:[m.jsx("input",{ref:M,type:"text",value:q,onChange:L,onKeyDown:R,onFocus:B,onBlur:I,placeholder:g,disabled:l,autoFocus:d,className:`w-full px-3 py-2 border border-gray-300 rounded-lg\n          focus:ring-2 focus:ring-amber-500 focus:border-amber-500\n          disabled:bg-gray-100 disabled:cursor-not-allowed\n          ${n}`,autoComplete:"off"}),v&&W.length>0&&m.jsxs("ul",{ref:$,className:"absolute z-50 w-full mt-1 bg-white border border-gray-200\r\n            rounded-lg shadow-lg max-h-60 overflow-auto",children:[!e.trim()&&C.length>0&&m.jsx("li",{className:"px-3 py-1 text-xs text-gray-500 bg-gray-50 border-b",children:c("components.autocomplete.recentlyUsed")}),W.map((e,t)=>m.jsxs("li",{onClick:()=>T(e),className:"px-3 py-2 cursor-pointer flex items-center gap-2\n                "+(t===k?"bg-amber-100 text-amber-900":"hover:bg-gray-100"),children:[m.jsx("span",{className:"text-sm",children:A(e)}),m.jsx("span",{className:"flex-1",children:e}),t===k&&m.jsx("span",{className:"text-xs text-gray-400",children:"Enter"})]},e))]}),v&&e.trim()&&0===W.length&&m.jsx("div",{className:"absolute z-50 w-full mt-1 px-3 py-2 bg-gray-50\r\n          border border-gray-200 rounded-lg text-sm text-gray-500",children:c("components.autocomplete.noMatch",{value:e})})]})}const oe={flour:"flour",liquid:"liquid",fat:"wetOther",sugar:"other",egg:"wetOther",dairy:"liquid",leavening:"other",salt:"other",flavoring:"other",nut:"other",fruit:"other",chocolate:"other",other:"other"};function ie(e){var t;const a=e.trim();if(!a||a.startsWith("#")||a.startsWith("//"))return null;let s="",r="";if(a.includes("\t")){const e=a.split("\t").map(e=>e.trim()).filter(Boolean);e.length>=2&&(s=e[0],r=e[1])}else if(a.includes(",")){const e=a.split(",").map(e=>e.trim()).filter(Boolean);e.length>=2&&(s=e[0],r=e[1])}else{const e=a.match(/^(.+?)\s+(\d+\.?\d*)\s*(g|kg|ml|L|ê°œ)?$/i);if(e){s=e[1].trim(),r=e[2];const a=null==(t=e[3])?void 0:t.toLowerCase();("kg"===a||"l"===a)&&(r=String(1e3*parseFloat(e[2])))}}if(!s)return{name:a,amount:0,category:"other",isValid:!1,error:"í˜•ì‹ì„ ì¸ì‹í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤"};const n=r.replace(/[^\d.]/g,""),o=parseFloat(n);if(isNaN(o)||o<=0)return{name:s,amount:0,category:"other",isValid:!1,error:`ì–‘ì„ ì¸ì‹í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤: "${r}"`};const i=x(s);return{name:s,amount:o,category:i&&oe[i.category]||"other",isValid:!0}}function le({isOpen:e,onClose:t,onImport:a}){const{t:s}=h(),[r,n]=u.useState(""),[o,i]=u.useState([]),[l,c]=u.useState(!1),p=u.useCallback(()=>{const e=r.split("\n").map(ie).filter(e=>null!==e);i(e),c(!0)},[r]),v=u.useCallback(()=>{const e=o.filter(e=>e.isValid).map(e=>({name:e.name,amount:e.amount,category:e.category}));e.length>0&&(a(e),n(""),i([]),c(!1),t())},[o,a,t]),f=u.useCallback(()=>{n(""),i([]),c(!1)},[]),j=u.useCallback(()=>d(this,null,function*(){try{const e=yield navigator.clipboard.readText();n(e),c(!1)}catch(e){}}),[]);if(!e)return null;const N=o.filter(e=>e.isValid).length,k=o.filter(e=>!e.isValid).length;return m.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:m.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-2xl max-h-[80vh] flex flex-col",children:[m.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b",children:[m.jsxs("h3",{className:"font-semibold text-lg flex items-center gap-2",children:[m.jsx(O,{className:"w-5 h-5 text-amber-600"}),s("components.bulkInput.title")]}),m.jsx("button",{onClick:t,className:"p-1 hover:bg-gray-100 rounded",children:m.jsx(g,{className:"w-5 h-5"})})]}),m.jsxs("div",{className:"flex-1 overflow-auto p-4 space-y-4",children:[m.jsxs("div",{className:"text-sm text-gray-600 bg-gray-50 p-3 rounded-lg",children:[m.jsx("p",{className:"font-medium mb-1",children:s("components.bulkInput.supportedFormats")}),m.jsxs("ul",{className:"text-xs space-y-0.5 text-gray-500",children:[m.jsxs("li",{children:["â€¢ ",s("components.bulkInput.formatExample1")]}),m.jsxs("li",{children:["â€¢ ",s("components.bulkInput.formatExample2")]}),m.jsxs("li",{children:["â€¢ ",s("components.bulkInput.formatExample3")]})]})]}),m.jsxs("div",{children:[m.jsxs("div",{className:"flex items-center justify-between mb-2",children:[m.jsx("label",{className:"text-sm font-medium text-gray-700",children:s("components.bulkInput.ingredientList")}),m.jsxs("button",{onClick:j,className:"text-xs flex items-center gap-1 px-2 py-1 bg-gray-100 hover:bg-gray-200 rounded",children:[m.jsx(S,{className:"w-3 h-3"}),s("common.pasteFromClipboard")]})]}),m.jsx("textarea",{value:r,onChange:e=>{n(e.target.value),c(!1)},placeholder:s("components.bulkInput.placeholder"),className:"w-full h-40 p-3 border rounded-lg text-sm font-mono resize-none focus:ring-2 focus:ring-amber-500 focus:border-amber-500"})]}),l&&o.length>0&&m.jsxs("div",{className:"border rounded-lg overflow-hidden",children:[m.jsxs("div",{className:"bg-gray-50 px-3 py-2 border-b flex items-center justify-between",children:[m.jsx("span",{className:"text-sm font-medium",children:s("components.bulkInput.parseResult")}),m.jsxs("div",{className:"flex gap-2 text-xs",children:[N>0&&m.jsxs("span",{className:"text-green-600 flex items-center gap-1",children:[m.jsx(b,{className:"w-3 h-3"}),s("components.bulkInput.successCount",{count:N})]}),k>0&&m.jsxs("span",{className:"text-red-500 flex items-center gap-1",children:[m.jsx(y,{className:"w-3 h-3"}),s("components.bulkInput.failCount",{count:k})]})]})]}),m.jsx("div",{className:"max-h-48 overflow-auto",children:m.jsxs("table",{className:"w-full text-sm",children:[m.jsx("thead",{className:"bg-gray-50 sticky top-0",children:m.jsxs("tr",{children:[m.jsx("th",{className:"text-left px-3 py-1.5 font-medium",children:s("common.status")}),m.jsx("th",{className:"text-left px-3 py-1.5 font-medium",children:s("components.bulkInput.tableName")}),m.jsx("th",{className:"text-right px-3 py-1.5 font-medium",children:s("components.bulkInput.tableAmount")}),m.jsx("th",{className:"text-left px-3 py-1.5 font-medium",children:s("common.note")})]})}),m.jsx("tbody",{children:o.map((e,t)=>m.jsxs("tr",{className:"border-t "+(e.isValid?"":"bg-red-50"),children:[m.jsx("td",{className:"px-3 py-1.5",children:e.isValid?m.jsx(b,{className:"w-4 h-4 text-green-500"}):m.jsx(y,{className:"w-4 h-4 text-red-500"})}),m.jsx("td",{className:"px-3 py-1.5",children:e.name}),m.jsx("td",{className:"px-3 py-1.5 text-right font-mono",children:e.isValid?e.amount:"-"}),m.jsx("td",{className:"px-3 py-1.5 text-xs text-gray-500",children:e.error||(x(e.name)?s("components.bulkInput.dbMatched"):"")})]},t))})]})})]})]}),m.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-t bg-gray-50",children:[m.jsx("button",{onClick:f,className:"px-3 py-1.5 text-sm text-gray-600 hover:bg-gray-200 rounded",children:s("common.reset")}),m.jsxs("div",{className:"flex gap-2",children:[m.jsx("button",{onClick:t,className:"px-4 py-1.5 text-sm border rounded hover:bg-gray-100",children:s("common.cancel")}),l?m.jsx("button",{onClick:v,disabled:0===N,className:"px-4 py-1.5 text-sm bg-green-500 text-white rounded hover:bg-green-600 disabled:opacity-50 disabled:cursor-not-allowed",children:s("components.bulkInput.importCount",{count:N})}):m.jsx("button",{onClick:p,disabled:!r.trim(),className:"px-4 py-1.5 text-sm bg-amber-500 text-white rounded hover:bg-amber-600 disabled:opacity-50 disabled:cursor-not-allowed",children:s("common.parse")})]})]})]})})}const de={bread:{mixing:2,fermentation:1,dividing:1.5,shaping:1,baking:12,cooling:2},cake:{mixing:3,fermentation:0,dividing:0,shaping:0,baking:15,cooling:1.5},pastry:{mixing:1.5,fermentation:.5,dividing:2,shaping:2,baking:18,cooling:1},cookie:{mixing:2.5,fermentation:0,dividing:1,shaping:1.5,baking:8,cooling:.5},other:{mixing:2,fermentation:.5,dividing:1,shaping:1,baking:12,cooling:1.5}},ce={pullman:{baking:10},mountain:{baking:13},brioche:{baking:11,mixing:3},genoise:{baking:14,mixing:4},chiffon:{baking:13,mixing:3.5},pound:{baking:10,mixing:3},brownie:{baking:8},cheesecake:{baking:5},croissant:{baking:20,shaping:3},danish:{baking:18,shaping:2.5},puff_pastry:{baking:22},baguette:{baking:18,shaping:1.5},ciabatta:{baking:16,mixing:3},sourdough:{baking:15,fermentation:2},cookie:{baking:8},scone:{baking:12},tart:{baking:10,shaping:2}};const ue={mixing:!0,fermentation:!0,dividing:!0,shaping:!0,baking:!0,cooling:!0};function me(e,t,a,s,r){const n=i({},de[t]);a&&ce[a]&&Object.assign(n,ce[a]);const o=s?function(e){let t=1;void 0!==e.humidity&&(t*=1+.005*(60-e.humidity));void 0!==e.temperature&&(t*=1+.01*(e.temperature-25));return Math.max(.8,Math.min(1.3,t))}(s):1,l=[];let d=e;const c=[{key:"mixing",name:"ë¯¹ì‹±"},{key:"fermentation",name:"ë°œíš¨"},{key:"dividing",name:"ë¶„í• "},{key:"shaping",name:"ì„±í˜•"},{key:"baking",name:"êµ½ê¸°"},{key:"cooling",name:"ëƒ‰ê°"}],u=r||ue;for(const i of c){if(!u[i.key])continue;let e=n[i.key];if("baking"===i.key&&(e*=o),e<=0)continue;const t=Math.round(d*(e/100));d-=t,l.push({stage:i.name,lossPercent:Math.round(10*e)/10,lossWeight:t,remainingWeight:d})}const m=d,h=e-m,p=Math.round(h/e*1e3)/10,x=Math.round(m/e*1e3)/10,g=function(e,t,a,s){const r=[];"bread"===e?(r.push("ë°˜ì£½ê¸° ë‚´ë¶€ì— ì˜¤ì¼ ìŠ¤í”„ë ˆì´ë¡œ ë°˜ì£½ ë¶™ìŒ ë°©ì§€"),r.push("ë¶„í•  ì‹œ ìŠ¤í¬ë˜í¼ì— ë°€ê°€ë£¨ ì‚¬ìš©")):"cake"===e?(r.push("ë³¼/íœ˜í¼ì— ë¶™ì€ ë°˜ì£½ì„ ê¹¨ë—ì´ ê¸ì–´ ì‚¬ìš©"),r.push("íŒ¬ì— ìœ ì‚°ì§€ ê¹”ì•„ ì†ì‹¤ ìµœì†Œí™”")):"pastry"===e&&(r.push("ì‘ì—…ëŒ€ì— ë°€ê°€ë£¨ ì ì ˆíˆ ë¿Œë ¤ ë¶™ìŒ ë°©ì§€"),r.push("ì°¨ê°€ìš´ ìƒíƒœë¡œ ì‘ì—…í•´ ë²„í„° ìš©ì¶œ ë°©ì§€"));"croissant"===t?r.push("êµ½ê¸° í›„ ë°”ë¡œ ì„ ë°˜ì— ì˜¬ë ¤ ë°”ë‹¥ ëˆ…ëˆ…í•¨ ë°©ì§€"):"baguette"===t?r.push("ìŠ¤íŒ€ êµ½ê¸°ë¡œ ê»ì§ˆ í˜•ì„± í›„ ìˆ˜ë¶„ ì¦ë°œ ì¡°ì ˆ"):"chiffon"===t&&r.push("íŒ¬ì— ê¸°ë¦„ ë°”ë¥´ì§€ ì•Šì•„ì•¼ ë†’ì´ ìœ ì§€");void 0!==(null==s?void 0:s.humidity)&&(s.humidity<50?r.push("ê±´ì¡°í•œ í™˜ê²½: ë°˜ì£½ ë®ê°œë¡œ í‘œë©´ ê±´ì¡° ë°©ì§€"):s.humidity>70&&r.push("ìŠµí•œ í™˜ê²½: êµ½ê¸° ì‹œê°„ ì•½ê°„ ì—°ì¥ ê³ ë ¤"));void 0!==(null==s?void 0:s.temperature)&&s.temperature>30&&r.push("ê³ ì˜¨ í™˜ê²½: ë°˜ì£½ ì˜¨ë„ ê´€ë¦¬ì— ì£¼ì˜");return r}(t,a,0,s);return{inputWeight:e,outputWeight:m,totalLossPercent:p,totalLossWeight:h,yieldPercent:x,processLosses:l,tips:g}}const he=[{value:"bread",key:"bread"},{value:"cake",key:"cake"},{value:"pastry",key:"pastry"},{value:"cookie",key:"cookie"},{value:"other",key:"other"}],pe={bread:[{value:"",key:"general_bread"},{value:"pullman",key:"pullman"},{value:"mountain",key:"mountain"},{value:"brioche",key:"brioche"},{value:"baguette",key:"baguette"},{value:"ciabatta",key:"ciabatta"},{value:"sourdough",key:"sourdough"}],cake:[{value:"",key:"general_cake"},{value:"genoise",key:"genoise"},{value:"chiffon",key:"chiffon"},{value:"pound",key:"pound"},{value:"brownie",key:"brownie"},{value:"cheesecake",key:"cheesecake"}],pastry:[{value:"",key:"general_pastry"},{value:"croissant",key:"croissant"},{value:"danish",key:"danish"},{value:"puff_pastry",key:"puff_pastry"}],cookie:[{value:"",key:"general_cookie"},{value:"cookie",key:"cookie"},{value:"scone",key:"scone"}],other:[{value:"",key:"general_other"},{value:"tart",key:"tart"}]},xe=[{key:"mixing",translationKey:"mixing",icon:"ğŸ¥£"},{key:"fermentation",translationKey:"fermentation",icon:"ğŸ"},{key:"dividing",translationKey:"dividing",icon:"âœ‚ï¸"},{key:"shaping",translationKey:"shaping",icon:"ğŸ‘"},{key:"baking",translationKey:"baking",icon:"ğŸ”¥"},{key:"cooling",translationKey:"cooling",icon:"â„ï¸"}];function ge({inputWeight:e,category:t,productType:a,environment:s,stageSelection:r,onStageSelectionChange:n,compact:o=!1,className:d=""}){var c;const{t:p}=h(),[x,g]=u.useState(1e3),[b,y]=u.useState("bread"),[j,N]=u.useState(""),[k,w]=u.useState(60),[C,D]=u.useState(25),[M,$]=u.useState(!o),[S,B]=u.useState(!1),[I,A]=u.useState(!0),[P,z]=u.useState("forward"),[O,E]=u.useState(800),[F,H]=u.useState(ue),K=null!=e?e:x,Y=null!=t?t:b,V=null!=a?a:j,U=null!=s?s:{humidity:k,temperature:C},_=null!=r?r:F,J=u.useCallback(e=>{const t=l(i({},_),{[e]:!_[e]});n?n(t):H(t)},[_,n]),X=u.useCallback(e=>{const t={mixing:e,fermentation:e,dividing:e,shaping:e,baking:e,cooling:e};n?n(t):H(t)},[n]),G=u.useMemo(()=>Object.values(_).filter(Boolean).length,[_]),Z=u.useMemo(()=>K<=0?null:me(K,Y,V||void 0,U,_),[K,Y,V,U,_]),Q=u.useMemo(()=>O<=0?0:function(e,t,a,s,r){const n=me(1e3,t,a,s,r).yieldPercent/100;return Math.ceil(e/n)}(O,Y,V||void 0,U,_),[O,Y,V,U,_]),ee=e=>e>=15?"text-red-600":e>=10?"text-orange-500":e>=5?"text-yellow-600":"text-green-600";return o&&Z?m.jsxs("div",{className:`flex items-center gap-2 text-sm ${d}`,children:[m.jsx(W,{className:"w-4 h-4 text-orange-500"}),m.jsxs("span",{children:[p("components.yieldLoss.expectedOutput"),": ",m.jsxs("b",{className:"text-blue-600",children:[Z.outputWeight.toLocaleString(),"g"]}),m.jsxs("span",{className:`ml-1 ${ee(Z.totalLossPercent)}`,children:["(-",Z.totalLossPercent,"%)"]}),G<6&&m.jsxs("span",{className:"ml-1 text-gray-400 text-xs",children:["(",G,p("components.yieldLoss.processes"),")"]})]})]}):m.jsxs("div",{className:`bg-white border rounded-lg shadow-sm ${d}`,children:[m.jsxs("div",{className:"flex items-center justify-between p-3 border-b bg-gradient-to-r from-orange-50 to-amber-50",children:[m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx(W,{className:"w-5 h-5 text-orange-600"}),m.jsx("h3",{className:"font-semibold text-gray-800",children:p("components.yieldLoss.title")})]}),m.jsxs("div",{className:"flex gap-1",children:[m.jsx("button",{onClick:()=>z("forward"),className:"px-2 py-1 text-xs rounded "+("forward"===P?"bg-orange-500 text-white":"bg-gray-100 text-gray-600"),children:p("components.yieldLoss.inputToOutput")}),m.jsx("button",{onClick:()=>z("reverse"),className:"px-2 py-1 text-xs rounded "+("reverse"===P?"bg-orange-500 text-white":"bg-gray-100 text-gray-600"),children:p("components.yieldLoss.outputToInput")})]})]}),m.jsxs("div",{className:"p-3 space-y-3",children:[!t&&m.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[m.jsxs("div",{children:[m.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:p("components.yieldLoss.productType")}),m.jsx("select",{value:b,onChange:e=>{y(e.target.value),N("")},className:"w-full px-2 py-1.5 text-sm border rounded",children:he.map(e=>m.jsx("option",{value:e.value,children:p(`components.yieldLoss.categories.${e.key}`)},e.value))})]}),m.jsxs("div",{children:[m.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:p("components.yieldLoss.detailProduct")}),m.jsx("select",{value:j,onChange:e=>N(e.target.value),className:"w-full px-2 py-1.5 text-sm border rounded",children:pe[b].map(e=>m.jsx("option",{value:e.value,children:p(`components.yieldLoss.products.${e.key}`)},e.value))})]})]}),m.jsxs("div",{children:[m.jsxs("button",{onClick:()=>A(!I),className:"flex items-center gap-1 text-xs text-gray-600 hover:text-gray-800 mb-2",children:[I?m.jsx(T,{className:"w-3 h-3"}):m.jsx(q,{className:"w-3 h-3"}),m.jsx("span",{className:"font-medium",children:p("components.yieldLoss.processSelection")}),m.jsxs("span",{className:"text-gray-400",children:["(",G,"/6 ",p("components.yieldLoss.selectedProcesses"),")"]})]}),I&&m.jsxs("div",{className:"p-2 bg-gray-50 rounded space-y-2",children:[m.jsxs("div",{className:"flex justify-between items-center mb-1",children:[m.jsx("span",{className:"text-xs text-gray-500",children:p("components.yieldLoss.selectProcessesForCalc")}),m.jsxs("div",{className:"flex gap-1",children:[m.jsx("button",{onClick:()=>X(!0),className:"px-2 py-0.5 text-xs bg-blue-100 text-blue-600 rounded hover:bg-blue-200",children:p("components.yieldLoss.selectAll")}),m.jsx("button",{onClick:()=>X(!1),className:"px-2 py-0.5 text-xs bg-gray-200 text-gray-600 rounded hover:bg-gray-300",children:p("components.yieldLoss.deselectAll")})]})]}),m.jsx("div",{className:"grid grid-cols-3 gap-1",children:xe.map(e=>m.jsxs("button",{onClick:()=>J(e.key),className:"flex items-center gap-1 px-2 py-1.5 rounded text-xs transition-colors "+(_[e.key]?"bg-orange-100 text-orange-700 border border-orange-300":"bg-white text-gray-400 border border-gray-200 line-through"),children:[m.jsx("span",{children:e.icon}),m.jsx("span",{children:p(`components.yieldLoss.stages.${e.translationKey}`)}),_[e.key]&&m.jsx(R,{className:"w-3 h-3 ml-auto"})]},e.key))}),G<6&&m.jsxs("div",{className:"text-xs text-orange-600 flex items-center gap-1",children:[m.jsx(L,{className:"w-3 h-3"}),p("components.yieldLoss.processesExcluded",{count:6-G})]})]})]}),m.jsx("div",{className:"flex items-center gap-3",children:"forward"===P?m.jsxs(m.Fragment,{children:[m.jsxs("div",{className:"flex-1",children:[m.jsxs("label",{className:"block text-xs text-gray-500 mb-1",children:[p("components.yieldLoss.inputWeight")," (g)"]}),m.jsx("input",{type:"number",value:null!=e?e:x,onChange:t=>!e&&g(parseInt(t.target.value)||0),disabled:!!e,className:"w-full px-2 py-1.5 text-sm border rounded text-right font-mono"})]}),m.jsx("div",{className:"flex items-center pt-5",children:m.jsx("span",{className:"text-gray-400",children:"â†’"})}),m.jsxs("div",{className:"flex-1",children:[m.jsxs("label",{className:"block text-xs text-gray-500 mb-1",children:[p("components.yieldLoss.expectedOutput")," (g)",G<6&&m.jsxs("span",{className:"text-orange-500 ml-1",children:["*",G,p("components.yieldLoss.processes")]})]}),m.jsx("div",{className:"px-2 py-1.5 text-sm bg-blue-50 border border-blue-200 rounded text-right font-mono font-semibold text-blue-700",children:null!=(c=null==Z?void 0:Z.outputWeight.toLocaleString())?c:"-"})]})]}):m.jsxs(m.Fragment,{children:[m.jsxs("div",{className:"flex-1",children:[m.jsxs("label",{className:"block text-xs text-gray-500 mb-1",children:[p("components.yieldLoss.targetOutput")," (g)"]}),m.jsx("input",{type:"number",value:O,onChange:e=>E(parseInt(e.target.value)||0),className:"w-full px-2 py-1.5 text-sm border rounded text-right font-mono"})]}),m.jsx("div",{className:"flex items-center pt-5",children:m.jsx("span",{className:"text-gray-400",children:"â†"})}),m.jsxs("div",{className:"flex-1",children:[m.jsxs("label",{className:"block text-xs text-gray-500 mb-1",children:[p("components.yieldLoss.requiredInput")," (g)"]}),m.jsx("div",{className:"px-2 py-1.5 text-sm bg-green-50 border border-green-200 rounded text-right font-mono font-semibold text-green-700",children:Q.toLocaleString()})]})]})}),"forward"===P&&Z&&m.jsxs("div",{className:"flex items-center justify-between px-3 py-2 bg-gray-50 rounded",children:[m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx(v,{className:"w-4 h-4 text-gray-500"}),m.jsx("span",{className:"text-sm text-gray-600",children:p("components.yieldLoss.yield")})]}),m.jsxs("div",{className:"flex items-center gap-3",children:[m.jsxs("span",{className:"text-lg font-bold text-blue-600",children:[Z.yieldPercent,"%"]}),m.jsxs("span",{className:`text-sm ${ee(Z.totalLossPercent)}`,children:["(",p("components.yieldLoss.loss")," ",Z.totalLossPercent,"% / ",Z.totalLossWeight.toLocaleString(),"g)"]})]})]}),!s&&m.jsxs("button",{onClick:()=>B(!S),className:"flex items-center gap-1 text-xs text-gray-500 hover:text-gray-700",children:[S?m.jsx(T,{className:"w-3 h-3"}):m.jsx(q,{className:"w-3 h-3"}),p("components.yieldLoss.envSettings")]}),S&&!s&&m.jsxs("div",{className:"grid grid-cols-2 gap-2 p-2 bg-gray-50 rounded",children:[m.jsxs("div",{children:[m.jsxs("label",{className:"block text-xs text-gray-500 mb-1",children:[p("components.yieldLoss.humidity")," (%)"]}),m.jsx("input",{type:"number",value:k,onChange:e=>w(parseInt(e.target.value)||60),min:20,max:90,className:"w-full px-2 py-1 text-sm border rounded text-right"})]}),m.jsxs("div",{children:[m.jsxs("label",{className:"block text-xs text-gray-500 mb-1",children:[p("components.yieldLoss.roomTemp")," (Â°C)"]}),m.jsx("input",{type:"number",value:C,onChange:e=>D(parseInt(e.target.value)||25),min:15,max:40,className:"w-full px-2 py-1 text-sm border rounded text-right"})]}),(60!==k||25!==C)&&m.jsxs("div",{className:"col-span-2 flex items-start gap-1 text-xs text-orange-600",children:[m.jsx(L,{className:"w-3 h-3 mt-0.5 flex-shrink-0"}),m.jsx("span",{children:p("components.yieldLoss.envNote")})]})]}),"forward"===P&&Z&&m.jsxs("button",{onClick:()=>$(!M),className:"flex items-center gap-1 text-xs text-blue-600 hover:text-blue-800",children:[M?m.jsx(T,{className:"w-3 h-3"}):m.jsx(q,{className:"w-3 h-3"}),p("components.yieldLoss.processDetails")]}),M&&"forward"===P&&Z&&m.jsxs("div",{className:"space-y-2",children:[m.jsx("div",{className:"text-xs text-gray-500 mb-2",children:p("components.yieldLoss.processDetailsDesc")}),Z.processLosses.map((e,t)=>m.jsxs("div",{className:"flex items-center text-sm",children:[m.jsx("div",{className:"w-12 text-gray-600",children:e.stage}),m.jsx("div",{className:"flex-1 mx-2",children:m.jsx("div",{className:"h-2 bg-gray-200 rounded overflow-hidden",children:m.jsx("div",{className:"h-full "+(e.lossPercent>=10?"bg-red-400":e.lossPercent>=5?"bg-orange-400":"bg-yellow-400"),style:{width:`${Math.min(5*e.lossPercent,100)}%`}})})}),m.jsxs("div",{className:"w-16 text-right text-gray-500",children:["-",e.lossPercent,"%"]}),m.jsxs("div",{className:"w-20 text-right font-mono text-gray-600",children:["-",e.lossWeight,"g"]}),m.jsxs("div",{className:"w-24 text-right font-mono text-gray-400",children:["â†’ ",e.remainingWeight.toLocaleString(),"g"]})]},t))]}),Z&&Z.tips.length>0&&m.jsxs("div",{className:"p-2 bg-blue-50 rounded text-xs",children:[m.jsxs("div",{className:"flex items-center gap-1 text-blue-700 font-medium mb-1",children:[m.jsx(f,{className:"w-3 h-3"}),p("components.yieldLoss.minimizeLossTips")]}),m.jsx("ul",{className:"list-disc list-inside text-blue-600 space-y-0.5",children:Z.tips.slice(0,3).map((e,t)=>m.jsx("li",{children:e},t))})]})]})]})}const be={"í’€ë¨¼ì‹ë¹µ":3.4,"ì‚°í˜•ì‹ë¹µ":4.2,"ë²„í„°í†±ì‹ë¹µ":4,"ì˜¥ìˆ˜ìˆ˜ì‹ë¹µ":3.8,"ìš°ìœ ì‹ë¹µ":4,"ëª¨ë‹ë¹µ":3.2,"ë² ì´ê¸€":2.5,"ë¸Œë¦¬ì˜¤ìŠˆ":3.5,"ì¹˜ì•„ë°”íƒ€":5,"ë°”ê²ŒíŠ¸":5.5},ye={"íŒŒìš´ë“œì¼€ì´í¬":.83,"ë ˆì´ì–´ì¼€ì´í¬":.83,"ìŠ¤í€ì§€ì¼€ì´í¬":.55,"ì‹œí°ì¼€ì´í¬":.45,"ì—”ì ¤í‘¸ë“œì¼€ì´í¬":.4,"ë¬´ìŠ¤ì¼€ì´í¬":.9},ve={"íŒŒìš´ë“œì¼€ì´í¬":2.5,"ë ˆì´ì–´ì¼€ì´í¬":2.5,"ìŠ¤í€ì§€ì¼€ì´í¬":2.3,"ì‹œí°ì¼€ì´í¬":3.2,"ì—”ì ¤í‘¸ë“œì¼€ì´í¬":4.5,"ë¬´ìŠ¤ì¼€ì´í¬":1.8},fe={straight:{flour:0,water:0},sponge:{flour:.5,water:.6},poolish:{flour:.3,water:1},biga:{flour:.3,water:.55},tangzhong:{flour:.1,water:5},autolyse:{flour:1,water:.65},levain:{flour:.2,water:1},coldFerment:{flour:0,water:0},retard:{flour:0,water:0}},je={straight:{yeastAdjustment:1,prefermentYeastRatio:0},sponge:{yeastAdjustment:.75,prefermentYeastRatio:1},poolish:{yeastAdjustment:.66,prefermentYeastRatio:.15},biga:{yeastAdjustment:.5,prefermentYeastRatio:.1},tangzhong:{yeastAdjustment:1,prefermentYeastRatio:0},autolyse:{yeastAdjustment:1,prefermentYeastRatio:0},levain:{yeastAdjustment:0,prefermentYeastRatio:0},coldFerment:{yeastAdjustment:.4,prefermentYeastRatio:0},retard:{yeastAdjustment:1,prefermentYeastRatio:0}},Ne={straight:"method.straight",sponge:"method.sponge",poolish:"method.poolish",biga:"method.biga",tangzhong:"method.tangzhong",autolyse:"method.autolyse",levain:"method.levain",coldFerment:"method.coldFerment",retard:"method.retard"},ke={tangzhong:{icon:"ğŸœ",labelKey:"phase.tangzhong",bgColor:"bg-pink-50",textColor:"text-pink-700",borderColor:"border-pink-200"},preferment:{icon:"ğŸ§ª",labelKey:"phase.preferment",bgColor:"bg-amber-50",textColor:"text-amber-700",borderColor:"border-amber-200"},poolish:{icon:"ğŸ§ª",labelKey:"phase.poolish",bgColor:"bg-amber-50",textColor:"text-amber-700",borderColor:"border-amber-200"},biga:{icon:"ğŸ§ª",labelKey:"phase.biga",bgColor:"bg-amber-50",textColor:"text-amber-700",borderColor:"border-amber-200"},sponge:{icon:"ğŸ§ª",labelKey:"phase.sponge",bgColor:"bg-amber-50",textColor:"text-amber-700",borderColor:"border-amber-200"},levain:{icon:"ğŸ¥–",labelKey:"phase.levain",bgColor:"bg-amber-50",textColor:"text-amber-700",borderColor:"border-amber-200"},autolyse:{icon:"â³",labelKey:"phase.autolyse",bgColor:"bg-purple-50",textColor:"text-purple-700",borderColor:"border-purple-200"},main:{icon:"ğŸ",labelKey:"phase.mainDough",bgColor:"bg-blue-50",textColor:"text-blue-700",borderColor:"border-blue-200"},topping:{icon:"âœ¨",labelKey:"phase.topping",bgColor:"bg-orange-50",textColor:"text-orange-700",borderColor:"border-orange-200"},filling:{icon:"ğŸ‚",labelKey:"phase.filling",bgColor:"bg-rose-50",textColor:"text-rose-700",borderColor:"border-rose-200"},frosting:{icon:"ğŸ°",labelKey:"phase.frosting",bgColor:"bg-indigo-50",textColor:"text-indigo-700",borderColor:"border-indigo-200"},glaze:{icon:"ğŸ’§",labelKey:"phase.glaze",bgColor:"bg-cyan-50",textColor:"text-cyan-700",borderColor:"border-cyan-200"},other:{icon:"ğŸ“¦",labelKey:"ingredientCategory.other",bgColor:"bg-gray-50",textColor:"text-gray-700",borderColor:"border-gray-200"}},we=({title:e,icon:t,defaultOpen:a=!0,badge:s,badgeColor:r="bg-amber-100 text-amber-700",onReset:n,children:o})=>{const[i,l]=u.useState(a);return m.jsxs("div",{className:"border-b border-gray-200 last:border-b-0",children:[m.jsxs("div",{className:"flex items-center justify-between px-3 py-2 hover:bg-gray-50",children:[m.jsxs("button",{onClick:()=>l(!i),className:"flex-1 flex items-center gap-2 text-sm font-semibold text-gray-700 text-left",children:[t,m.jsx("span",{children:e}),s&&m.jsx("span",{className:`px-1.5 py-0.5 text-xs rounded ${r}`,children:s})]}),m.jsxs("div",{className:"flex items-center gap-1",children:[n&&m.jsx("button",{onClick:e=>{e.stopPropagation(),n()},className:"p-1 text-gray-400 hover:text-amber-600 hover:bg-amber-50 rounded transition-colors",title:"ì´ˆê¸°í™”",children:m.jsx(B,{className:"w-3.5 h-3.5"})}),m.jsx("button",{onClick:()=>l(!i),className:"p-1",children:i?m.jsx(q,{className:"w-4 h-4 text-gray-400"}):m.jsx(P,{className:"w-4 h-4 text-gray-400"})})]})]}),i&&m.jsx("div",{className:"px-3 pb-3",children:o})]})},Ce=()=>{var e,t,a,s,r;const{t:n}=h(),{translateIngredient:o,translateProcessStep:c,getLocalizedPanCategory:b,getLocalizedPanName:y,getLocalizedProductName:f}=j(),{addRecipe:S,updateRecipe:R,currentRecipe:L,recipes:P}=N(),{addToast:Z}=k(),{pan:Q,product:ee,method:te}=p(),ae=u.useMemo(()=>i(i(i(i({},be),ve),ee.breadVolumes),ee.customProducts.filter(e=>"bread"===e.category||"pastry"===e.category).reduce((e,t)=>l(i({},e),{[t.name]:t.specificVolume}),{})),[ee.breadVolumes,ee.customProducts]),se=u.useMemo(()=>{const e={};return Q.myPans.forEach(t=>{const a=t.category||"ê¸°íƒ€";e[a]||(e[a]=[]),e[a].push({name:t.name,volume:t.volume})}),0===Object.keys(e).length&&(e["ì‹ë¹µí‹€"]=[{name:"ê¸°ë³¸ ì‹ë¹µí‹€",volume:2350}]),e},[Q.myPans]),re=u.useMemo(()=>({flour:n("dashboard.flour"),liquid:n("dashboard.liquid"),wetOther:n("dashboard.fat"),other:n("dashboard.other")}),[n]),oe=u.useMemo(()=>({straight:n("method.straight"),sponge:n("method.sponge"),poolish:n("method.poolish"),biga:n("method.biga"),tangzhong:n("method.tangzhong"),autolyse:n("method.autolyse"),levain:n("method.levain"),coldFerment:n("method.coldFerment"),retard:n("method.retard")}),[n]),ie=u.useMemo(()=>Object.keys(se),[se]),de=ie[0]||"ì‹ë¹µí‹€",ce=(null==(t=null==(e=se[de])?void 0:e[0])?void 0:t.name)||"ì˜¥ìˆ˜ìˆ˜ ì‹ë¹µí‹€ (22.5cm)",me=(null==(s=null==(a=se[de])?void 0:a[0])?void 0:s.volume)||2350,he=u.useCallback(e=>e&&ie.includes(e)?e:de,[ie,de]),pe=u.useCallback((e,t)=>{var a;const s=se[e];if(s&&t){if(s.find(e=>e.name===t))return t}return(null==(a=null==s?void 0:s[0])?void 0:a.name)||ce},[se,ce]),{settings:xe,setSidebarWidth:Ce,setProcessPanelHeight:De,setProcessItemSize:Me,getProcessItemSize:$e,resetSettings:Se}=function(){const[e,t]=u.useState(()=>{if("undefined"!=typeof window)try{const e=localStorage.getItem(J);if(e){const t=JSON.parse(e);return i(i({},X),t)}}catch(e){}return X});u.useEffect(()=>{const t=setTimeout(()=>{try{localStorage.setItem(J,JSON.stringify(e))}catch(t){}},300);return()=>clearTimeout(t)},[e]);const a=u.useCallback(e=>{t(t=>l(i({},t),{sidebarWidth:Math.max(200,Math.min(500,e))}))},[]),s=u.useCallback(e=>{t(t=>l(i({},t),{recipeContainerHeight:Math.max(.3,Math.min(.8,e))}))},[]),r=u.useCallback(e=>{t(t=>l(i({},t),{processRowHeight:Math.max(28,Math.min(80,e))}))},[]),n=u.useCallback(e=>{t(t=>l(i({},t),{processPanelHeight:Math.max(120,Math.min(500,e))}))},[]),o=u.useCallback((e,a)=>{t(t=>{var s,r,n,o,d;return l(i({},t),{processItems:l(i({},t.processItems),{[e]:l(i({},t.processItems[e]),{width:null!=(n=null!=(r=a.width)?r:null==(s=t.processItems[e])?void 0:s.width)?n:120,minHeight:null!=(d=a.minHeight)?d:null==(o=t.processItems[e])?void 0:o.minHeight})})})})},[]),d=u.useCallback(t=>e.processItems[t]||{width:120},[e.processItems]),c=u.useCallback(()=>{t(X),localStorage.removeItem(J)},[]);return{settings:e,setSidebarWidth:a,setRecipeContainerHeight:s,setProcessRowHeight:r,setProcessPanelHeight:n,setProcessItemSize:o,getProcessItemSize:d,resetSettings:c}}(),[We,Te]=u.useState(n("advDashboard.defaultRecipeName")),[Re,Le]=u.useState("bread"),[Be,Ie]=u.useState({name:"",type:"personal",url:"",author:""}),Ae=me,qe=Math.round(Ae/3.4),[Pe,ze]=u.useState({mode:"pan",category:de,type:ce,quantity:1,panWeight:qe,divisionCount:1,divisionWeight:qe,unitCount:10,unitWeight:50}),[Oe,Ee]=u.useState([{id:"1",mode:"pan",category:de,type:ce,quantity:1,divisionCount:1,panWeight:qe,divisionWeight:qe,unitCount:10,unitWeight:50}]),[Fe,He]=u.useState("ì‚°í˜•ì‹ë¹µ"),[Ke,Ye]=u.useState("ì‚°í˜•ì‹ë¹µ"),[Ve,Ue]=u.useState({type:"convection",level:"",firstBake:{topTemp:200,bottomTemp:170,time:24},secondBake:{topTemp:0,bottomTemp:0,time:0}}),[_e,Je]=u.useState({type:"straight",flourRatio:0,waterRatio:0,yeastAdjustment:1,prefermentYeastRatio:0}),[Xe,Ge]=u.useState(!1),[Ze,Qe]=u.useState([{id:"1",order:1,category:"flour",subCategory:"ê°€ë£¨",name:"ê°•ë ¥ë¶„",ratio:100,amount:500,note:""},{id:"2",order:2,category:"liquid",subCategory:"ìˆ˜ë¶„",name:"ë¬¼",ratio:70,amount:350,note:""},{id:"3",order:3,category:"other",subCategory:"ê¸°íƒ€",name:"ì†Œê¸ˆ",ratio:2,amount:10,note:""},{id:"4",order:4,category:"other",subCategory:"ê¸°íƒ€",name:"ì´ìŠ¤íŠ¸",ratio:1,amount:5,note:""},{id:"5",order:5,category:"other",subCategory:"ê¸°íƒ€",name:"ì„¤íƒ•",ratio:6,amount:30,note:""},{id:"6",order:6,category:"wetOther",subCategory:"ìœ ì§€",name:"ë²„í„°",ratio:10,amount:50,note:""}]),[et,tt]=u.useState([{id:"1",order:1,description:"ì¬ë£Œ ê³„ëŸ‰",time:10},{id:"2",order:2,description:"1ì°¨ ë¯¹ì‹± (ì €ì† 3ë¶„ â†’ ì¤‘ì† 5ë¶„)",time:8},{id:"3",order:3,description:"1ì°¨ ë°œíš¨ (27Â°C, 75%)",time:60,temp:27},{id:"4",order:4,description:"ë¶„í•  ë° ë‘¥ê¸€ë¦¬ê¸°"},{id:"5",order:5,description:"ì¤‘ê°„ ë°œíš¨",time:15},{id:"6",order:6,description:"ì„±í˜• ë° íŒ¨ë‹"},{id:"7",order:7,description:"2ì°¨ ë°œíš¨ (35Â°C, 85%)",time:50,temp:35},{id:"8",order:8,description:"êµ½ê¸°",time:24,temp:200}]),[at,st]=u.useState(""),[rt,nt]=u.useState(null),[ot,it]=u.useState(i({},ue)),lt=u.useRef(null);u.useEffect(()=>{var e,t,a,s;if(L){const r=`${L.id}-${(null==(e=L.updatedAt)?void 0:e.toString())||""}`;if(r===lt.current)return;lt.current=r,Te(L.name||n("advDashboard.defaultRecipeName")),Le(L.productType||"bread"),L.source?Ie({name:L.source.name||"",type:L.source.type||"personal",url:L.source.url||"",author:L.source.author||""}):Ie({name:"",type:"personal",url:"",author:""});const o=[];if(L.phases&&Array.isArray(L.phases)&&L.phases.length>0){let e=1;L.phases.forEach(t=>{t.ingredients&&Array.isArray(t.ingredients)&&t.ingredients.forEach((a,s)=>{const r=a.category||"other";let n="other",i="ê¸°íƒ€";"flour"===r||a.isFlour?(n="flour",i="ê°€ë£¨"):"liquid"===r?(n="liquid",i="ìˆ˜ë¶„"):"fat"===r&&(n="wetOther",i="ìœ ì§€"),o.push({id:a.id||`${Date.now()}-${t.id}-${s}`,order:e++,category:n,subCategory:i,name:a.name||"",ratio:a.percentage||0,amount:parseFloat(a.amount)||0,note:a.note||"",moistureContent:a.moistureContent,phase:t.type||t.id||"main",phaseOrder:t.order||0})})})}else L.ingredients&&Array.isArray(L.ingredients)&&L.ingredients.forEach((e,t)=>{const a=e.category||e.type||"other";let s="other",r="ê¸°íƒ€";"flour"===a||e.isFlour?(s="flour",r="ê°€ë£¨"):"liquid"===a?(s="liquid",r="ìˆ˜ë¶„"):"fat"===a&&(s="wetOther",r="ìœ ì§€"),o.push({id:e.id||`${Date.now()}-${t}`,order:t+1,category:s,subCategory:r,name:e.name||"",ratio:e.percentage||0,amount:parseFloat(e.amount)||0,note:e.note||"",moistureContent:e.moistureContent,phase:e.phase||"main",phaseOrder:e.phaseOrder||0})});if(o.length>0&&Qe(o),L.steps&&Array.isArray(L.steps)){const e=L.steps.map((e,t)=>{var a,s;return{id:e.id||`${Date.now()}-${t}`,order:e.order||t+1,description:e.instruction||e.action||e.description||"",time:(null==(a=e.duration)?void 0:a.target)||e.time,temp:(null==(s=e.temperature)?void 0:s.target)||e.temp}});e.length>0&&tt(e)}if(L.ovenSettings){const e=L.ovenSettings,t=e.secondBake;Ue({type:"deck"===e.mode?"deck":"airfryer"===e.mode?"airfryer":"convection",level:e.deck||"",firstBake:{topTemp:e.temperature||200,bottomTemp:e.bottomTemperature||e.temperature||170,time:e.duration||24},secondBake:t?{topTemp:t.topTemp||0,bottomTemp:t.bottomTemp||0,time:t.time||0}:{topTemp:0,bottomTemp:0,time:0}})}if(L.method){const e=L.method;let r=e.method||e.type||"straight";"sourdough"===r&&(r="levain");["straight","sponge","poolish","biga","tangzhong","autolyse","levain","coldFerment","retard"].includes(r)||(r="straight");const n=null==(t=null==te?void 0:te.methods)?void 0:t[r],o=je[r]||{yeastAdjustment:1,prefermentYeastRatio:0};Je({type:r,flourRatio:e.prefermentRatio||0,waterRatio:e.waterRatio||0,yeastAdjustment:null!=(a=null==n?void 0:n.yeastAdjustment)?a:o.yeastAdjustment,prefermentYeastRatio:null!=(s=null==n?void 0:n.prefermentYeastRatio)?s:o.prefermentYeastRatio}),Ge("straight"!==r)}if(L.panConfig){const e=L.panConfig,t=e.name||e.category||de,a=he(t),s=e.type||ce,r=pe(a,s),n=e.quantity||1,o=e.mode||"pan";let d=e.panWeight;if(!d){let e=me;for(const[,a]of Object.entries(se)){const t=a.find(e=>e.name===r);if(t){e=t.volume;break}}const t=ae[Ke]||4.2;d=Math.round(e/t)}if(e.originalPan){const t=e.originalPan,a=Math.max(1,t.unitCount||10),s=Math.max(1,t.unitWeight||50),r=he(t.category),n=pe(r,t.type);let o=Math.abs(t.panWeight||500);"count"===t.mode&&(o=a*s),ze(l(i({},t),{category:r,type:n,panWeight:o,quantity:Math.max(1,Math.abs(t.quantity||1)),divisionCount:Math.max(1,t.divisionCount||1),divisionWeight:Math.abs(t.divisionWeight||o||500),unitCount:a,unitWeight:s}))}else ze(e=>l(i({},e),{mode:o,category:a,type:r,quantity:Math.max(1,n),panWeight:Math.abs(d||500),divisionWeight:Math.abs(d||500)}));if(e.pans&&Array.isArray(e.pans)&&e.pans.length>0){const t=e.pans.map(e=>{const t=Math.max(1,e.unitCount||10),a=Math.max(1,e.unitWeight||50),s=he(e.category),r=pe(s,e.type);let n=Math.abs(e.panWeight||500);return"count"===e.mode&&(n=t*a),l(i({},e),{category:s,type:r,panWeight:n,quantity:Math.max(1,Math.abs(e.quantity||1)),divisionCount:Math.max(1,e.divisionCount||1),divisionWeight:Math.abs(e.divisionWeight||n||500),unitCount:t,unitWeight:a})});Ee(t)}else Ee([{id:"1",mode:o,category:a,type:r,quantity:Math.max(1,n),divisionCount:1,panWeight:Math.abs(d||500),divisionWeight:Math.abs(d||500),unitCount:10,unitWeight:50}])}if(L.specificVolume){const e=L.specificVolume;e.original&&He(e.original),e.converted&&Ye(e.converted)}else if(L.tags&&Array.isArray(L.tags)){const e=L.tags.find(e=>void 0!==ae[e]);e&&(He(e),Ye(e))}if(L.multiplierConfig){const e=L.multiplierConfig;"number"==typeof e.multiplier&&ct(Math.max(.01,Math.abs(e.multiplier)||1)),"boolean"==typeof e.isPanLinked&&mt(e.isPanLinked)}L.notes&&st(L.notes),L.yieldStageSelection?it(i(i({},ue),L.yieldStageSelection)):it(i({},ue)),Z({type:"success",message:n("advDashboard.recipeLoaded",{name:L.name})})}},[L]);const[dt,ct]=u.useState(1),[ut,mt]=u.useState(!0),[ht,pt]=u.useState("1"),xt=u.useCallback(e=>{const t=e.trim().toLowerCase();if(!t)return null;let a=t.match(/^[xÃ—*]?\s*(\d+\.?\d*)\s*[xÃ—ë°°]?$/);if(a){const e=parseFloat(a[1]);if(!isNaN(e)&&e>0)return e}if(a=t.match(/^[/Ã·]\s*(\d+\.?\d*)$/),a){const e=parseFloat(a[1]);if(!isNaN(e)&&e>0)return 1/e}if(a=t.match(/^(\d+)\s*[/Ã·]\s*(\d+)$/),a){const e=parseFloat(a[1]),t=parseFloat(a[2]);if(!isNaN(e)&&!isNaN(t)&&t>0)return e/t}const s=parseFloat(t);return!isNaN(s)&&s>0?s:null},[]),gt=u.useCallback(e=>{pt(e)},[]),bt=u.useCallback(()=>{const e=xt(ht);if(null!==e){const t=Math.max(.01,Math.min(100,e));ct(Math.round(100*t)/100),pt(String(Math.round(100*t)/100))}else pt(String(dt))},[ht,dt,xt]),yt=u.useCallback(e=>{ct(e),pt(String(e))},[]),vt=u.useMemo(()=>Ze.filter(e=>"flour"===e.category).reduce((e,t)=>e+t.amount,0),[Ze]),ft=u.useMemo(()=>Ze.filter(e=>"liquid"===e.category).reduce((e,t)=>e+t.amount,0),[Ze]),jt=u.useMemo(()=>Ze.filter(e=>"wetOther"===e.category&&e.moistureContent).reduce((e,t)=>e+t.amount*(t.moistureContent||0),0),[Ze]),Nt=u.useMemo(()=>Ze.reduce((e,t)=>e+t.amount,0),[Ze]),kt=u.useMemo(()=>{const e={tangzhong:0,preferment:1,poolish:1,biga:1,sponge:1,levain:1,autolyse:2,main:10,topping:20,filling:21,frosting:22,glaze:23,other:99},t={flour:0,liquid:1,wetOther:2,other:3},a=Ze.reduce((e,t)=>{const a=t.phase||"main";return e[a]||(e[a]=[]),e[a].push(t),e},{});return Object.entries(a).sort(([t],[a])=>{var s,r;return(null!=(s=e[t])?s:50)-(null!=(r=e[a])?r:50)}).map(([e,a])=>({phase:e,items:a.sort((e,a)=>{var s,r;return(null!=(s=t[e.category])?s:99)-(null!=(r=t[a.category])?r:99)})}))},[Ze]),wt=kt.length>1,Ct=u.useMemo(()=>0===vt?0:Math.round((ft+jt)/vt*1e3)/10,[vt,ft,jt]),Dt=u.useMemo(()=>{if("count"===Pe.mode)return Math.max((Pe.unitCount||10)*(Pe.unitWeight||50),1);const e=Math.abs(Pe.panWeight||500),t=Math.max(1,Math.abs(Pe.quantity||1));return Math.max(e*t,1)},[Pe.panWeight,Pe.quantity,Pe.mode,Pe.unitCount,Pe.unitWeight]),Mt=u.useMemo(()=>{const e=Oe.reduce((e,t)=>{if("count"===t.mode)return e+(t.unitCount||10)*(t.unitWeight||50);return e+Math.abs(t.panWeight||0)*Math.abs(t.quantity||1)},0);return Math.max(e,0)},[Oe]),$t=u.useMemo(()=>{const e=Math.abs(Dt)||1,t=Math.abs(Mt)||1;if(0===e)return 1;const a=t/e;return Math.max(.01,Math.round(100*a)/100)},[Mt,Dt]),St=ut?$t:dt;u.useEffect(()=>{Ee(e=>e.map(e=>{var t;if("count"===e.mode)return e;const a=null==(t=se[e.category])?void 0:t.find(t=>t.name===e.type);if(a){const t=Math.round(a.volume/(ae[Ke]||3.4));return l(i({},e),{panWeight:t,divisionWeight:Math.round(t/e.divisionCount)})}return e}))},[Ke]),u.useEffect(()=>{var e;if("count"===Pe.mode)return;const t=null==(e=se[Pe.category])?void 0:e.find(e=>e.name===Pe.type);if(t){const e=Math.round(t.volume/(ae[Fe]||3.4));ze(t=>l(i({},t),{panWeight:e,divisionWeight:Math.round(e/t.divisionCount)}))}},[Fe,Pe.mode,Pe.category,Pe.type]),u.useEffect(()=>{Ee(e=>e.map(e=>{var t;if(e.mode===Pe.mode)return e;const a=l(i({},e),{mode:Pe.mode});if("count"===Pe.mode)a.panWeight=(a.unitCount||10)*(a.unitWeight||50),a.divisionCount=1,a.divisionWeight=a.panWeight;else{const e=null==(t=se[a.category])?void 0:t.find(e=>e.name===a.type);e&&(a.panWeight=Math.round(e.volume/(ae[Ke]||3.4)),a.divisionWeight=Math.round(a.panWeight/a.divisionCount))}return a}))},[Pe.mode,Ke]),u.useEffect(()=>{if("bread"===Re){const e=Object.keys(be);e.includes(Fe)||He(e[0]||"ì‚°í˜•ì‹ë¹µ"),e.includes(Ke)||Ye(e[0]||"ì‚°í˜•ì‹ë¹µ")}else{const e=Object.keys(ye);e.includes(Fe)||He(e[0]||"íŒŒìš´ë“œì¼€ì´í¬"),e.includes(Ke)||Ye(e[0]||"íŒŒìš´ë“œì¼€ì´í¬")}},[Re]);const Wt=u.useMemo(()=>Math.round(Nt*St),[Nt,St]),Tt=u.useMemo(()=>0===Wt?0:Math.round(Mt/Wt*1e3)/10,[Mt,Wt]),Rt=u.useMemo(()=>Ze.map(e=>l(i({},e),{convertedAmount:Math.round(e.amount*St*10)/10})),[Ze,St]),Lt=u.useMemo(()=>{var e,t;if(!Xe||"straight"===_e.type)return[];const a=[],s=Ze.filter(e=>"flour"===e.category);if(0===s.length)return[];s.forEach(e=>{const t=Math.round(e.amount*_e.flourRatio*St*10)/10;t>0&&a.push({id:`pref-${e.id}`,name:e.name,category:"flour",convertedAmount:t})});const r=s.reduce((e,t)=>e+t.amount,0)*_e.flourRatio,n=Math.round(r*_e.waterRatio*St*10)/10;n>0&&a.push({id:"pref-water",name:"ë¬¼",category:"liquid",convertedAmount:n});const o=Ze.filter(e=>e.name.includes("ì´ìŠ¤íŠ¸")).reduce((e,t)=>e+t.amount,0),i=null!=(e=_e.prefermentYeastRatio)?e:0;if(o>0&&i>0){const e=Ze.find(e=>e.name.includes("ì´ìŠ¤íŠ¸")),s=o*(null!=(t=_e.yeastAdjustment)?t:1)*i;a.push({id:"pref-yeast",name:(null==e?void 0:e.name)||"ì¸ìŠ¤í„´íŠ¸ ë“œë¼ì´ì´ìŠ¤íŠ¸",category:"other",convertedAmount:Math.round(s*St*10)/10})}return a},[Ze,_e,Xe,St]),Bt=u.useMemo(()=>{var e,t;if(!Xe||"straight"===_e.type)return Rt;const a=[],s=Ze.filter(e=>"flour"===e.category).reduce((e,t)=>e+t.amount,0),r=Ze.filter(e=>"liquid"===e.category&&"ë¬¼"===e.name).reduce((e,t)=>e+t.amount,0),n=Ze.filter(e=>e.name.includes("ì´ìŠ¤íŠ¸")).reduce((e,t)=>e+t.amount,0),o=s*_e.flourRatio*_e.waterRatio,d=n*(null!=(e=_e.yeastAdjustment)?e:1),c=d*(null!=(t=_e.prefermentYeastRatio)?t:0);Ze.filter(e=>"flour"===e.category).forEach(e=>{const t=e.amount*_e.flourRatio,s=Math.round(10*(e.amount-t))/10;s>0&&a.push({id:`main-${e.id}`,name:e.name,category:"flour",amount:s,convertedAmount:Math.round(s*St*10)/10})});const u=Math.round(10*(r-Math.min(r,o)))/10;u>0&&a.push({id:"main-water",name:"ë¬¼",category:"liquid",amount:u,convertedAmount:Math.round(u*St*10)/10}),Ze.filter(e=>"liquid"===e.category&&"ë¬¼"!==e.name).forEach(e=>{a.push(l(i({},e),{id:`main-${e.id}`,convertedAmount:Math.round(e.amount*St*10)/10}))}),Ze.filter(e=>!("flour"===e.category||"liquid"===e.category&&"ë¬¼"===e.name||e.name.includes("ì´ìŠ¤íŠ¸"))).filter(e=>"liquid"!==e.category).forEach(e=>{a.push(l(i({},e),{id:`main-${e.id}`,convertedAmount:Math.round(e.amount*St*10)/10}))});const m=Math.round(10*(d-c))/10;if(m>0){const e=Ze.find(e=>e.name.includes("ì´ìŠ¤íŠ¸"));a.push({id:"main-yeast",name:(null==e?void 0:e.name)||"ì¸ìŠ¤í„´íŠ¸ ë“œë¼ì´ì´ìŠ¤íŠ¸",category:"other",amount:m,convertedAmount:Math.round(m*St*10)/10})}return a},[Ze,_e,Xe,St,Rt]),It=u.useMemo(()=>Lt.reduce((e,t)=>e+(t.convertedAmount||0),0),[Lt]),At=u.useMemo(()=>Bt.reduce((e,t)=>e+(t.convertedAmount||0),0),[Bt]),qt=u.useMemo(()=>{const e=["tangzhong","poolish","biga","sponge","levain","autolyse","preferment"],t=Ze.find(t=>t.phase&&e.includes(t.phase));return(null==t?void 0:t.phase)||"straight"},[Ze]),Pt=u.useMemo(()=>{const e=new Set(Ze.map(e=>e.phase||"main"));return e.size>1||1===e.size&&!e.has("main")},[Ze]),zt=qt===_e.type||"straight"===qt&&"straight"===_e.type,Ot=u.useMemo(()=>{const e={tangzhong:0,preferment:1,poolish:1,biga:1,sponge:1,levain:1,autolyse:2,main:10,topping:20,filling:21,frosting:22,glaze:23,other:99},t={flour:0,liquid:1,wetOther:2,other:3};if(Pt&&!Xe){const a=Rt.reduce((e,t)=>{const a=t.phase||"main";return e[a]||(e[a]=[]),e[a].push(t),e},{});return Object.entries(a).sort(([t],[a])=>{var s,r;return(null!=(s=e[t])?s:50)-(null!=(r=e[a])?r:50)}).map(([e,a])=>({phase:e,items:a.sort((e,a)=>{var s,r;return(null!=(s=t[e.category])?s:99)-(null!=(r=t[a.category])?r:99)})}))}if(!Xe||"straight"===_e.type){const e=[];Rt.filter(e=>"flour"===e.category).forEach(t=>{t.convertedAmount>0&&e.push({id:`straight-${t.id}`,name:t.name,category:"flour",convertedAmount:Math.round(10*t.convertedAmount)/10})});[...new Set(Rt.filter(e=>"liquid"===e.category).map(e=>e.name))].forEach(t=>{const a=Rt.filter(e=>"liquid"===e.category&&e.name===t).reduce((e,t)=>e+t.convertedAmount,0);a>0&&e.push({id:`straight-${t}`,name:t,category:"liquid",convertedAmount:Math.round(10*a)/10})});return[...new Set(Rt.filter(e=>"flour"!==e.category&&"liquid"!==e.category).map(e=>e.name))].forEach(t=>{var a;const s=Rt.filter(e=>e.name===t&&"flour"!==e.category&&"liquid"!==e.category),r=s.reduce((e,t)=>e+t.convertedAmount,0);r>0&&e.push({id:`straight-${t}`,name:t,category:(null==(a=s[0])?void 0:a.category)||"other",convertedAmount:Math.round(10*r)/10})}),e.sort((e,a)=>{var s,r;return(null!=(s=t[e.category])?s:99)-(null!=(r=t[a.category])?r:99)}),[{phase:"main",items:e}]}if(zt&&"straight"!==qt){const a=Rt.reduce((e,t)=>{const a=t.phase||"main";return e[a]||(e[a]=[]),e[a].push(t),e},{});return Object.entries(a).sort(([t],[a])=>{var s,r;return(null!=(s=e[t])?s:50)-(null!=(r=e[a])?r:50)}).map(([e,a])=>({phase:e,items:a.sort((e,a)=>{var s,r;return(null!=(s=t[e.category])?s:99)-(null!=(r=t[a.category])?r:99)})}))}const a=[];if(Lt.length>0){const e=[...Lt].sort((e,a)=>{var s,r;return(null!=(s=t[e.category])?s:99)-(null!=(r=t[a.category])?r:99)});a.push({phase:_e.type,items:e.map(e=>l(i({},e),{phase:_e.type}))})}const s=Bt.filter(e=>(e.convertedAmount||0)>0);if(s.length>0){const e=s.sort((e,a)=>{var s,r;return(null!=(s=t[e.category])?s:99)-(null!=(r=t[a.category])?r:99)});a.push({phase:"main",items:e.map(e=>l(i({},e),{phase:"main"}))})}return a},[Rt,Lt,Bt,Xe,_e.type,zt,qt,Pt]),Et=Ot.length>1,Ft=u.useMemo(()=>(e=>{const t=Math.max(e,6);return{rowHeight:t>15?"py-0.5":"py-1",fontSize:t>20||t>15?"text-xs":"text-sm"}})(Ze.length),[Ze.length]);u.useMemo(()=>({id:(null==L?void 0:L.id)||"temp",name:We,ingredients:Ze.map(e=>({id:e.id,name:e.name,category:"wetOther"===e.category?"fat":e.category,amount:e.amount,unit:"g",bakersPercentage:e.ratio,isFlour:"flour"===e.category})),phases:null==L?void 0:L.phases}),[L,We,Ze]);const Ht=u.useCallback(e=>{var t,a,s;const r=fe[e]||{flour:0,water:0},n=null==(t=null==te?void 0:te.methods)?void 0:t[e],o=je[e]||{yeastAdjustment:1,prefermentYeastRatio:0},i=null!=(a=null==n?void 0:n.yeastAdjustment)?a:o.yeastAdjustment,l=null!=(s=null==n?void 0:n.prefermentYeastRatio)?s:o.prefermentYeastRatio;Je({type:e,flourRatio:r.flour,waterRatio:r.water,yeastAdjustment:i,prefermentYeastRatio:l}),Ge("straight"!==e)},[te]),Kt=u.useCallback((e,t)=>{ze(a=>{var s,r;const n=l(i({},a),{[e]:t});if("mode"===e)if("count"===t)n.panWeight=(n.unitCount||10)*(n.unitWeight||50);else{const e=null==(s=se[n.category])?void 0:s.find(e=>e.name===n.type);e&&(n.panWeight=Math.round(e.volume/(ae[Fe]||3.4)))}if("type"===e&&"pan"===n.mode){const e=null==(r=se[n.category])?void 0:r.find(e=>e.name===t);e&&(n.panWeight=Math.round(e.volume/(ae[Fe]||3.4)))}if("category"===e&&"pan"===n.mode){const e=se[t];(null==e?void 0:e.length)>0&&(n.type=e[0].name,n.panWeight=Math.round(e[0].volume/(ae[Fe]||3.4)))}return"count"!==n.mode||"unitCount"!==e&&"unitWeight"!==e||(n.panWeight=(n.unitCount||0)*(n.unitWeight||0)),"pan"===n.mode&&n.divisionCount>0&&(n.divisionWeight=Math.round(n.panWeight/n.divisionCount)),n})},[Fe]),Yt=u.useCallback(()=>{var e,t;const a=(null==(t=null==(e=se[de])?void 0:e[0])?void 0:t.volume)||2350,s=Math.round(a/(ae[Ke]||3.4));Ee(e=>[...e,{id:Date.now().toString(),mode:"pan",category:de,type:ce,quantity:1,divisionCount:1,panWeight:s,divisionWeight:s,unitCount:10,unitWeight:50}])},[Ke,de,ce,se]),Vt=u.useCallback(e=>{Ee(t=>t.length>1?t.filter(t=>t.id!==e):t)},[]),Ut=u.useCallback(()=>{Ee([{id:"1",mode:Pe.mode,category:Pe.category,type:Pe.type,quantity:Pe.quantity,divisionCount:Pe.divisionCount,panWeight:Pe.panWeight,divisionWeight:Pe.divisionWeight,unitCount:Pe.unitCount,unitWeight:Pe.unitWeight}]),mt(!0)},[Pe]),_t=u.useCallback(()=>{Ye(Fe)},[Fe]),Jt=u.useCallback(()=>{Ue({type:"convection",level:"",firstBake:{topTemp:200,bottomTemp:170,time:24},secondBake:{topTemp:0,bottomTemp:0,time:0}})},[]),Xt=u.useCallback(()=>{Ut(),_t(),Jt(),ct(1)},[Ut,_t,Jt]),Gt=u.useCallback(e=>{var t,a,s,r;const o=Ze.map((e,t)=>({id:e.id||`ing-${Date.now()}-${t}`,name:e.name,amount:e.amount,percentage:e.ratio,unit:"g",category:"flour"===e.category?"flour":"liquid"===e.category?"liquid":"wetOther"===e.category?"fat":"other",isFlour:"flour"===e.category,note:e.note||"",moistureContent:e.moistureContent,phase:e.phase||"main"})),d=et.map((e,t)=>({id:e.id||`step-${Date.now()}-${t}`,order:e.order||t+1,instruction:e.description,time:e.time,temp:e.temp})),c={temperature:Ve.firstBake.topTemp,bottomTemperature:Ve.firstBake.bottomTemp,mode:"deck"===Ve.type?"deck":"airfryer"===Ve.type?"airfryer":"conventional",preheating:!0,deck:Ve.level||"middle",duration:Ve.firstBake.time,secondBake:Ve.secondBake.time>0?{topTemp:Ve.secondBake.topTemp,bottomTemp:Ve.secondBake.bottomTemp,time:Ve.secondBake.time}:null},u={name:We||n("advDashboard.defaultRecipeName"),nameKo:We,productType:Re,category:"bread",difficulty:"intermediate",servings:Oe.reduce((e,t)=>e+t.quantity,0),prepTime:30,totalTime:60+Ve.firstBake.time+Ve.secondBake.time,ingredients:o,steps:d,ovenSettings:c,method:{method:_e.type,prefermentRatio:_e.flourRatio,waterRatio:_e.waterRatio},panConfig:{type:(null==(t=Oe[0])?void 0:t.type)||ce,name:(null==(a=Oe[0])?void 0:a.category)||de,quantity:Oe.reduce((e,t)=>e+t.quantity,0),panWeight:null==(s=Oe[0])?void 0:s.panWeight,mode:(null==(r=Oe[0])?void 0:r.mode)||"pan",originalPan:Pe,pans:Oe},specificVolume:{original:Fe,converted:Ke},multiplierConfig:{multiplier:dt,isPanLinked:ut},source:Be.name?{name:Be.name,type:Be.type,url:Be.url||void 0,author:Be.author||void 0}:void 0,tags:[Ke,oe[_e.type]].filter(Boolean),notes:at,yieldStageSelection:ot,updatedAt:new Date},m=e||(null==L?void 0:L.id);if(m)R(m,u),Z({type:"success",message:n("advDashboard.recipeUpdated",{name:We})});else{const e=l(i({},u),{id:`recipe-${Date.now()}`,createdAt:new Date});S(e),Z({type:"success",message:n("advDashboard.recipeSaved",{name:We})})}},[We,Be,Oe,Ve,Xe,Bt,Rt,et,at,Ke,_e,ot,L,S,R,Z]),Zt=u.useCallback(()=>{const e=(We||n("advDashboard.defaultRecipeName")).trim(),t=P.find(t=>{var a;return(null==(a=t.name)?void 0:a.trim())===e&&t.id!==(null==L?void 0:L.id)});if(t){window.confirm(n("advDashboard.duplicateRecipeConfirm",{name:e}))&&Gt(t.id)}else Gt()},[We,P,null==L?void 0:L.id,Gt]),Qt=u.useCallback(()=>{const e={name:We,source:Be.name?Be:void 0,exportedAt:(new Date).toISOString(),version:"1.0",settings:{multiplier:St,originalTotal:Nt,convertedTotal:Wt,panSettings:{original:Pe,converted:Oe},oven:Ve,method:_e,specificVolume:{original:Fe,converted:Ke}},originalIngredients:Ze.map(e=>({name:e.name,category:e.category,amount:e.amount,ratio:e.ratio})),convertedIngredients:(Xe?Bt:Rt).map(e=>({name:e.name,category:e.category,amount:e.convertedAmount})),prefermentIngredients:Xe?Lt.map(e=>({name:e.name,amount:e.convertedAmount})):[],processes:et.map(e=>({description:e.description,time:e.time,temp:e.temp})),memo:at},t=new Blob([JSON.stringify(e,null,2)],{type:"application/json"}),a=URL.createObjectURL(t),s=document.createElement("a");s.href=a,s.download=`${We||"recipe"}_${(new Date).toISOString().slice(0,10)}.json`,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(a),Z({type:"success",message:n("advDashboard.recipeExported")})},[We,Be,St,Nt,Wt,Pe,Oe,Ve,_e,Fe,Ke,Ze,Xe,Bt,Rt,Lt,et,at,Z]),ea=u.useCallback(()=>d(void 0,null,function*(){const e={flour:n("ingredientCategory.flour"),liquid:n("ingredientCategory.liquid"),yeast:n("ingredientCategory.yeast"),fat:n("ingredientCategory.fat"),sugar:n("ingredientCategory.sugar"),dairy:n("ingredientCategory.dairy"),egg:n("ingredientCategory.egg"),salt:n("ingredientCategory.salt"),other:n("ingredientCategory.other")},t=Xe?Bt:Rt;let a=`ğŸ ${We}\n`;a+=`${"â”€".repeat(30)}\n\n`,a+=`ğŸ“Š ${n("advDashboard.basicInfo")}\n`,a+=`â€¢ ${n("advDashboard.multiplier")}: Ã—${St}\n`,a+=`â€¢ ${n("advDashboard.original")}: ${Nt}g â†’ ${n("advDashboard.converted")}: ${Wt}g\n`,a+=`â€¢ ${n("advDashboard.pan")}: ${Oe.map(e=>`${e.type} ${e.quantity}`).join(", ")}\n`,a+=`â€¢ ${n("advDashboard.method")}: ${oe[_e.type]}\n\n`,Xe&&Lt.length>0&&(a+=`ğŸ¥£ ${n("advDashboard.prefermentIngredients")} (${oe[_e.type]})\n`,Lt.forEach(e=>{a+=`â€¢ ${o(e.name)}: ${e.convertedAmount}g\n`}),a+="\n"),a+=Xe?`ğŸ ${n("advDashboard.mainDoughIngredients")}\n`:`ğŸ ${n("advDashboard.ingredients")}\n`;[...new Set(t.map(e=>e.category))].forEach(s=>{const r=t.filter(e=>e.category===s);r.length>0&&(a+=`[${e[s]||s}]\n`,r.forEach(e=>{a+=`â€¢ ${o(e.name)}: ${e.convertedAmount}g\n`}))}),a+="\n",a+=`ğŸ”¥ ${n("advDashboard.ovenSettings")}\n`;const s=n(`advDashboard.ovenTypes.${Ve.type}`);"deck"===Ve.type?a+=`â€¢ ${s}: ${n("advDashboard.topHeat")} ${Ve.firstBake.topTemp}Â°C / ${n("advDashboard.bottomHeat")} ${Ve.firstBake.bottomTemp}Â°C, ${Ve.firstBake.time}${n("units.minute")}\n`:a+=`â€¢ ${s}: ${Ve.firstBake.topTemp}Â°C, ${Ve.firstBake.time}${n("units.minute")}\n`,Ve.secondBake.time>0&&(a+=`â€¢ ${n("advDashboard.secondBake")}: ${Ve.secondBake.topTemp}Â°C, ${Ve.secondBake.time}${n("units.minute")}\n`),a+="\n",a+=`ğŸ“ ${n("advDashboard.processSteps")}\n`,et.forEach((e,t)=>{let s=`${t+1}. ${c(e.description)}`;e.time&&(s+=` (${e.time}${n("units.minute")})`),e.temp&&(s+=` [${e.temp}Â°C]`),a+=`${s}\n`}),at&&(a+=`\nğŸ“Œ ${n("advDashboard.memo")}\n${at}\n`),a+=`\n${"â”€".repeat(30)}\n`,a+=`${n("advDashboard.createdDate")}: ${(new Date).toLocaleDateString()}\n`;try{yield navigator.clipboard.writeText(a),Z({type:"success",message:n("advDashboard.recipeCopied")})}catch(r){const e=new Blob([a],{type:"text/plain;charset=utf-8"}),t=URL.createObjectURL(e),s=document.createElement("a");s.href=t,s.download=`${We||"recipe"}_${(new Date).toISOString().slice(0,10)}.txt`,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(t),Z({type:"success",message:n("advDashboard.recipeSavedAsText")})}}),[We,St,Nt,Wt,Oe,_e,Xe,Lt,Bt,Rt,Ve,et,at,Z,o,c,n]),ta=u.useCallback((e,t,a)=>{Ee(s=>s.map(s=>{var r,n;if(s.id!==e)return s;const o=l(i({},s),{[t]:a});if("mode"===t)if("count"===a)o.panWeight=(o.unitCount||10)*(o.unitWeight||50),o.divisionCount=1,o.divisionWeight=o.panWeight;else{const e=null==(r=se[o.category])?void 0:r.find(e=>e.name===o.type);e&&(o.panWeight=Math.round(e.volume/(ae[Ke]||3.4)))}if("type"===t&&"pan"===o.mode){const e=null==(n=se[o.category])?void 0:n.find(e=>e.name===a);e&&(o.panWeight=Math.round(e.volume/(ae[Ke]||3.4)))}if("category"===t&&"pan"===o.mode){const e=se[a];(null==e?void 0:e.length)>0&&(o.type=e[0].name,o.panWeight=Math.round(e[0].volume/(ae[Ke]||3.4)))}return"count"!==o.mode||"unitCount"!==t&&"unitWeight"!==t||(o.panWeight=(o.unitCount||0)*(o.unitWeight||0),o.divisionWeight=o.panWeight),"pan"===o.mode&&o.divisionCount>0&&(o.divisionWeight=Math.round(o.panWeight/o.divisionCount)),o}))},[Ke]),[aa,sa]=u.useState(!1),[ra,na]=u.useState("table"),oa=u.useCallback(()=>{const e=Math.max(...Ze.map(e=>e.order),0)+1;Qe(t=>[...t,{id:`${Date.now()}-${Math.random().toString(36).substr(2,9)}`,order:e,category:"other",subCategory:"ê¸°íƒ€",name:"",ratio:0,amount:0,note:""}])},[Ze]),ia=u.useCallback(e=>{const t=Math.max(...Ze.map(e=>e.order),0)+1,a=e.map((e,a)=>({id:`bulk-${Date.now()}-${a}`,order:t+a,category:e.category,subCategory:"",name:e.name,ratio:0,amount:e.amount,note:""}));Qe(e=>[...e,...a]),Z({type:"success",message:n("advDashboard.ingredientsAdded",{count:a.length})})},[Ze,Z]),la=u.useCallback(e=>{Qe(t=>t.filter(t=>t.id!==e))},[]),da=u.useCallback((e,t,a)=>{Qe(s=>s.map(r=>{if(r.id!==e)return r;const n=l(i({},r),{[t]:a});if("category"===t&&(n.subCategory=re[a]||"ê¸°íƒ€"),"amount"===t){const t=s.filter(e=>"flour"===e.category).reduce((t,s)=>t+(s.id===e?a:s.amount),0);t>0&&"flour"!==r.category&&(n.ratio=Math.round(a/t*1e3)/10)}return n}))},[]),ca=u.useCallback(()=>{const e=Math.max(...et.map(e=>e.order),0)+1;tt(t=>[...t,{id:Date.now().toString(),order:e,description:""}])},[et]),ua=u.useCallback(e=>{tt(t=>t.filter(t=>t.id!==e))},[]),ma=u.useCallback((e,t,a)=>{tt(s=>s.map(s=>s.id===e?l(i({},s),{[t]:a}):s))},[]),ha=u.useCallback((e,t)=>{tt(a=>{const s=a.findIndex(t=>t.id===e);if(-1===s)return a;if("up"===t&&0===s)return a;if("down"===t&&s===a.length-1)return a;const r=[...a],n="up"===t?s-1:s+1;return[r[s],r[n]]=[r[n],r[s]],r.map((e,t)=>l(i({},e),{order:t+1}))})},[]);return m.jsxs("div",{className:"h-screen flex flex-col bg-gray-100 text-sm",children:[m.jsxs("div",{className:"bg-white border-b shadow-sm px-4 py-2 flex items-center justify-between gap-4 flex-shrink-0",children:[m.jsxs("div",{className:"flex items-center gap-3",children:[m.jsx(z,{className:"w-5 h-5 text-amber-600"}),m.jsx("input",{type:"text",value:We,onChange:e=>Te(e.target.value),className:"text-lg font-bold w-36 border-b border-transparent hover:border-gray-300 focus:border-amber-500 focus:outline-none",placeholder:n("advDashboard.productName")}),m.jsxs("div",{className:"flex items-center gap-1 border-l pl-3",children:[m.jsx("button",{onClick:()=>Le("bread"),className:"px-3 py-1 text-xs rounded-l "+("bread"===Re?"bg-amber-500 text-white font-medium":"bg-gray-100 text-gray-600 hover:bg-gray-200"),title:n("advDashboard.productTypeBread"),children:n("advDashboard.productTypeBread")}),m.jsx("button",{onClick:()=>Le("pastry"),className:"px-3 py-1 text-xs rounded-r "+("pastry"===Re?"bg-amber-500 text-white font-medium":"bg-gray-100 text-gray-600 hover:bg-gray-200"),title:n("advDashboard.productTypePastry"),children:n("advDashboard.productTypePastry")})]}),m.jsxs("div",{className:"flex items-center gap-1 text-xs border-l pl-3",children:[m.jsxs("select",{value:Be.type,onChange:e=>Ie(l(i({},Be),{type:e.target.value})),className:"bg-gray-50 border border-gray-200 rounded px-1.5 py-1 text-xs focus:outline-none focus:border-amber-400",title:n("advDashboard.sourceType"),children:[m.jsxs("option",{value:"youtube",children:["ğŸ“º ",n("advDashboard.sourceTypes.youtube")]}),m.jsxs("option",{value:"blog",children:["ğŸŒ ",n("advDashboard.sourceTypes.blog")]}),m.jsxs("option",{value:"book",children:["ğŸ“– ",n("advDashboard.sourceTypes.book")]}),m.jsxs("option",{value:"website",children:["ğŸ”— ",n("advDashboard.sourceTypes.website")]}),m.jsxs("option",{value:"personal",children:["ğŸ‘¤ ",n("advDashboard.sourceTypes.personal")]}),m.jsxs("option",{value:"school",children:["ğŸ“ ",n("advDashboard.sourceTypes.school")]}),m.jsxs("option",{value:"other",children:["ğŸ“Œ ",n("advDashboard.sourceTypes.other")]})]}),m.jsx("input",{type:"text",value:Be.name,onChange:e=>Ie(l(i({},Be),{name:e.target.value})),className:"w-24 bg-gray-50 border border-gray-200 rounded px-2 py-1 text-xs focus:outline-none focus:border-amber-400",placeholder:n("advDashboard.sourceName"),title:n("advDashboard.sourceNamePlaceholder")})]})]}),m.jsxs("div",{className:"flex items-center gap-3",children:[m.jsxs("button",{onClick:()=>mt(!ut),className:"p-1.5 rounded flex items-center gap-1 "+(ut?"bg-green-100 text-green-600":"bg-gray-100 text-gray-400"),title:n(ut?"advDashboard.multiplierLinked":"advDashboard.multiplierUnlinked"),children:[ut?m.jsx(K,{className:"w-4 h-4"}):m.jsx(_,{className:"w-4 h-4"}),m.jsx("span",{className:"text-xs",children:n(ut?"advDashboard.auto":"advDashboard.manual")})]}),m.jsxs("span",{className:"text-xs text-gray-500",children:[n("advDashboard.multiplier"),":"]}),ut?m.jsx("div",{className:"flex items-center border border-green-300 rounded overflow-hidden bg-green-50",children:m.jsxs("div",{className:"px-4 py-1 font-bold text-sm text-green-700 w-20 text-center",children:["Ã—",St]})}):m.jsxs("div",{className:"flex items-center border rounded overflow-hidden bg-white",children:[m.jsx("button",{onClick:()=>yt(Math.max(.1,dt-.5)),className:"px-2 py-1 hover:bg-gray-100 border-r",children:m.jsx(V,{className:"w-4 h-4"})}),m.jsx("input",{type:"text",value:ht,onChange:e=>gt(e.target.value),onBlur:bt,onKeyDown:e=>"Enter"===e.key&&bt(),className:"w-20 text-center py-1 font-bold text-sm",placeholder:n("advDashboard.multiplierPlaceholder"),title:n("advDashboard.multiplierHint")}),m.jsx("button",{onClick:()=>yt(Math.min(20,dt+.5)),className:"px-2 py-1 hover:bg-gray-100 border-l",children:m.jsx(w,{className:"w-4 h-4"})})]}),!ut&&m.jsx("div",{className:"flex gap-1 flex-wrap",children:[.25,.5,1,1.5,2,2.5,3,4,5].map(e=>m.jsx("button",{onClick:()=>yt(e),className:"px-1.5 py-0.5 text-xs rounded transition-colors "+(dt===e?"bg-amber-500 text-white":"bg-gray-100 hover:bg-gray-200 text-gray-700"),children:e<1?`1/${Math.round(1/e)}`:`Ã—${e}`},e))})]}),m.jsxs("div",{className:"flex items-center gap-4",children:[m.jsxs("div",{className:"flex items-center gap-3 text-xs text-gray-500 bg-gray-50 px-3 py-1.5 rounded",children:[m.jsxs("span",{children:[n("advDashboard.original"),":",m.jsxs("b",{className:"text-gray-700 ml-1",children:[Nt,"g"]})]}),m.jsx("span",{className:"text-gray-300",children:"â†’"}),m.jsxs("span",{children:[n("advDashboard.converted"),":",m.jsxs("b",{className:"text-blue-600 ml-1",children:[Wt,"g"]})]}),m.jsx("span",{className:"text-gray-300",children:"|"}),m.jsxs("span",{children:[n("advDashboard.hydration"),":",m.jsxs("b",{className:"ml-1",children:[Ct,"%"]})]}),m.jsx("span",{className:"text-gray-300",children:"|"}),m.jsxs("span",{children:[n("advDashboard.pan"),":",m.jsxs("b",{className:"ml-1",children:[Mt,"g"]})]}),m.jsx("span",{className:"text-gray-300",children:"|"}),m.jsxs("span",{children:[n("advDashboard.lossRate"),":",m.jsxs("b",{className:"ml-1 "+(Tt>100?"text-red-500":Tt<95?"text-orange-500":"text-green-600"),children:[Tt,"%"]})]})]}),m.jsxs("div",{className:"flex gap-1.5",children:[m.jsxs("button",{onClick:Xt,className:"flex items-center gap-1 px-3 py-1.5 text-xs bg-gray-100 text-gray-600 rounded hover:bg-gray-200 border border-gray-300",title:n("advDashboard.resetConversion"),children:[m.jsx(B,{className:"w-4 h-4"}),n("advDashboard.reset")]}),m.jsxs("button",{onClick:Zt,className:"flex items-center gap-1 px-3 py-1.5 text-xs bg-amber-500 text-white rounded hover:bg-amber-600",title:n("advDashboard.saveRecipe"),children:[m.jsx(C,{className:"w-4 h-4"}),n("advDashboard.save")]}),m.jsxs("button",{onClick:ea,className:"flex items-center gap-1 px-3 py-1.5 text-xs bg-blue-500 text-white rounded hover:bg-blue-600",title:n("advDashboard.copyAsText"),children:[m.jsx(I,{className:"w-4 h-4"}),n("advDashboard.copy")]}),m.jsxs("button",{onClick:Qt,className:"flex items-center gap-1 px-3 py-1.5 text-xs bg-gray-200 rounded hover:bg-gray-300",title:n("advDashboard.exportJson"),children:[m.jsx(O,{className:"w-4 h-4"}),n("advDashboard.json")]})]})]})]}),m.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[m.jsxs("div",{className:"bg-white border-r flex-shrink-0 overflow-y-auto",style:{width:xe.sidebarWidth},children:[m.jsx(we,{title:n("advDashboard.panSettings"),icon:m.jsx(H,{className:"w-4 h-4"}),badge:`${Pe.quantity}${n("advDashboard.pan")}â†’${Oe.reduce((e,t)=>e+t.quantity,0)}${n("advDashboard.pan")}`,badgeColor:"bg-blue-100 text-blue-700",onReset:Ut,children:m.jsxs("div",{className:"space-y-3",children:[m.jsxs("div",{className:"bg-gray-100 rounded p-2",children:[m.jsxs("div",{className:"flex items-center justify-between mb-1.5",children:[m.jsxs("span",{className:"text-xs font-medium text-gray-600",children:["ğŸ“‹ ",n("advDashboard.originalPan")]}),m.jsxs("div",{className:"flex text-xs",children:[m.jsxs("button",{onClick:()=>Kt("mode","pan"),className:"px-2 py-0.5 rounded-l border "+("pan"===Pe.mode?"bg-gray-500 text-white border-gray-500":"bg-white text-gray-600 border-gray-300"),children:["ğŸ ",n("advDashboard.panMode")]}),m.jsxs("button",{onClick:()=>Kt("mode","count"),className:"px-2 py-0.5 rounded-r border-l-0 border "+("count"===Pe.mode?"bg-green-500 text-white border-green-500":"bg-white text-gray-600 border-gray-300"),children:["ğŸ”¢ ",n("advDashboard.countMode")]})]})]}),"pan"===Pe.mode&&m.jsxs(m.Fragment,{children:[m.jsxs("div",{className:"grid grid-cols-2 gap-1.5 mb-1.5",children:[m.jsx("select",{value:Pe.category,onChange:e=>Kt("category",e.target.value),className:"text-xs border rounded px-2 py-1 bg-white",children:Object.keys(se).map(e=>m.jsx("option",{value:e,children:b(e)},e))}),m.jsx("select",{value:Pe.type,onChange:e=>Kt("type",e.target.value),className:"text-xs border rounded px-2 py-1 bg-white",children:null==(r=se[Pe.category])?void 0:r.map(e=>m.jsx("option",{value:e.name,children:y(e)},e.name))})]}),m.jsxs("div",{className:"grid grid-cols-4 gap-1.5 text-xs",children:[m.jsxs("div",{children:[m.jsx("label",{className:"text-xs text-gray-500 block",children:n("advDashboard.quantity")}),m.jsx("input",{type:"number",value:Pe.quantity,onChange:e=>Kt("quantity",parseInt(e.target.value)||1),className:"w-full border rounded px-1.5 py-1 text-center bg-white"})]}),m.jsxs("div",{children:[m.jsx("label",{className:"text-xs text-gray-500 block",children:n("advDashboard.division")}),m.jsx("input",{type:"number",value:Pe.divisionCount,onChange:e=>Kt("divisionCount",parseInt(e.target.value)||1),className:"w-full border rounded px-1.5 py-1 text-center bg-white"})]}),m.jsxs("div",{children:[m.jsx("label",{className:"text-xs text-gray-500 block",children:n("advDashboard.panWeight")}),m.jsx("input",{type:"number",value:Pe.panWeight,onChange:e=>Kt("panWeight",parseInt(e.target.value)||0),className:"w-full border rounded px-1.5 py-1 text-center bg-white"})]}),m.jsxs("div",{children:[m.jsx("label",{className:"text-xs text-gray-500 block",children:n("advDashboard.divisionWeight")}),m.jsx("div",{className:"text-center py-1 font-mono bg-white rounded border",children:Pe.divisionWeight})]})]})]}),"count"===Pe.mode&&m.jsxs("div",{className:"grid grid-cols-3 gap-1.5 text-xs",children:[m.jsxs("div",{children:[m.jsx("label",{className:"text-xs text-gray-500 block",children:n("advDashboard.count")}),m.jsx("input",{type:"number",value:Pe.unitCount||10,onChange:e=>Kt("unitCount",parseInt(e.target.value)||0),className:"w-full border rounded px-1.5 py-1 text-center bg-white"})]}),m.jsxs("div",{children:[m.jsx("label",{className:"text-xs text-gray-500 block",children:n("advDashboard.weightPerPiece")}),m.jsx("input",{type:"number",value:Pe.unitWeight||50,onChange:e=>Kt("unitWeight",parseInt(e.target.value)||0),className:"w-full border rounded px-1.5 py-1 text-center bg-white"})]}),m.jsxs("div",{children:[m.jsx("label",{className:"text-xs text-gray-500 block",children:n("advDashboard.total")}),m.jsxs("div",{className:"text-center py-1 font-mono bg-white rounded border font-semibold",children:[(Pe.unitCount||10)*(Pe.unitWeight||50),"g"]})]})]}),m.jsxs("div",{className:"text-xs text-gray-500 mt-1 text-right",children:[n("advDashboard.total"),": ",m.jsxs("b",{children:["count"===Pe.mode?(Pe.unitCount||10)*(Pe.unitWeight||50):Pe.panWeight*Pe.quantity,"g"]})]})]}),m.jsx("div",{className:"flex justify-center text-gray-400",children:m.jsx(q,{className:"w-5 h-5"})}),m.jsxs("div",{className:"space-y-2",children:[m.jsxs("div",{className:"text-xs font-medium text-blue-600",children:["ğŸ¯ ",n("advDashboard.convertedPan")]}),Oe.map((e,t)=>{var a;return m.jsxs("div",{className:"bg-blue-50 rounded p-2 border border-blue-200",children:[m.jsxs("div",{className:"flex items-center justify-between mb-1.5",children:[m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsxs("span",{className:"text-xs font-medium text-blue-700",children:[n("advDashboard.pan")," ",t+1]}),m.jsxs("div",{className:"flex text-xs",children:[m.jsxs("button",{onClick:()=>ta(e.id,"mode","pan"),className:"px-2 py-0.5 rounded-l border "+("pan"===e.mode?"bg-blue-500 text-white border-blue-500":"bg-white text-gray-600 border-gray-300"),children:["ğŸ ",n("advDashboard.panMode")]}),m.jsxs("button",{onClick:()=>ta(e.id,"mode","count"),className:"px-2 py-0.5 rounded-r border-l-0 border "+("count"===e.mode?"bg-green-500 text-white border-green-500":"bg-white text-gray-600 border-gray-300"),children:["ğŸ”¢ ",n("advDashboard.countMode")]})]})]}),Oe.length>1&&m.jsx("button",{onClick:()=>Vt(e.id),className:"text-red-400 hover:text-red-600",children:m.jsx(g,{className:"w-4 h-4"})})]}),"pan"===e.mode&&m.jsxs(m.Fragment,{children:[m.jsxs("div",{className:"grid grid-cols-2 gap-1.5 mb-1.5",children:[m.jsx("select",{value:e.category,onChange:t=>ta(e.id,"category",t.target.value),className:"text-xs border rounded px-2 py-1 bg-white",children:Object.keys(se).map(e=>m.jsx("option",{value:e,children:b(e)},e))}),m.jsx("select",{value:e.type,onChange:t=>ta(e.id,"type",t.target.value),className:"text-xs border rounded px-2 py-1 bg-white",children:null==(a=se[e.category])?void 0:a.map(e=>m.jsx("option",{value:e.name,children:y(e)},e.name))})]}),m.jsxs("div",{className:"grid grid-cols-4 gap-1.5 text-xs",children:[m.jsxs("div",{children:[m.jsx("label",{className:"text-xs text-gray-500 block",children:n("advDashboard.quantity")}),m.jsx("input",{type:"number",value:e.quantity,onChange:t=>ta(e.id,"quantity",parseFloat(t.target.value)||0),className:"w-full border rounded px-1.5 py-1 text-center bg-white",step:"0.5"})]}),m.jsxs("div",{children:[m.jsx("label",{className:"text-xs text-gray-500 block",children:n("advDashboard.division")}),m.jsx("input",{type:"number",value:e.divisionCount,onChange:t=>ta(e.id,"divisionCount",parseInt(t.target.value)||1),className:"w-full border rounded px-1.5 py-1 text-center bg-white"})]}),m.jsxs("div",{children:[m.jsx("label",{className:"text-xs text-gray-500 block",children:n("advDashboard.panWeight")}),m.jsx("input",{type:"number",value:e.panWeight,onChange:t=>ta(e.id,"panWeight",parseInt(t.target.value)||0),className:"w-full border rounded px-1.5 py-1 text-center bg-white"})]}),m.jsxs("div",{children:[m.jsx("label",{className:"text-xs text-gray-500 block",children:n("advDashboard.divisionWeight")}),m.jsx("div",{className:"text-center py-1 font-mono bg-white rounded border",children:e.divisionWeight})]})]})]}),"count"===e.mode&&m.jsxs("div",{className:"grid grid-cols-3 gap-1.5 text-xs",children:[m.jsxs("div",{children:[m.jsx("label",{className:"text-xs text-gray-500 block",children:n("advDashboard.count")}),m.jsx("input",{type:"number",value:e.unitCount||10,onChange:t=>ta(e.id,"unitCount",parseInt(t.target.value)||0),className:"w-full border rounded px-1.5 py-1 text-center bg-white"})]}),m.jsxs("div",{children:[m.jsx("label",{className:"text-xs text-gray-500 block",children:n("advDashboard.weightPerPiece")}),m.jsx("input",{type:"number",value:e.unitWeight||50,onChange:t=>ta(e.id,"unitWeight",parseInt(t.target.value)||0),className:"w-full border rounded px-1.5 py-1 text-center bg-white"})]}),m.jsxs("div",{children:[m.jsx("label",{className:"text-xs text-gray-500 block",children:n("advDashboard.total")}),m.jsxs("div",{className:"text-center py-1 font-mono bg-white rounded border font-semibold",children:[(e.unitCount||10)*(e.unitWeight||50),"g"]})]})]})]},e.id)}),m.jsx("button",{onClick:Yt,className:"w-full text-xs text-blue-600 hover:text-blue-700 py-1.5 border border-dashed border-blue-300 rounded",children:n("advDashboard.addPan")}),m.jsxs("div",{className:"text-xs text-blue-700 text-right",children:[n("advDashboard.total"),": ",m.jsxs("b",{children:[Mt,"g"]})]})]})]})}),m.jsx(we,{title:n("bread"===Re?"advDashboard.specificVolume":"advDashboard.specificGravity"),icon:m.jsx(v,{className:"w-4 h-4"}),defaultOpen:!1,onReset:_t,children:m.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[m.jsxs("div",{children:[m.jsx("label",{className:"text-xs text-gray-500 block mb-1",children:n("advDashboard.originalProduct")}),m.jsx("select",{value:Fe,onChange:e=>He(e.target.value),className:"w-full text-xs border rounded px-2 py-1",children:"bread"===Re?Object.keys(be).map(e=>m.jsx("option",{value:e,children:f(e)},e)):Object.keys(ye).map(e=>m.jsx("option",{value:e,children:f(e)},e))}),m.jsx("div",{className:"text-xs text-gray-400 mt-1",children:"bread"===Re?`ë¹„ìš©ì : ${be[Fe]||ae[Fe]} cmÂ³/g`:`ë¹„ì¤‘: ${ye[Fe]}`})]}),m.jsxs("div",{children:[m.jsx("label",{className:"text-xs text-gray-500 block mb-1",children:n("advDashboard.convertedProduct")}),m.jsx("select",{value:Ke,onChange:e=>Ye(e.target.value),className:"w-full text-xs border rounded px-2 py-1",children:"bread"===Re?Object.keys(be).map(e=>m.jsx("option",{value:e,children:f(e)},e)):Object.keys(ye).map(e=>m.jsx("option",{value:e,children:f(e)},e))}),m.jsx("div",{className:"text-xs text-gray-400 mt-1",children:"bread"===Re?`ë¹„ìš©ì : ${be[Ke]||ae[Ke]} cmÂ³/g`:`ë¹„ì¤‘: ${ye[Ke]}`})]})]})}),"bread"===Re&&m.jsx(we,{title:n("advDashboard.yieldPrediction"),icon:m.jsx(W,{className:"w-4 h-4"}),defaultOpen:!1,badge:`${Math.round(.81*Nt)}g ${n("advDashboard.expectedYield")}`,children:m.jsx(ge,{inputWeight:Nt,category:"ì‰¬í°ì¼€ì´í¬"===Fe||"ì œëˆ„ì™€ì¦ˆ"===Fe||"íŒŒìš´ë“œì¼€ì´í¬"===Fe?"cake":"í¬ë£¨ì•„ìƒ"===Fe||"ë°ë‹ˆì‰¬"===Fe?"pastry":"ì¿ í‚¤"===Fe?"cookie":"bread",productType:"í’€ë¨¼ì‹ë¹µ"===Fe?"pullman":"ì‚°í˜•ì‹ë¹µ"===Fe?"mountain":"ë¸Œë¦¬ì˜¤ìŠˆ"===Fe?"brioche":"ì œëˆ„ì™€ì¦ˆ"===Fe?"genoise":"ì‰¬í°ì¼€ì´í¬"===Fe?"chiffon":"íŒŒìš´ë“œì¼€ì´í¬"===Fe?"pound":"í¬ë£¨ì•„ìƒ"===Fe?"croissant":void 0,stageSelection:ot,onStageSelectionChange:it,compact:!1,className:"border-0 shadow-none"})}),m.jsx(we,{title:n("advDashboard.oven"),icon:m.jsx(E,{className:"w-4 h-4"}),badge:`${n(`advDashboard.ovenTypes.${Ve.type}`)}${"convection"===Ve.type&&Ve.level?` ${Ve.level}${n("advDashboard.level")}`:""} ${"deck"===Ve.type?`${Ve.firstBake.topTemp}/${Ve.firstBake.bottomTemp}Â°C`:`${Ve.firstBake.topTemp}Â°C`} ${Ve.firstBake.time}${n("units.minute")}${Ve.secondBake.time>0?"deck"===Ve.type?` â†’ ${Ve.secondBake.topTemp}/${Ve.secondBake.bottomTemp}Â°C ${Ve.secondBake.time}${n("units.minute")}`:` â†’ ${Ve.secondBake.topTemp}Â°C ${Ve.secondBake.time}${n("units.minute")}`:""}`,badgeColor:"bg-orange-100 text-orange-700",onReset:Jt,children:m.jsxs("div",{className:"space-y-2",children:[m.jsx("div",{className:"flex gap-1.5",children:["convection","deck","airfryer"].map(e=>m.jsx("button",{onClick:()=>Ue(l(i({},Ve),{type:e})),className:"flex-1 px-2 py-1 text-xs rounded "+(Ve.type===e?"bg-amber-500 text-white":"bg-gray-100"),children:n(`advDashboard.ovenTypes.${e}`)},e))}),"convection"===Ve.type&&m.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[m.jsxs("span",{className:"text-gray-500",children:[n("advDashboard.levelSelect"),":"]}),m.jsx("div",{className:"flex gap-1",children:[1,2,3,4,5].map(e=>{const t=Ve.level?Ve.level.split(",").map(e=>e.trim()):[],a=t.includes(String(e));return m.jsx("button",{onClick:()=>{let s;s=a?t.filter(t=>t!==String(e)):[...t,String(e)].sort((e,t)=>Number(e)-Number(t)),Ue(l(i({},Ve),{level:s.join(", ")}))},className:"w-6 h-6 rounded text-xs font-medium "+(a?"bg-amber-500 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"),children:e},e)})}),Ve.level&&m.jsxs("span",{className:"text-amber-600 font-medium",children:[Ve.level,n("advDashboard.level")]})]}),m.jsxs("div",{className:"bg-orange-50 rounded p-2",children:[m.jsx("div",{className:"text-xs font-medium text-orange-700 mb-1.5",children:n("advDashboard.firstBake")}),"deck"===Ve.type?m.jsxs("div",{className:"grid grid-cols-3 gap-1.5",children:[m.jsxs("div",{children:[m.jsx("label",{className:"text-xs text-gray-500",children:n("advDashboard.topHeat")}),m.jsx("input",{type:"number",value:Ve.firstBake.topTemp,onChange:e=>Ue(l(i({},Ve),{firstBake:l(i({},Ve.firstBake),{topTemp:parseInt(e.target.value)||0})})),className:"w-full text-xs border rounded px-1.5 py-1 text-center"})]}),m.jsxs("div",{children:[m.jsx("label",{className:"text-xs text-gray-500",children:n("advDashboard.bottomHeat")}),m.jsx("input",{type:"number",value:Ve.firstBake.bottomTemp,onChange:e=>Ue(l(i({},Ve),{firstBake:l(i({},Ve.firstBake),{bottomTemp:parseInt(e.target.value)||0})})),className:"w-full text-xs border rounded px-1.5 py-1 text-center"})]}),m.jsxs("div",{children:[m.jsx("label",{className:"text-xs text-gray-500",children:n("advDashboard.timeMin")}),m.jsx("input",{type:"number",value:Ve.firstBake.time,onChange:e=>Ue(l(i({},Ve),{firstBake:l(i({},Ve.firstBake),{time:parseInt(e.target.value)||0})})),className:"w-full text-xs border rounded px-1.5 py-1 text-center"})]})]}):m.jsxs("div",{className:"grid grid-cols-2 gap-1.5",children:[m.jsxs("div",{children:[m.jsx("label",{className:"text-xs text-gray-500",children:n("advDashboard.temperature")}),m.jsx("input",{type:"number",value:Ve.firstBake.topTemp,onChange:e=>{const t=parseInt(e.target.value)||0;Ue(l(i({},Ve),{firstBake:l(i({},Ve.firstBake),{topTemp:t,bottomTemp:t})}))},className:"w-full text-xs border rounded px-1.5 py-1 text-center"})]}),m.jsxs("div",{children:[m.jsx("label",{className:"text-xs text-gray-500",children:n("advDashboard.timeMin")}),m.jsx("input",{type:"number",value:Ve.firstBake.time,onChange:e=>Ue(l(i({},Ve),{firstBake:l(i({},Ve.firstBake),{time:parseInt(e.target.value)||0})})),className:"w-full text-xs border rounded px-1.5 py-1 text-center"})]})]})]}),m.jsxs("div",{className:"bg-gray-50 rounded p-2",children:[m.jsx("div",{className:"text-xs text-gray-500 mb-1.5",children:n("advDashboard.secondBake")}),"deck"===Ve.type?m.jsxs("div",{className:"grid grid-cols-3 gap-1.5",children:[m.jsx("input",{type:"number",value:Ve.secondBake.topTemp||"",onChange:e=>Ue(l(i({},Ve),{secondBake:l(i({},Ve.secondBake),{topTemp:parseInt(e.target.value)||0})})),className:"text-xs border rounded px-1.5 py-1 text-center",placeholder:n("advDashboard.topHeat")}),m.jsx("input",{type:"number",value:Ve.secondBake.bottomTemp||"",onChange:e=>Ue(l(i({},Ve),{secondBake:l(i({},Ve.secondBake),{bottomTemp:parseInt(e.target.value)||0})})),className:"text-xs border rounded px-1.5 py-1 text-center",placeholder:n("advDashboard.bottomHeat")}),m.jsx("input",{type:"number",value:Ve.secondBake.time||"",onChange:e=>Ue(l(i({},Ve),{secondBake:l(i({},Ve.secondBake),{time:parseInt(e.target.value)||0})})),className:"text-xs border rounded px-1.5 py-1 text-center",placeholder:n("units.time")})]}):m.jsxs("div",{className:"grid grid-cols-2 gap-1.5",children:[m.jsx("input",{type:"number",value:Ve.secondBake.topTemp||"",onChange:e=>{const t=parseInt(e.target.value)||0;Ue(l(i({},Ve),{secondBake:l(i({},Ve.secondBake),{topTemp:t,bottomTemp:t})}))},className:"text-xs border rounded px-1.5 py-1 text-center",placeholder:n("advDashboard.temperature")}),m.jsx("input",{type:"number",value:Ve.secondBake.time||"",onChange:e=>Ue(l(i({},Ve),{secondBake:l(i({},Ve.secondBake),{time:parseInt(e.target.value)||0})})),className:"text-xs border rounded px-1.5 py-1 text-center",placeholder:n("units.time")})]})]})]})}),"bread"===Re&&m.jsx(we,{title:n("advDashboard.method"),icon:m.jsx(D,{className:"w-4 h-4"}),badge:n(Ne[_e.type]),badgeColor:"straight"===_e.type?"bg-gray-100 text-gray-600":"bg-amber-100 text-amber-700",children:m.jsxs("div",{className:"space-y-2",children:[m.jsx("div",{className:"grid grid-cols-5 gap-1",children:Object.entries(Ne).map(([e,t])=>m.jsx("button",{onClick:()=>Ht(e),className:"px-1.5 py-1 text-xs rounded "+(_e.type===e?"bg-amber-500 text-white":"bg-gray-100 hover:bg-gray-200"),children:n(t)},e))}),("coldFerment"===_e.type||"retard"===_e.type)&&m.jsxs("div",{className:"bg-blue-50 rounded p-2",children:[m.jsx("div",{className:"text-xs font-medium text-blue-700 mb-1",children:"coldFerment"===_e.type?`â„ï¸ ${n("advDashboard.coldFerment")}`:`ğŸŒ™ ${n("advDashboard.coldRetard")}`}),m.jsx("div",{className:"text-xs text-blue-600",children:"coldFerment"===_e.type?n("advDashboard.coldFermentDesc",{percent:Math.round(100*_e.yeastAdjustment)}):n("advDashboard.coldRetardDesc")})]}),"straight"!==_e.type&&"coldFerment"!==_e.type&&"retard"!==_e.type&&m.jsxs("div",{className:"bg-amber-50 rounded p-2",children:[m.jsx("div",{className:"text-xs font-medium text-amber-700 mb-1.5",children:n("advDashboard.prefermentRatio")}),m.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[m.jsxs("div",{children:[m.jsx("label",{className:"text-xs text-gray-500",children:n("advDashboard.flourPercent")}),m.jsx("input",{type:"number",value:Math.round(100*_e.flourRatio),onChange:e=>Je(l(i({},_e),{flourRatio:(parseFloat(e.target.value)||0)/100})),className:"w-full text-xs border rounded px-1.5 py-1 text-center",step:"10"})]}),m.jsxs("div",{children:[m.jsx("label",{className:"text-xs text-gray-500",children:n("advDashboard.waterPercent")}),m.jsx("input",{type:"number",value:Math.round(100*_e.waterRatio),onChange:e=>Je(l(i({},_e),{waterRatio:(parseFloat(e.target.value)||0)/100})),className:"w-full text-xs border rounded px-1.5 py-1 text-center",step:"10"})]})]})]})]})}),m.jsx("div",{className:"p-2 border-t",children:m.jsxs("button",{onClick:Se,className:"w-full flex items-center justify-center gap-1 text-xs text-gray-500 hover:text-gray-700 py-1",title:n("advDashboard.layoutReset"),children:[m.jsx(B,{className:"w-3 h-3"}),n("advDashboard.layoutReset")]})})]}),m.jsx(G,{direction:"horizontal",onResize:e=>Ce(xe.sidebarWidth+e),className:"hover:bg-blue-100"}),m.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden min-h-0",children:[m.jsx("div",{className:"flex-1 overflow-auto p-1 min-h-0",children:m.jsxs("div",{className:"grid gap-1 h-full grid-cols-2",children:[m.jsxs("div",{className:"bg-white rounded shadow-sm border flex flex-col overflow-hidden min-w-0",children:[m.jsxs("div",{className:"bg-gray-50 border-b px-2 py-0.5 flex items-center justify-between flex-shrink-0",children:[m.jsxs("span",{className:"font-semibold text-gray-700 flex items-center gap-1 text-[11px]",children:[m.jsx(A,{className:"w-3 h-3"}),n("advDashboard.originalRecipe")]}),m.jsxs("div",{className:"flex gap-2",children:[m.jsxs("button",{onClick:()=>sa(!0),className:"text-[10px] text-blue-600 hover:text-blue-700 font-medium",children:["ğŸ“‹ ",n("advDashboard.bulkInput")]}),m.jsx("button",{onClick:oa,className:"text-[10px] text-amber-600 hover:text-amber-700 font-medium",children:n("advDashboard.addIngredient")})]})]}),m.jsx("div",{className:"flex-1 overflow-auto",children:m.jsxs("table",{className:"w-full",children:[m.jsx("thead",{className:"bg-gray-50 sticky top-0",children:m.jsxs("tr",{className:`text-gray-500 ${Ft.fontSize}`,children:[m.jsx("th",{className:"px-1.5 py-1 text-left w-16",children:n("advDashboard.category")}),m.jsx("th",{className:"px-1.5 py-1 text-left",children:n("advDashboard.ingredients")}),m.jsx("th",{className:"px-1.5 py-1 text-left w-20",children:n("advDashboard.process")}),m.jsx("th",{className:"px-1.5 py-1 text-right w-10",children:n("advDashboard.tableHeaderPercent")}),m.jsx("th",{className:"px-1.5 py-1 text-right w-14",children:n("advDashboard.tableHeaderGram")}),m.jsx("th",{className:"w-5"})]})}),m.jsx("tbody",{className:Ft.fontSize,children:kt.map(({phase:e,items:t},a)=>{const s=ke[e]||ke.other;return m.jsxs(M.Fragment,{children:[wt&&m.jsx("tr",{className:`${s.bgColor} ${s.borderColor} border-y-2`,children:m.jsx("td",{colSpan:5,className:`px-2 py-1 ${s.textColor} font-semibold text-xs`,children:m.jsxs("span",{className:"flex items-center gap-1",children:[m.jsx("span",{children:s.icon}),m.jsx("span",{children:n(s.labelKey)}),m.jsxs("span",{className:"text-[10px] font-normal opacity-60",children:["(",n("advDashboard.itemCount",{count:t.length}),")"]})]})})}),t.map(e=>{const t="bread"===Re?["main","preferment","tangzhong","autolyse","topping","other"]:["main","filling","frosting","topping","glaze","other"];return m.jsxs("tr",{className:`border-b border-gray-100 hover:bg-gray-50 ${Ft.rowHeight}`,children:[m.jsx("td",{className:"px-1.5",children:m.jsx("select",{value:e.category,onChange:t=>da(e.id,"category",t.target.value),className:"w-full text-xs border-0 bg-transparent p-0 focus:outline-none appearance-none cursor-pointer",children:Object.entries(re).map(([e,t])=>m.jsx("option",{value:e,children:t},e))})}),m.jsx("td",{className:"px-1.5",children:m.jsx(ne,{value:e.name,onChange:t=>da(e.id,"name",t),onSelect:t=>{const a=x(t);if(a){da(e.id,"name",t);const s={flour:"flour",liquid:"liquid",fat:"wetOther",sugar:"other",egg:"wetOther",dairy:"liquid",leavening:"other",salt:"other",flavoring:"other",nut:"other",fruit:"other",chocolate:"other",other:"other"};da(e.id,"category",s[a.category]||"other")}},placeholder:n("advDashboard.name"),className:"!border-0 !p-0 !ring-0 text-sm bg-transparent",maxSuggestions:6})}),m.jsx("td",{className:"px-1.5",children:m.jsx("select",{value:e.phase||"main",onChange:t=>da(e.id,"phase",t.target.value),className:"w-full text-xs border-0 bg-transparent p-0 focus:outline-none appearance-none cursor-pointer",children:t.map(e=>{const t=ke[e];return m.jsxs("option",{value:e,children:[t.icon," ",n(t.labelKey)]},e)})})}),m.jsx("td",{className:"px-1.5 text-right font-mono text-gray-400 text-xs",children:e.ratio}),m.jsx("td",{className:"px-1.5",children:m.jsx("input",{type:"number",value:e.amount,onChange:t=>da(e.id,"amount",parseFloat(t.target.value)||0),className:"w-full text-right font-mono bg-transparent border-0 p-0 focus:outline-none text-sm"})}),m.jsx("td",{className:"px-0.5",children:m.jsx("button",{onClick:()=>la(e.id),className:"text-red-300 hover:text-red-500",children:m.jsx(g,{className:"w-3.5 h-3.5"})})})]},e.id)})]},e)})})]})}),m.jsx("div",{className:"bg-gray-50 border-t px-2 py-0.5 text-[11px] flex-shrink-0",children:m.jsxs("span",{children:[n("advDashboard.total"),": ",m.jsxs("b",{children:[Nt,"g"]})]})})]}),m.jsxs("div",{className:"bg-white rounded shadow-sm border border-blue-200 flex flex-col overflow-hidden min-w-0",children:[m.jsxs("div",{className:"bg-blue-50 border-b border-blue-200 px-2 py-0.5 flex items-center justify-between flex-shrink-0",children:[m.jsxs("span",{className:"font-semibold text-blue-700 flex items-center gap-1 text-[11px]",children:[m.jsx(U,{className:"w-3 h-3"}),n("advDashboard.convertedRecipe")]}),1!==St&&m.jsxs("span",{className:"text-[9px] bg-blue-200 text-blue-700 px-1 py-0.5 rounded font-medium",children:["Ã—",St]})]}),m.jsx("div",{className:"flex-1 overflow-auto",children:m.jsxs("table",{className:"w-full",children:[m.jsx("thead",{className:"bg-blue-50 sticky top-0",children:m.jsxs("tr",{className:`text-blue-700 ${Ft.fontSize}`,children:[m.jsx("th",{className:"px-2 py-1 text-left",children:n("advDashboard.category")}),m.jsx("th",{className:"px-2 py-1 text-left",children:n("advDashboard.ingredients")}),m.jsx("th",{className:"px-2 py-1 text-right w-16",children:n("advDashboard.tableHeaderGram")})]})}),m.jsx("tbody",{className:Ft.fontSize,children:Ot.map(({phase:e,items:t})=>{const a=ke[e]||ke.other;return m.jsxs(M.Fragment,{children:[Et&&m.jsx("tr",{className:`${a.bgColor} ${a.borderColor} border-y-2`,children:m.jsx("td",{colSpan:3,className:`px-2 py-1 ${a.textColor} font-semibold text-xs`,children:m.jsxs("span",{className:"flex items-center gap-1",children:[m.jsx("span",{children:a.icon}),m.jsx("span",{children:n(a.labelKey)}),m.jsxs("span",{className:"text-[10px] font-normal opacity-60",children:["(",n("advDashboard.itemCount",{count:t.length}),")"]})]})})}),t.map(e=>m.jsxs("tr",{className:`border-b border-blue-100 ${Ft.rowHeight}`,children:[m.jsx("td",{className:"px-2 text-blue-600",children:re[e.category]}),m.jsx("td",{className:"px-2",children:o(e.name)}),m.jsx("td",{className:"px-2 text-right font-mono font-medium text-blue-700",children:e.convertedAmount})]},e.id))]},e)})})]})}),m.jsx("div",{className:"bg-blue-50 border-t border-blue-200 px-2 py-0.5 text-[11px] flex-shrink-0",children:m.jsxs("span",{className:"text-blue-700",children:[n("advDashboard.total"),": ",m.jsxs("b",{children:[Math.round(It+At),"g"]})]})})]})]})}),m.jsx(G,{direction:"vertical",onResize:e=>De(xe.processPanelHeight-e),className:"hover:bg-blue-100"}),m.jsxs("div",{className:"bg-white border-t flex-shrink-0 overflow-hidden flex flex-col",style:{height:xe.processPanelHeight},children:[m.jsxs("div",{className:"bg-gray-50 border-b px-3 py-1 flex items-center justify-between flex-shrink-0",children:[m.jsxs("span",{className:"font-semibold text-gray-700 flex items-center gap-1.5 text-sm",children:[m.jsx(Y,{className:"w-4 h-4"}),n("advDashboard.processMemo"),m.jsx("span",{className:"text-xs font-normal text-gray-500 ml-1",children:n("advDashboard.totalMinutes",{minutes:et.reduce((e,t)=>e+(t.time||0),0)})})]}),m.jsx("button",{onClick:ca,className:"text-xs text-amber-600 hover:text-amber-700 font-medium",children:n("advDashboard.addProcess")})]}),m.jsxs("div",{className:"flex-1 overflow-auto px-2 py-1.5",children:[m.jsx("div",{className:"flex gap-1.5 flex-wrap items-start",children:et.map((e,t)=>{const a=$e(e.id),s=rt===e.id?e.description:c(e.description||"");return m.jsxs("div",{className:"flex items-center gap-1 bg-gray-50 border rounded px-1.5 py-1 text-xs group hover:bg-gray-100 relative",style:{minWidth:a.width||200,maxWidth:"100%"},children:[m.jsxs("div",{className:"flex flex-col opacity-0 group-hover:opacity-100 flex-shrink-0",children:[m.jsx("button",{onClick:()=>ha(e.id,"up"),className:"text-gray-400 hover:text-gray-600 -mb-0.5",disabled:0===t,title:n("advDashboard.moveUp"),children:m.jsx(T,{className:"w-3 h-3"})}),m.jsx("button",{onClick:()=>ha(e.id,"down"),className:"text-gray-400 hover:text-gray-600 -mt-0.5",disabled:t===et.length-1,title:n("advDashboard.moveDown"),children:m.jsx(q,{className:"w-3 h-3"})})]}),m.jsxs("span",{className:"text-gray-400 font-mono text-[11px] w-4 flex-shrink-0",children:[t+1,"."]}),rt===e.id?m.jsx("textarea",{value:s,onChange:t=>ma(e.id,"description",t.target.value),onBlur:()=>nt(null),autoFocus:!0,className:"bg-transparent border-0 p-0 focus:outline-none text-xs flex-1 min-w-0 resize-none leading-relaxed",placeholder:n("advDashboard.processPlaceholder"),rows:3}):m.jsx("div",{onClick:()=>nt(e.id),className:"flex-1 min-w-0 cursor-text leading-relaxed whitespace-pre-wrap",children:s||m.jsx("span",{className:"text-gray-400",children:n("advDashboard.processPlaceholder")})}),e.time?m.jsxs("div",{className:"flex items-center gap-0.5 text-[11px] text-blue-600 bg-blue-50 px-1.5 py-0.5 rounded group/time",children:[m.jsx($,{className:"w-3 h-3 flex-shrink-0"}),m.jsx("input",{type:"number",value:e.time,onChange:t=>ma(e.id,"time",parseInt(t.target.value)||0),className:"w-8 bg-transparent border-0 p-0 text-center focus:outline-none"}),m.jsx("span",{className:"text-[10px] flex-shrink-0",children:n("units.minute")}),m.jsx("button",{onClick:()=>ma(e.id,"time",void 0),className:"text-blue-400 hover:text-blue-600 opacity-0 group-hover/time:opacity-100 ml-0.5 flex-shrink-0",title:n("advDashboard.deleteTime"),children:m.jsx(g,{className:"w-2.5 h-2.5"})})]}):m.jsx("button",{onClick:()=>ma(e.id,"time",1),className:"opacity-0 group-hover:opacity-60 hover:opacity-100 text-blue-400 bg-blue-50 px-1 py-0.5 rounded",title:n("advDashboard.addTime"),children:m.jsx($,{className:"w-3 h-3"})}),e.temp?m.jsxs("div",{className:"flex items-center gap-0.5 text-[11px] text-orange-600 bg-orange-50 px-1.5 py-0.5 rounded group/temp",children:[m.jsx(U,{className:"w-3 h-3 flex-shrink-0"}),m.jsx("input",{type:"number",value:e.temp,onChange:t=>ma(e.id,"temp",parseInt(t.target.value)||0),className:"w-8 bg-transparent border-0 p-0 text-center focus:outline-none"}),m.jsx("span",{className:"text-[10px] flex-shrink-0",children:n("units.celsius")}),m.jsx("button",{onClick:()=>ma(e.id,"temp",void 0),className:"text-orange-400 hover:text-orange-600 opacity-0 group-hover/temp:opacity-100 ml-0.5 flex-shrink-0",title:n("advDashboard.deleteTemp"),children:m.jsx(g,{className:"w-2.5 h-2.5"})})]}):m.jsx("button",{onClick:()=>ma(e.id,"temp",27),className:"opacity-0 group-hover:opacity-60 hover:opacity-100 text-orange-400 bg-orange-50 px-1 py-0.5 rounded",title:n("advDashboard.addTemp"),children:m.jsx(U,{className:"w-3 h-3"})}),m.jsx("button",{onClick:()=>ua(e.id),className:"text-red-300 hover:text-red-500 opacity-0 group-hover:opacity-100",children:m.jsx(g,{className:"w-3.5 h-3.5"})}),m.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-1 cursor-col-resize opacity-0 group-hover:opacity-100 hover:bg-blue-400 transition-colors",onMouseDown:t=>{t.preventDefault();const s=t.clientX,r=a.width||120,n=t=>{const a=t.clientX-s,n=Math.max(80,Math.min(400,r+a));Me(e.id,{width:n})},o=()=>{document.removeEventListener("mousemove",n),document.removeEventListener("mouseup",o),document.body.style.cursor="",document.body.style.userSelect=""};document.addEventListener("mousemove",n),document.addEventListener("mouseup",o),document.body.style.cursor="col-resize",document.body.style.userSelect="none"},title:n("advDashboard.resizeWidth"),children:m.jsx(F,{className:"w-2 h-full text-gray-300 group-hover:text-blue-400"})})]},e.id)})}),m.jsxs("div",{className:"mt-2 pt-2 border-t border-gray-200",children:[m.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[m.jsxs("span",{className:"text-xs font-medium text-gray-500",children:["ğŸ“Œ ",n("advDashboard.memo")]}),at&&m.jsxs("span",{className:"text-[10px] text-gray-400",children:["(",n("advDashboard.memoCharCount",{count:at.length}),")"]})]}),m.jsx("textarea",{value:at,onChange:e=>st(e.target.value),placeholder:n("advDashboard.memoPlaceholder"),className:"w-full text-xs border rounded px-2 py-1.5 resize-none focus:outline-none focus:ring-1 focus:ring-amber-500",rows:2})]})]})]})]})]}),m.jsx(le,{isOpen:aa,onClose:()=>sa(!1),onImport:ia})]})};export{Ce as default};
//# sourceMappingURL=AdvancedDashboard.tsx-DXMGFes3.js.map
